var so=Object.defineProperty,ro=Object.defineProperties;var no=Object.getOwnPropertyDescriptors;var ys=Object.getOwnPropertySymbols;var jn=Object.prototype.hasOwnProperty,vn=Object.prototype.propertyIsEnumerable;var gn=(t,s,r)=>s in t?so(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,M=(t,s)=>{for(var r in s||(s={}))jn.call(s,r)&&gn(t,r,s[r]);if(ys)for(var r of ys(s))vn.call(s,r)&&gn(t,r,s[r]);return t},$=(t,s)=>ro(t,no(s));var He=(t,s)=>{var r={};for(var n in t)jn.call(t,n)&&s.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&ys)for(var n of ys(t))s.indexOf(n)<0&&vn.call(t,n)&&(r[n]=t[n]);return r};var R=(t,s,r)=>new Promise((n,a)=>{var i=c=>{try{l(r.next(c))}catch(d){a(d)}},o=c=>{try{l(r.throw(c))}catch(d){a(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,o);l((r=r.apply(t,s)).next())});import{j as e,h as ao,g as io,i as oo,m as Wt,u as Jt,H as lo,c as ps,I as co}from"./radix-ui-2f58371e.js";import{r as m,L as Sa,f as Ca,e as uo,u as mo,i as ho,j as ve,N as po}from"./react-vendor-6cf6ded9.js";import{C as J,k as ae,l as ie,w as me,e as _,j as Z,W as xs,X as ze,a as fs,F as Fe,B as _t,M as Lt,b as zt,H as Vt,d as Ot,r as Xe,Y as q,I as se,Z as mt,$ as Bt,a0 as xo,a1 as Ht,a2 as yn,a3 as fo,a4 as Zs,i as ge,u as Br,s as Y,a5 as Sr,A as gs,m as Gt,c as qr,D as ht,n as pt,o as xt,p as ft,q as gt,a6 as jt,a7 as os,a8 as go,a9 as bn,aa as jo,ab as vo,ac as wn,ad as Cr,ae as yo,af as Ur,ag as bo,ah as _a,ai as ka,aj as wo,ak as hr,al as No,am as So,an as Co,ao as _o,ap as ko,aq as Zt,ar as es,as as Eo,at as Ao,au as To,av as Do,aw as Mo,ax as Fo,ay as Io,az as Po,aA as $o,aB as Ea,aC as Ro,aD as Lo,g as zo,aE as Vo,aF as Oo,aG as Bo,aH as qo,aI as Uo,aJ as Wo,aK as Qo,aL as Ho}from"./index-426aa6f1.js";import{ab as $t,z as Ge,ac as bt,ad as At,v as he,E as js,y as kt,u as Me,N as pr,aa as Go,t as Ee,ae as Jo,K as Xo,af as er,ag as tr,ah as Rt,I as _r,X as Je,k as ls,ai as Vs,a7 as Os,A as Wr,$ as Ko,aj as Yo,ak as Zo,al as el,am as tl,an as sl,n as Aa,m as cs,h as rl,ao as nl,r as al,ap as kr,aq as il,ar as ol,T as ll,D as Ta,c as cl,Q as Qr,as as dl,o as ul,w as Da,a3 as Ma,H as Fa,at as ml,au as hl,av as pl,b as xl,f as Hr,F as fl,aw as gl,a1 as Gr,a0 as jl,ax as vl,a6 as Ia,ay as yl,a5 as bl,az as wl,aA as Nl,V as Sl,aB as Cl,aC as _l,aD as kl,aE as El,aF as Al,aG as Tl,aH as Dl,aI as Pa,aJ as Ml,aK as Fl,q as Il,Z as $a,J as Pl,aL as $l,aM as Rl,aN as Ll,R as qt,aO as zl,aP as Vl,aQ as Ol,x as Bl,aR as ql,aS as Ul,a4 as Wl,aT as Ql,aU as Ra,aV as Hl,aW as Gl,aX as Jl,aY as Xl,aZ as Kl,a_ as Bs,a$ as La,b0 as Yl,b1 as Zl,b2 as Nn,b3 as ec,b4 as Sn,a9 as za,b5 as tc,p as sc,b6 as rc,b7 as nc,P as Er,b8 as ac,b9 as ic}from"./ui-icons-e73ce4f7.js";import{S as ye,a as be,b as we,c as Ne,d as xe}from"./select-6c123d42.js";import{A as Ke,a as Ye,b as Ze,c as et,d as tt,e as st,f as rt,g as nt,h as vs}from"./alert-dialog-bc29e295.js";import{I as sr}from"./IconSelector-7450d470.js";import{S as Cn}from"./StepAreaEditor-aceba418.js";import{a as oc,D as lc,A as cc}from"./TranslationComponents-cc914843.js";import{v as Et}from"./v4-7fe747c7.js";import{S as Jr}from"./scroll-area-8a7e81aa.js";import{c as Va}from"./index-d203b311.js";import{u as dc}from"./index-cc17d877.js";import{I as uc}from"./ImageEditor-4829d530.js";import{g as mc,u as hc,c as pc,d as xc}from"./faqData-b0f5affe.js";import{T as rr,a as nr,b as Le,c as je,d as ar,e as re}from"./table-8f722342.js";import{S as fc}from"./switch-f7f54a7b.js";import{g as gc,d as jc,a as vc}from"./licenses-39749db6.js";import{f as yc,g as bc,d as wc,u as Nc,c as Sc}from"./exerciseRequests-4362563c.js";import Cc from"./AdminImageValidation-5746a05d.js";import _c from"./AdminExerciseValidation-310bb8ed.js";import{A as kc}from"./AdminTabNavigation-8abb78e2.js";import"./supabase-4b7d20da.js";const Ec={lucide:{module:js,prefix:"",color:"#181818",label:"Lucide"},fa6:{module:Fe,prefix:"fa",color:"#0184BC",label:"Font Awesome 6"},bs:{module:_t,prefix:"bs",color:"#7952B3",label:"Bootstrap Icons"},md:{module:Lt,prefix:"md",color:"#00BCD4",label:"Material Design"},fi:{module:zt,prefix:"fi",color:"#000000",label:"Feather"},hi2:{module:Vt,prefix:"hi",color:"#6366F1",label:"Heroicons"},ai:{module:Ot,prefix:"ai",color:"#1890FF",label:"Ant Design"}},Ac=t=>{if(!t)return null;if(t.includes(":")&&(t.startsWith("logos:")||t.startsWith("skill-icons:")||t.startsWith("devicon:")))return i=>e.jsx(fs,M({icon:t},i));const[s,r]=t.split(":"),n=Ec[s];return n&&n.module[r]||null},_n=({task:t,onSelectTask:s,onDeleteTask:r,onDuplicateTask:n,imagesMap:a})=>{const i=xs.find(d=>d.id===t.creation_status)||{label:"Inconnu",color:"bg-gray-400"},o=Ac(t.icon_name),l=t.pictogram_app_image_id?a.get(t.pictogram_app_image_id):null,c=t.task_type==="questionnaire";return e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs("div",{className:`flex items-center p-4 hover:bg-muted/50 ${c?"bg-blue-50":"bg-card"}`,children:[e.jsx("div",{className:`flex-shrink-0 w-12 h-12 rounded-full flex items-center justify-center mr-4 ${c?"bg-blue-100":"bg-primary/10"}`,children:c?e.jsx(Ge,{className:"h-6 w-6 text-blue-600"}):o?e.jsx(o,{className:"h-6 w-6 text-primary"}):l?e.jsx("img",{src:l.publicUrl,alt:l.name,className:"h-8 w-8 object-contain"}):e.jsx(Ge,{className:"h-6 w-6 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"font-semibold text-lg",children:t.title}),c&&e.jsx(ze,{className:"bg-blue-600 text-white",children:"QCM"})]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t.description})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx(ze,{variant:"outline",className:`${i.color} text-white`,children:i.label}),e.jsx(_,{variant:"ghost",size:"icon",onClick:d=>{d.stopPropagation(),s(t)},children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:d=>{d.stopPropagation(),n(t)},children:e.jsx(At,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:d=>{d.stopPropagation(),r(t.id)},children:e.jsx(he,{className:"h-4 w-4"})})]})]})})},Tc=({tasks:t,onSelectTask:s,onAddNewTask:r,onCreateQuestionnaire:n,onDeleteTask:a,onDuplicateTask:i,imagesMap:o,categories:l=[]})=>{const[c,d]=m.useState("all"),p=t.reduce((g,j)=>{const S=j.category||"Sans catÃ©gorie";return g[S]||(g[S]=[]),g[S].push(j),g},{}),h=["all",...l.map(g=>g.name)],f=Object.keys(p).filter(g=>g!=="Sans catÃ©gorie"&&!h.includes(g));return["all",...l.map(g=>g.name),...f,"Sans catÃ©gorie"].filter((g,j,S)=>S.indexOf(g)===j),e.jsxs(J,{children:[e.jsxs(ae,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ie,{children:"Gestion des TÃ¢ches"}),e.jsx(me,{children:"CrÃ©ez, modifiez et organisez les tÃ¢ches de l'application."})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("select",{value:c,onChange:g=>d(g.target.value),className:"px-3 py-2 border rounded bg-white text-sm","aria-label":"Filtrer par catÃ©gorie",children:[e.jsx("option",{value:"all",children:"Toutes catÃ©gories"}),l.map(g=>e.jsx("option",{value:g.name,children:g.name},g.id)),e.jsx("option",{value:"Sans catÃ©gorie",children:"Sans catÃ©gorie"})]}),e.jsxs(_,{onClick:r,children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une TÃ¢che"]}),e.jsxs(_,{onClick:n,variant:"outline",className:"border-purple-300 hover:bg-purple-50",children:[e.jsx(Ge,{className:"mr-2 h-4 w-4 text-purple-600"}),e.jsx("span",{className:"text-purple-600 font-medium",children:"CrÃ©er QCM"})]})]})]}),e.jsx(Z,{children:t&&t.length>0?e.jsxs("div",{className:"space-y-8",children:[(()=>{const g=t.filter(x=>x.task_type==="questionnaire");if(g.length===0)return null;const j=g.reduce((x,u)=>{const E=u.category||"Sans catÃ©gorie";return x[E]||(x[E]=[]),x[E].push(u),x},{}),S=["all",...l.map(x=>x.name)],b=Object.keys(j).filter(x=>x!=="Sans catÃ©gorie"&&!S.includes(x)),y=[...l.map(x=>x.name),...b,"Sans catÃ©gorie"].filter((x,u,E)=>E.indexOf(x)===u&&j[x]),N=c==="all"?y:[c].filter(x=>j[x]);return e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2 text-blue-700",children:[e.jsx(Ge,{className:"h-5 w-5"}),"Questionnaires (QCM)"]}),e.jsx("div",{className:"space-y-6",children:N.map(x=>{const u=j[x]||[];return!u||u.length===0?null:e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-semibold mb-2 text-blue-600",children:x}),e.jsx("div",{className:"space-y-4",children:u.map(E=>e.jsx(_n,{task:E,onSelectTask:s,onDeleteTask:a,onDuplicateTask:i,imagesMap:o},E.id))})]},x)})})]})})(),(()=>{const g=t.filter(x=>x.task_type!=="questionnaire");if(g.length===0)return null;const j=g.reduce((x,u)=>{const E=u.category||"Sans catÃ©gorie";return x[E]||(x[E]=[]),x[E].push(u),x},{}),S=["all",...l.map(x=>x.name)],b=Object.keys(j).filter(x=>x!=="Sans catÃ©gorie"&&!S.includes(x)),y=[...l.map(x=>x.name),...b,"Sans catÃ©gorie"].filter((x,u,E)=>E.indexOf(x)===u),N=c==="all"?y:[c].filter(x=>j[x]);return e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold mb-4 flex items-center gap-2",children:"Exercices"}),e.jsx("div",{className:"space-y-6",children:N.map(x=>{const u=j[x]||[];return!u||u.length===0?null:e.jsxs("div",{children:[x!=="all"&&e.jsx("h4",{className:"text-sm font-semibold mb-2",children:x}),e.jsx("div",{className:"space-y-4",children:u.map(E=>e.jsx(_n,{task:E,onSelectTask:s,onDeleteTask:a,onDuplicateTask:i,imagesMap:o},E.id))})]},x)})})]})})()]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-muted-foreground",children:"Aucune tÃ¢che trouvÃ©e."}),e.jsx(_,{onClick:r,className:"mt-4",children:"Commencer par crÃ©er une tÃ¢che"})]})})]})},Dc={lucide:{module:js,prefix:"",color:"#181818",label:"Lucide"},fa6:{module:Fe,prefix:"fa",color:"#0184BC",label:"Font Awesome 6"},bs:{module:_t,prefix:"bs",color:"#7952B3",label:"Bootstrap Icons"},md:{module:Lt,prefix:"md",color:"#00BCD4",label:"Material Design"},fi:{module:zt,prefix:"fi",color:"#000000",label:"Feather"},hi2:{module:Vt,prefix:"hi",color:"#6366F1",label:"Heroicons"},ai:{module:Ot,prefix:"ai",color:"#1890FF",label:"Ant Design"}},Mc=t=>{if(!t)return pr;if(t.includes(":")&&(t.startsWith("logos:")||t.startsWith("skill-icons:")||t.startsWith("devicon:")))return i=>e.jsx(fs,M({icon:t},i));const[s,r]=t.split(":"),n=Dc[s];return n?n.module[r]||pr:pr},Fc=t=>{if(!t)return null;const[s,r]=t.split(":");return{library:s,name:r}},Ic=({task:t,onSave:s,onCancel:r,onDelete:n})=>{var L;const[a,i]=m.useState(t),{categories:o,images:l,isLoading:c}=Xe(),[d,p]=m.useState(!1),h=l instanceof Map?Array.from(l.values()):[];m.useEffect(()=>{i(t)},[t]);const f=v=>{const{name:D,value:F}=v.target;i(O=>$(M({},O),{[D]:F}))},g=(v,D)=>{const F=D==="_none_"?null:D;i(O=>$(M({},O),{[v]:F}))},j=v=>{const D=o.find(F=>F.id.toString()===v);i(F=>$(M({},F),{category_id:D?D.id:null,category:D?D.name:null}))},S=v=>{v.preventDefault(),s(a)},b=()=>{const v=$(M({},a),{id:null,title:`${a.title} (Copie)`,isNew:!0});s(v)},y=h.find(v=>v.id===a.pictogram_app_image_id),N=Mc(a.icon_name),x=v=>{const D=v?`${v.library}:${v.name}`:"";i(F=>$(M({},F),{icon_name:D}))},u=()=>{i(v=>$(M({},v),{icon_name:""}))},E=Fc(a.icon_name);return e.jsxs(J,{className:"mt-4 border-primary",children:[e.jsxs("form",{onSubmit:S,children:[e.jsxs(ae,{children:[e.jsx(ie,{children:a.isNew?"Nouvelle TÃ¢che":"Ã‰diter la TÃ¢che"}),e.jsx(me,{children:"Modifiez les dÃ©tails de cette tÃ¢che et de ses versions."})]}),e.jsxs(Z,{className:"space-y-4",children:[e.jsx("input",{type:"hidden",name:"isNew",value:String(a.isNew||!1)}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"title",children:"Titre de la tÃ¢che"}),e.jsx(se,{id:"title",name:"title",value:a.title||"",onChange:f,required:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"description",children:"Description"}),e.jsx(mt,{id:"description",name:"description",value:a.description||"",onChange:f})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"video_url",children:"URL VidÃ©o (YouTube, Vimeo)"}),e.jsx(se,{id:"video_url",name:"video_url",value:a.video_url||"",onChange:f,placeholder:"https://..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"category",children:"CatÃ©gorie"}),e.jsxs(ye,{value:((L=a.category_id)==null?void 0:L.toString())||"",onValueChange:j,children:[e.jsx(be,{children:e.jsx(we,{placeholder:"SÃ©lectionner une catÃ©gorie"})}),e.jsx(Ne,{children:o.map(v=>e.jsx(xe,{value:v.id.toString(),children:v.name},v.id))})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"status",children:"Statut"}),e.jsxs(ye,{value:a.creation_status||"draft",onValueChange:v=>g("creation_status",v),children:[e.jsx(be,{children:e.jsx(we,{})}),e.jsx(Ne,{children:xs.map(v=>e.jsx(xe,{value:v.id,children:v.label},v.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"iconName",children:"IcÃ´ne"}),e.jsx(sr,{selectedIcon:E?{library:E.library,name:E.name,component:N,displayName:E.name}:null,onSelect:x,onRemove:u,libraries:["lucide","fa6","bs","md","fi","hi2","ai","logos","skill","devicon"],showSearch:!0,showLibraryTabs:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"pictogram",children:"Pictogramme (facultatif)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[y&&e.jsx("img",{src:y.publicUrl,alt:y.name,className:"h-6 w-6 object-contain border rounded"}),e.jsxs(ye,{value:a.pictogram_app_image_id||"_none_",onValueChange:v=>g("pictogram_app_image_id",v),children:[e.jsx(be,{children:e.jsx(we,{placeholder:"SÃ©lectionnez un pictogramme"})}),e.jsxs(Ne,{children:[e.jsx(xe,{value:"_none_",children:"Aucun"}),h.filter(v=>v.category==="IcÃ´ne"||v.category==="Pictogramme").map(v=>e.jsx(xe,{value:v.id,children:v.name},v.id))]})]})]})]})]})]}),e.jsxs(Bt,{className:"flex justify-between",children:[e.jsxs(_,{type:"button",variant:"destructive",size:"sm",onClick:()=>p(!0),disabled:c||a.isNew,children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Supprimer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!a.isNew&&e.jsxs(_,{type:"button",variant:"secondary",size:"sm",onClick:b,children:[e.jsx(At,{className:"mr-2 h-4 w-4"})," Dupliquer"]}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:r,children:[e.jsx(kt,{className:"mr-2 h-4 w-4"})," Annuler"]}),e.jsxs(_,{type:"submit",size:"sm",disabled:c,children:[e.jsx(Me,{className:"mr-2 h-4 w-4"})," Sauvegarder"]})]})]})]}),e.jsx(Ke,{open:d,onOpenChange:p,children:e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"ÃŠtes-vous sÃ»r(e) ?"}),e.jsxs(tt,{children:['Vous vous apprÃªtez Ã  supprimer la tÃ¢che "',e.jsx("strong",{children:a.title}),'". Cette action la dÃ©placera dans la corbeille mais elle pourra Ãªtre restaurÃ©e.']})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>{n(a.id),p(!1)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Oui, supprimer"})]})]})})]})},Pc={lucide:{module:js,prefix:"",color:"#181818",label:"Lucide"},fa6:{module:Fe,prefix:"fa",color:"#0184BC",label:"Font Awesome 6"},bs:{module:_t,prefix:"bs",color:"#7952B3",label:"Bootstrap Icons"},md:{module:Lt,prefix:"md",color:"#00BCD4",label:"Material Design"},fi:{module:zt,prefix:"fi",color:"#000000",label:"Feather"},hi2:{module:Vt,prefix:"hi",color:"#6366F1",label:"Heroicons"},ai:{module:Ot,prefix:"ai",color:"#1890FF",label:"Ant Design"}},$c=t=>{if(!t)return Ge;if(t.includes(":")&&(t.startsWith("logos:")||t.startsWith("skill-icons:")||t.startsWith("devicon:")))return i=>e.jsx(fs,M({icon:t},i));const[s,r]=t.split(":"),n=Pc[s];return n?n.module[r]||Ge:Ge},Rc=t=>{if(!t)return null;const[s,r]=t.split(":");return{library:s,name:r}},Lc=({version:t,onSave:s,onCancel:r,onDelete:n})=>{const[a,i]=m.useState(t),{images:o,isLoading:l}=Xe(),c=o instanceof Map?Array.from(o.values()):[];m.useEffect(()=>{i(t)},[t]);const d=N=>{const{name:x,value:u,type:E,checked:L}=N.target;i(v=>$(M({},v),{[x]:E==="checkbox"?L:u}))},p=(N,x)=>{const u=x==="_none_"?null:x;i(E=>$(M({},E),{[N]:u}))},h=N=>{N.preventDefault();const x={id:a.id,task_id:a.task_id,name:a.name,version:a.version,creation_status:a.creation_status,has_variant_note:!!a.has_variant_note,pictogram_app_image_id:a.pictogram_app_image_id,icon_name:a.icon_name};x._metadata={isNew:a.isNew,originalVersionId:a.originalVersionId},s(x)},f=()=>{const N=$(M({},a),{id:null,name:`${a.name} (Copie)`,isNew:!0});s(N)},g=c.find(N=>N.id===a.pictogram_app_image_id),j=$c(a.icon_name),S=N=>{const x=N?`${N.library}:${N.name}`:"";i(u=>$(M({},u),{icon_name:x}))},b=()=>{i(N=>$(M({},N),{icon_name:""}))},y=Rc(a.icon_name);return e.jsx(J,{className:"mt-4 border-primary",children:e.jsxs("form",{onSubmit:h,children:[e.jsxs(ae,{children:[e.jsx(ie,{children:a.isNew?"Nouvelle Version":"Ã‰diter la Version"}),e.jsx(me,{children:"Modifiez les dÃ©tails de cette version."})]}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"versionName",children:"Nom de la version"}),e.jsx(se,{id:"versionName",name:"name",value:a.name||"",onChange:d,required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"versionVersion",children:"Version Android"}),e.jsx(se,{id:"versionVersion",name:"version",value:a.version||"",onChange:d})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"versionStatus",children:"Statut"}),e.jsxs(ye,{value:a.creation_status||"draft",onValueChange:N=>p("creation_status",N),children:[e.jsx(be,{children:e.jsx(we,{})}),e.jsx(Ne,{children:xs.map(N=>e.jsx(xe,{value:N.id,children:N.label},N.id))})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"versionIconName",children:"IcÃ´ne"}),e.jsx(sr,{selectedIcon:y?{library:y.library,name:y.name,component:j,displayName:y.name}:null,onSelect:S,onRemove:b,libraries:["lucide","fa6","bs","md","fi","hi2","ai","logos","skill","devicon"],showSearch:!0,showLibraryTabs:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"versionPictogram",children:"Pictogramme (facultatif)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[g&&e.jsx("img",{src:g.publicUrl,alt:g.name,className:"h-6 w-6 object-contain border rounded"}),e.jsxs(ye,{value:a.pictogram_app_image_id||"_none_",onValueChange:N=>p("pictogram_app_image_id",N),children:[e.jsx(be,{children:e.jsx(we,{placeholder:"SÃ©lectionnez un pictogramme"})}),e.jsxs(Ne,{children:[e.jsx(xe,{value:"_none_",children:"Aucun"}),c.filter(N=>N.category==="IcÃ´ne"||N.category==="Pictogramme").map(N=>e.jsx(xe,{value:N.id,children:N.name},N.id))]})]})]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"versionHasVariantNote",name:"has_variant_note",checked:!!a.has_variant_note,onChange:d,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),e.jsx(q,{htmlFor:"versionHasVariantNote",className:"text-sm font-medium",children:"Cette version a une note de variante (diffÃ¨re du guidÃ©)"})]})]}),e.jsxs(Bt,{className:"flex justify-between",children:[e.jsxs(_,{type:"button",variant:"destructive",size:"sm",onClick:()=>n(a.id),disabled:l||a.isNew,children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Supprimer"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[!a.isNew&&e.jsxs(_,{type:"button",variant:"secondary",size:"sm",onClick:f,children:[e.jsx(At,{className:"mr-2 h-4 w-4"})," Dupliquer"]}),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:r,children:[e.jsx(kt,{className:"mr-2 h-4 w-4"})," Annuler"]}),e.jsxs(_,{type:"submit",size:"sm",disabled:l,children:[e.jsx(Me,{className:"mr-2 h-4 w-4"})," Sauvegarder"]}),a.task_id&&!a.isNew&&e.jsx(_,{type:"button",variant:"secondary",size:"sm",asChild:!0,children:e.jsxs(Sa,{to:`/admin/preview/tache/${a.task_id}/version/${a.id}`,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Go,{className:"mr-2 h-4 w-4"}),"PrÃ©visualiser"]})})]})]})]})})},zc=({value:t=lc,onChange:s,disabled:r=!1})=>{const n=oc();return e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"button-config",className:"text-sm font-medium",children:"ðŸ“± ModÃ¨le de tÃ©lÃ©phone"}),e.jsxs(ye,{value:t,onValueChange:s,disabled:r,children:[e.jsx(be,{id:"button-config",className:"w-full",children:e.jsx(we,{placeholder:"SÃ©lectionnez un modÃ¨le"})}),e.jsx(Ne,{children:n.map(a=>e.jsx(xe,{value:a.id,children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold",children:a.name}),e.jsx("span",{className:"text-xs text-gray-500",children:a.description})]})},a.id))})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Choisissez la disposition des boutons physiques pour cet exercice"})]})},Vc={fa6:{module:Fe,prefix:"fa",color:"#0184BC",label:"Font Awesome 6"},bs:{module:_t,prefix:"bs",color:"#7952B3",label:"Bootstrap Icons"},md:{module:Lt,prefix:"md",color:"#00BCD4",label:"Material Design"},fi:{module:zt,prefix:"fi",color:"#000000",label:"Feather"},hi2:{module:Vt,prefix:"hi",color:"#6366F1",label:"Heroicons"},ai:{module:Ot,prefix:"ai",color:"#1890FF",label:"Ant Design"}},Oc=t=>{if(!t)return null;if(t.includes(":")&&(t.startsWith("logos:")||t.startsWith("skill-icons:")||t.startsWith("devicon:")))return i=>e.jsx(fs,M({icon:t},i));const[s,r]=t.split(":"),n=Vc[s];return n&&n.module[r]||null},Bc=t=>{if(!t)return null;const[s,r]=t.split(":");return{library:s,name:r}},qc=({step:t,onSave:s,onDelete:r,onCancel:n})=>{var P,G,z;const{register:a,handleSubmit:i,control:o,watch:l,setValue:c,formState:{errors:d,isDirty:p}}=xo({defaultValues:t}),{images:h,isLoading:f}=Xe(),g=h instanceof Map?Array.from(h.values()):[],[j,S]=m.useState("all"),[b,y]=m.useState("all"),[N,x]=m.useState(Ht),[u,E]=m.useState({width:0,height:0}),[L,v]=m.useState(!1),D=l("app_image_id"),F=g.find(k=>k.id===D),O=l("icon_name"),U=Oc(O),H=k=>{const C=k?`${k.library}:${k.name}`:"";c("icon_name",C,{shouldDirty:!0})},X=()=>{c("icon_name","",{shouldDirty:!0})},A=Bc(O);m.useEffect(()=>{(()=>R(void 0,null,function*(){try{const C=yield Zs("Capture d'Ã©cran");x(C)}catch(C){console.error("Error loading subcategories:",C),x(Ht)}}))()},[]);const T=m.useMemo(()=>{const k=g.filter(C=>C.category==="Capture d'Ã©cran"&&C.android_version).map(C=>C.android_version).filter(Boolean);return["all",...new Set(k)].sort((C,Q)=>{var Ae,Te;if(C==="all")return-1;if(Q==="all")return 1;const le=parseInt(((Ae=C.match(/\d+/))==null?void 0:Ae[0])||"0");return parseInt(((Te=Q.match(/\d+/))==null?void 0:Te[0])||"0")-le})},[g]),I=g.filter(k=>{const C=k.category==="Capture d'Ã©cran",Q=j==="all"||k.subcategory===j,le=b==="all"||k.android_version===b;return C&&Q&&le}),w=k=>{let C=M(M({},t),k);const Q=l("action_type"),le=["button_power","button_volume_up","button_volume_down","button_power_volume_down","button_power_volume_up","button_volume_up_down"].includes(Q),oe=["swipe_left","swipe_right","swipe_up","swipe_down","scroll","drag_and_drop","tap","double_tap","long_press"].includes(Q)?"start_area":"target_area";if(!le&&C[oe]&&u.width>0&&u.height>0){const Ae=C[oe],{x:Te,y:Ve,width:Tt,height:B}=Ae,K=He(Ae,["x","y","width","height"]),ce=Number(Te)||0,fe=Number(Ve)||0,dt=Number(Tt)||0,fn=Number(B)||0;oe==="start_area"?C.start_area=M($(M({},K),{x_percent:ce/u.width*100,y_percent:fe/u.height*100,width_percent:dt/u.width*100,height_percent:fn/u.height*100}),k.expected_input&&{expected_input:k.expected_input}):C.target_area=M($(M({},K),{x_percent:ce/u.width*100,y_percent:fe/u.height*100,width_percent:dt/u.width*100,height_percent:fn/u.height*100}),k.expected_input&&{expected_input:k.expected_input})}k.action_type==="text_input"&&k.keyboard_auto_show!==void 0&&(C.keyboard_auto_show=k.keyboard_auto_show),s(C)};return e.jsxs("form",{onSubmit:i(w),className:"space-y-6 p-4 border rounded-lg bg-background mt-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.isNew?"Nouvelle Ã‰tape":`Ã‰diter l'Ã‰tape ${t.step_order+1}`}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"instruction",children:"Instruction"}),e.jsx(mt,$(M({id:"instruction"},a("instruction",{required:"L'instruction est requise"})),{className:"mt-1",placeholder:"Ex: Appuyez sur le bouton vert..."})),d.instruction&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:d.instruction.message})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"action_type",children:"Type d'action"}),e.jsx(yn,{name:"action_type",control:o,render:({field:k})=>e.jsxs(ye,{onValueChange:k.onChange,value:k.value||"",children:[e.jsx(be,{id:"action_type",className:"mt-1",children:e.jsx(we,{placeholder:"SÃ©lectionner un type d'action"})}),e.jsx(Ne,{children:fo.map(C=>e.jsx(xe,{value:C.id,children:C.label},C.id))})]})})]}),["button_power","button_volume_up","button_volume_down","button_power_volume_down","button_power_volume_up","button_volume_up_down"].includes(l("action_type"))&&e.jsx("div",{children:e.jsx(zc,{value:l("button_config")||"samsung",onChange:k=>c("button_config",k)})}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"app_image_id",children:"Capture d'Ã©cran"}),N.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground self-center mr-1",children:"Sous-cat:"}),e.jsx(_,{type:"button",size:"sm",variant:j==="all"?"default":"ghost",onClick:()=>S("all"),className:"h-7 text-xs",children:"Toutes"}),N.map(k=>e.jsx(_,{type:"button",size:"sm",variant:j===k?"default":"ghost",onClick:()=>S(k),className:"h-7 text-xs capitalize",children:k},k))]}),T.length>1&&e.jsxs("div",{className:"flex flex-wrap gap-1 mb-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground self-center mr-1",children:"Android:"}),T.map(k=>e.jsx(_,{type:"button",size:"sm",variant:b===k?"default":"ghost",onClick:()=>y(k),className:"h-7 text-xs",children:k==="all"?"Toutes":k},k))]}),e.jsx(yn,{name:"app_image_id",control:o,render:({field:k})=>e.jsxs(ye,{onValueChange:C=>k.onChange(C==="_none_"?null:C),value:k.value||"_none_",children:[e.jsx(be,{id:"app_image_id",className:"mt-1",children:e.jsx(we,{placeholder:"SÃ©lectionner une capture"})}),e.jsxs(Ne,{children:[e.jsx(xe,{value:"_none_",children:"Aucune"}),I.map(C=>e.jsx(xe,{value:C.id,children:C.name},C.id))]})]})})]})]}),l("action_type")&&l("action_type")!=="bravo"&&!["button_power","button_volume_up","button_volume_down","button_power_volume_down","button_power_volume_up","button_volume_up_down"].includes(l("action_type"))&&F&&e.jsx("div",{className:"border rounded-lg p-4 bg-gray-50 space-y-4",children:(P=l("action_type"))!=null&&P.includes("input")?e.jsx(e.Fragment,{children:e.jsxs("div",{children:[e.jsx(q,{className:"text-base font-semibold mb-2 block text-purple-700",children:"ðŸ“ Zone d'Affichage du Texte (target_area)"}),e.jsx("p",{className:"text-sm text-purple-600 mb-3 italic",children:"DÃ©finissez oÃ¹ les caractÃ¨res saisis apparaÃ®tront (champ de saisie)"}),e.jsx(Cn,{imageUrl:F.publicUrl,area:l("target_area"),onAreaChange:k=>{c("target_area",k),v(!0)},onImageLoad:E})]})}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"text-base font-semibold mb-4 block",children:"Configuration de la zone d'action"}),e.jsx(Cn,{imageUrl:F.publicUrl,area:["swipe_left","swipe_right","swipe_up","swipe_down","scroll","drag_and_drop","tap","double_tap","long_press"].includes(l("action_type"))?l("start_area"):l("target_area"),onAreaChange:k=>{const C=["swipe_left","swipe_right","swipe_up","swipe_down","scroll","drag_and_drop","tap","double_tap","long_press"].includes(l("action_type"))?"start_area":"target_area";c(C,k),v(!0)},onImageLoad:E})]})}),l("action_type")==="bravo"&&F&&e.jsx("div",{className:"border rounded-lg p-4 bg-blue-50 border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:["ðŸŽ‰ ",e.jsx("strong",{children:"Ã‰tape de fÃ©licitations :"})," Cette Ã©tape affichera uniquement la capture d'Ã©cran sans zone d'action Ã  cliquer. Parfait pour montrer un message de rÃ©ussite ou le rÃ©sultat final."]})}),["button_power","button_volume_up","button_volume_down","button_power_volume_down","button_power_volume_up","button_volume_up_down"].includes(l("action_type"))&&F&&e.jsxs("div",{className:"border rounded-lg p-4 bg-purple-50 border-purple-200",children:[e.jsxs("p",{className:"text-sm text-purple-800 mb-2",children:["ðŸ“± ",e.jsx("strong",{children:"Bouton physique :"})," Aucune zone d'action n'est nÃ©cessaire !"]}),e.jsxs("ul",{className:"text-xs text-purple-700 list-disc list-inside space-y-1",children:[e.jsx("li",{children:"Les boutons (Power, Volume+, Volume-) sont automatiquement positionnÃ©s sur les cÃ´tÃ©s du tÃ©lÃ©phone"}),e.jsx("li",{children:"Leur position dÃ©pend du modÃ¨le de tÃ©lÃ©phone sÃ©lectionnÃ©"}),e.jsx("li",{children:"L'apprenant cliquera directement sur les boutons visibles"}),((G=l("action_type"))==null?void 0:G.includes("_"))&&l("action_type")!=="button_volume_up"&&l("action_type")!=="button_volume_down"&&e.jsx("li",{className:"font-semibold text-purple-900",children:"âš ï¸ Action combinÃ©e : l'apprenant devra cliquer sur 2 boutons simultanÃ©ment"})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"icon_name",children:"IcÃ´ne"}),e.jsx(sr,{selectedIcon:A?{library:A.library,name:A.name,component:U,displayName:A.name}:null,onSelect:H,onRemove:X,libraries:["lucide","fa6","bs","md","fi","hi2","ai","logos","skill","devicon"],showSearch:!0,showLibraryTabs:!0})]}),((z=l("action_type"))==null?void 0:z.includes("input"))&&e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"expected_input",children:"Saisie attendue"}),e.jsx(se,$(M({id:"expected_input"},a("expected_input")),{className:"mt-1",placeholder:"Texte ou numÃ©ro attendu"}))]}),l("action_type")==="text_input"&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",$(M({type:"checkbox",id:"keyboard_auto_show"},a("keyboard_auto_show")),{className:"w-4 h-4"})),e.jsx(q,{htmlFor:"keyboard_auto_show",className:"cursor-pointer",children:"Afficher le clavier automatiquement (sinon apparaÃ®t au tap sur la zone)"})]}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[e.jsx("p",{className:"font-semibold",children:"ðŸ“± Configuration des zones :"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Zone d'action (start_area)"})," : Zone oÃ¹ le clavier apparaÃ®tra en overlay"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Zone cible (target_area)"})," : Zone oÃ¹ les caractÃ¨res saisis s'afficheront"]})]}),e.jsx("p",{className:"text-xs mt-2 italic",children:l("action_type")==="number_input"?"âš ï¸ Le clavier numÃ©rique s'affiche automatiquement":"ðŸ’¡ Cochez la case ci-dessus pour un affichage automatique"})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[e.jsxs(_,{type:"button",variant:"destructive",onClick:()=>r(t.id),disabled:f,children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Supprimer"]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(_,{type:"button",variant:"outline",onClick:n,disabled:f,children:[e.jsx(kt,{className:"mr-2 h-4 w-4"})," Annuler"]}),e.jsxs(_,{type:"submit",disabled:f||!p&&!L,children:[f?e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Valider l'Ã‰tape"]})]})]})]})},Uc={lucide:{module:js,prefix:"",color:"#181818",label:"Lucide"},fa6:{module:Fe,prefix:"fa",color:"#0184BC",label:"Font Awesome 6"},bs:{module:_t,prefix:"bs",color:"#7952B3",label:"Bootstrap Icons"},md:{module:Lt,prefix:"md",color:"#00BCD4",label:"Material Design"},fi:{module:zt,prefix:"fi",color:"#000000",label:"Feather"},hi2:{module:Vt,prefix:"hi",color:"#6366F1",label:"Heroicons"},ai:{module:Ot,prefix:"ai",color:"#1890FF",label:"Ant Design"}},Wc=t=>{if(!t)return null;if(t.includes(":")&&(t.startsWith("logos:")||t.startsWith("skill-icons:")||t.startsWith("devicon:")))return i=>e.jsx(fs,M({icon:t},i));const[s,r]=t.split(":"),n=Uc[s];return n&&n.module[r]||null},Qc=({version:t})=>{const{upsertManySteps:s,deleteStep:r,isLoading:n,images:a}=Xe(),i=a instanceof Map?Array.from(a.values()):[],{toast:o}=ge(),[l,c]=m.useState(t.steps||[]),[d,p]=m.useState(null),h=()=>{const b={id:Et(),version_id:t.id,step_order:l.length,instruction:"",action_type:"tap",isNew:!0};p(b)},f=b=>{p(b)},g=b=>{let y;b.isNew?y=[...l,$(M({},b),{isNew:!1})]:y=l.map(N=>N.id===b.id?b:N),c(y.map((N,x)=>$(M({},N),{step_order:x}))),p(null)},j=b=>R(void 0,null,function*(){try{const y=l.find(N=>N.id===b);y&&!y.isNew&&(yield r(b)),c(l.filter(N=>N.id!==b).map((N,x)=>$(M({},N),{step_order:x}))),(d==null?void 0:d.id)===b&&p(null),o({title:"Ã‰tape supprimÃ©e",description:"L'Ã©tape a Ã©tÃ© supprimÃ©e."})}catch(y){o({title:"Erreur",description:"Impossible de supprimer l'Ã©tape.",variant:"destructive"})}}),S=()=>R(void 0,null,function*(){try{yield s(l),o({title:"Ã‰tapes enregistrÃ©es",description:"Toutes les modifications ont Ã©tÃ© enregistrÃ©es."})}catch(b){o({title:"Erreur",description:"Impossible d'enregistrer les Ã©tapes.",variant:"destructive"})}});return d?e.jsx(qc,{step:d,onSave:g,onCancel:()=>p(null),onDelete:()=>j(d.id)}):e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Ã‰tapes"}),e.jsx(me,{children:"GÃ©rez les Ã©tapes pour cette version."})]}),e.jsxs(Z,{children:[e.jsx("ul",{className:"space-y-2",children:l&&l.length>0?l.map((b,y)=>{const N=b.pictogram_app_image_id?i.find(u=>u.id===b.pictogram_app_image_id):null,x=Wc(b.icon_name);return e.jsxs("li",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted/50 transition-colors group",children:[e.jsxs("div",{className:"flex items-center flex-1 truncate pr-4",children:[e.jsx(Jo,{className:"h-5 w-5 text-muted-foreground mr-2 cursor-grab"}),e.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center mr-2",children:x?e.jsx(x,{className:"h-5 w-5 text-primary"}):N?e.jsx("img",{src:N.publicUrl,alt:N.name,className:"h-6 w-6 object-contain"}):e.jsx(Xo,{className:"h-5 w-5 text-muted-foreground"})}),e.jsxs("span",{className:"flex-1 truncate",title:b.instruction,children:[y+1,". ",b.instruction]})]}),e.jsxs("div",{children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>f(b),children:e.jsx(bt,{className:"h-4 w-4 text-muted-foreground group-hover:text-primary"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>j(b.id),children:e.jsx(he,{className:"h-4 w-4 text-muted-foreground group-hover:text-destructive"})})]})]},b.id)}):e.jsx("p",{className:"text-center text-muted-foreground py-4",children:"Aucune Ã©tape pour cette version."})}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsxs(_,{onClick:h,variant:"outline",size:"sm",children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une Ã‰tape"]}),e.jsxs(_,{onClick:S,size:"sm",disabled:n,children:[n?e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Enregistrer les Ã‰tapes"]})]})]})]})},Hc=({task:t})=>{const{upsertVersion:s,deleteVersion:r,isLoading:n}=Xe(),{user:a}=Br(),{toast:i}=ge(),[o,l]=m.useState(null),[c,d]=m.useState(null),[p,h]=m.useState(null),f=u=>xs.find(E=>E.id===u)||{label:"Inconnu",color:"bg-gray-400"},g=()=>{const u={id:Et(),task_id:t.id,name:`Nouvelle Version ${t.versions.length+1}`,version:"",creation_status:"draft",has_variant_note:!1,steps:[],isNew:!0};l(u)},j=u=>{l(u)},S=u=>R(void 0,null,function*(){try{const E=u._metadata||{},L=E.isNew&&E.originalVersionId,v=E.originalVersionId,D=M({},u);delete D._metadata,!D.user_id&&(a!=null&&a.id)&&(D.user_id=a.id);const F=yield s(D);L&&(F!=null&&F.id)&&v&&(console.log(`ðŸ”„ DÃ©but de la duplication des Ã©tapes pour version ID: "${v}"`),yield b(F,v)),i({title:"Version enregistrÃ©e",description:"La version a Ã©tÃ© enregistrÃ©e avec succÃ¨s."}),l(null)}catch(E){console.error("Error saving version:",E),i({title:"Erreur",description:"Impossible d'enregistrer la version.",variant:"destructive"})}}),b=(u,E)=>R(void 0,null,function*(){try{const L=t.versions.find(F=>F.id===E);if(!L){console.warn(`âŒ Version originale avec ID "${E}" non trouvÃ©e. Versions disponibles:`,t.versions.map(F=>({id:F.id,name:F.name})));return}console.log(`ðŸ“‹ Version originale trouvÃ©e: ${L.id} - ${L.name}`),console.log(`ðŸ“‹ Nouvelle version ID: ${u.id} - ${u.name}`);const{data:v,error:D}=yield Y.from("steps").select("*").eq("version_id",L.id);if(D)throw console.error("âŒ Erreur lors de la rÃ©cupÃ©ration des Ã©tapes:",D),D;if(console.log(`ðŸ“ ${(v==null?void 0:v.length)||0} Ã©tape(s) trouvÃ©e(s) Ã  dupliquer`),v&&v.length>0){const F=v.map(U=>({version_id:u.id,step_order:U.step_order,instruction:U.instruction,action_type:U.action_type,target_area:U.target_area,text_input_area:U.text_input_area,start_area:U.start_area,expected_input:U.expected_input,app_image_id:U.app_image_id,pictogram_app_image_id:U.pictogram_app_image_id,icon_name:U.icon_name}));console.log(`âœï¸ Insertion de ${F.length} nouvelle(s) Ã©tape(s)...`);const{error:O}=yield Y.from("steps").insert(F);if(O)throw console.error("âŒ Erreur lors de l'insertion des Ã©tapes:",O),O;console.log(`âœ… ${v.length} Ã©tape(s) dupliquÃ©e(s) avec succÃ¨s`)}else console.warn("âš ï¸ Aucune Ã©tape Ã  dupliquer pour cette version");if(t.task_type==="questionnaire"){const{data:F,error:O}=yield Y.from("questionnaire_questions").select("*").eq("task_id",t.id);if(O)throw O;if(F&&F.length>0){const U=yield Promise.all(F.map(H=>R(void 0,null,function*(){const{data:X,error:A}=yield Y.from("questionnaire_questions").insert([{task_id:t.id,instruction:H.instruction,question_order:H.question_order,question_type:H.question_type,image_id:H.image_id,image_name:H.image_name}]).select().single();if(A)throw A;return{original:H,duplicate:X}})));for(const H of U){const{data:X,error:A}=yield Y.from("questionnaire_choices").select("*").eq("question_id",H.original.id);if(A)throw A;if(X&&X.length>0){const T=X.map(w=>({question_id:H.duplicate.id,text:w.text,choice_order:w.choice_order,is_correct:w.is_correct,image_id:w.image_id,image_name:w.image_name})),{error:I}=yield Y.from("questionnaire_choices").insert(T);if(I)throw I}}}}console.log("âœ… Version et tÃ¢ches dupliquÃ©es avec succÃ¨s")}catch(L){console.error("âŒ Erreur duplication tÃ¢ches:",L),i({title:"Attention",description:"Version dupliquÃ©e mais erreur lors de la copie des tÃ¢ches.",variant:"default"})}}),y=u=>R(void 0,null,function*(){try{yield r(u),i({title:"Version supprimÃ©e",description:"La version a Ã©tÃ© supprimÃ©e."}),(o==null?void 0:o.id)===u&&l(null),c===u&&d(null),h(null)}catch(E){i({title:"Erreur",description:"Impossible de supprimer la version.",variant:"destructive"})}}),N=u=>{const E=$(M({},u),{id:Et(),name:`${u.name} (Copie)`,isNew:!0,originalVersionId:u.id});l(E)},x=u=>{d(E=>E===u?null:u)};return o?e.jsx(Lc,{version:o,onSave:S,onCancel:()=>l(null),onDelete:y}):e.jsxs(e.Fragment,{children:[e.jsxs(J,{className:"mt-6",children:[e.jsxs(ae,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(ie,{children:"Versions"}),e.jsx(me,{children:"GÃ©rez les versions de cette tÃ¢che."})]}),e.jsxs(_,{onClick:g,size:"sm",children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une Version"]})]}),e.jsx(Z,{children:t.versions&&t.versions.length>0?e.jsx("ul",{className:"space-y-3",children:t.versions.map(u=>{const E=f(u.creation_status),L=u.id===c;return e.jsxs("li",{className:"p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold",children:u.name||"Nouvelle Version"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(ze,{variant:"outline",className:`${E.color} text-white`,children:E.label}),e.jsx("span",{className:"text-xs text-muted-foreground",children:u.steps?`${u.steps.length} Ã©tape(s)`:"0 Ã©tape"})]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>j(u),children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>N(u),children:e.jsx(At,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>h(u),disabled:n,children:n?e.jsx(Ee,{className:"h-4 w-4 animate-spin"}):e.jsx(he,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>x(u.id),title:"GÃ©rer les Ã©tapes",children:L?e.jsx(er,{className:"h-4 w-4"}):e.jsx(tr,{className:"h-4 w-4"})})]})]}),L&&e.jsx("div",{className:"mt-4 pl-4 border-l-2",children:e.jsx(Qc,{version:u})})]},u.id)})}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx("p",{children:"Aucune version pour cette tÃ¢che."}),e.jsx("p",{className:"text-sm",children:'Cliquez sur "Ajouter une Version" pour commencer.'})]})})]}),e.jsx(Ke,{open:!!p,onOpenChange:u=>!u&&h(null),children:e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"ÃŠtes-vous sÃ»r(e) ?"}),e.jsxs(tt,{children:['Vous vous apprÃªtez Ã  supprimer la version "',e.jsx("strong",{children:(p==null?void 0:p.name)||"Nouvelle Version"}),'" et toutes ses Ã©tapes. Cette action ne peut pas Ãªtre annulÃ©e.']})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>{p&&y(p.id)},className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Oui, supprimer"})]})]})})]})};var Xt={};/**
 * @license React
 * react-dom-server-legacy.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Oa=m;function ee(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $e=Object.prototype.hasOwnProperty,Gc=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,kn={},En={};function Ba(t){return $e.call(En,t)?!0:$e.call(kn,t)?!1:Gc.test(t)?En[t]=!0:(kn[t]=!0,!1)}function Ie(t,s,r,n,a,i,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=s,this.sanitizeURL=i,this.removeEmptyString=o}var _e={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_e[t]=new Ie(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];_e[s]=new Ie(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_e[t]=new Ie(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_e[t]=new Ie(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_e[t]=new Ie(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_e[t]=new Ie(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_e[t]=new Ie(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_e[t]=new Ie(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_e[t]=new Ie(t,5,!1,t.toLowerCase(),null,!1,!1)});var Xr=/[\-:]([a-z])/g;function Kr(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(Xr,Kr);_e[s]=new Ie(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(Xr,Kr);_e[s]=new Ie(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(Xr,Kr);_e[s]=new Ie(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_e[t]=new Ie(t,1,!1,t.toLowerCase(),null,!1,!1)});_e.xlinkHref=new Ie("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_e[t]=new Ie(t,1,!1,t.toLowerCase(),null,!0,!0)});var As={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Jc=["Webkit","ms","Moz","O"];Object.keys(As).forEach(function(t){Jc.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),As[s]=As[t]})});var Xc=/["'&<>]/;function De(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var s=Xc.exec(t);if(s){var r="",n,a=0;for(n=s.index;n<t.length;n++){switch(t.charCodeAt(n)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 39:s="&#x27;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=s}t=a!==n?r+t.substring(a,n):r}return t}var Kc=/([A-Z])/g,Yc=/^ms-/,Ar=Array.isArray;function ut(t,s){return{insertionMode:t,selectedValue:s}}function Zc(t,s,r){switch(s){case"select":return ut(1,r.value!=null?r.value:r.defaultValue);case"svg":return ut(2,null);case"math":return ut(3,null);case"foreignObject":return ut(1,null);case"table":return ut(4,null);case"thead":case"tbody":case"tfoot":return ut(5,null);case"colgroup":return ut(7,null);case"tr":return ut(6,null)}return 4<=t.insertionMode||t.insertionMode===0?ut(1,null):t}var An=new Map;function qa(t,s,r){if(typeof r!="object")throw Error(ee(62));s=!0;for(var n in r)if($e.call(r,n)){var a=r[n];if(a!=null&&typeof a!="boolean"&&a!==""){if(n.indexOf("--")===0){var i=De(n);a=De((""+a).trim())}else{i=n;var o=An.get(i);o!==void 0||(o=De(i.replace(Kc,"-$1").toLowerCase().replace(Yc,"-ms-")),An.set(i,o)),i=o,a=typeof a=="number"?a===0||$e.call(As,n)?""+a:a+"px":De((""+a).trim())}s?(s=!1,t.push(' style="',i,":",a)):t.push(";",i,":",a)}}s||t.push('"')}function Oe(t,s,r,n){switch(r){case"style":qa(t,s,n);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(s=_e.hasOwnProperty(r)?_e[r]:null,s!==null){switch(typeof n){case"function":case"symbol":return;case"boolean":if(!s.acceptsBooleans)return}switch(r=s.attributeName,s.type){case 3:n&&t.push(" ",r,'=""');break;case 4:n===!0?t.push(" ",r,'=""'):n!==!1&&t.push(" ",r,'="',De(n),'"');break;case 5:isNaN(n)||t.push(" ",r,'="',De(n),'"');break;case 6:!isNaN(n)&&1<=n&&t.push(" ",r,'="',De(n),'"');break;default:s.sanitizeURL&&(n=""+n),t.push(" ",r,'="',De(n),'"')}}else if(Ba(r)){switch(typeof n){case"function":case"symbol":return;case"boolean":if(s=r.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-")return}t.push(" ",r,'="',De(n),'"')}}}function Ts(t,s,r){if(s!=null){if(r!=null)throw Error(ee(60));if(typeof s!="object"||!("__html"in s))throw Error(ee(61));s=s.__html,s!=null&&t.push(""+s)}}function ed(t){var s="";return Oa.Children.forEach(t,function(r){r!=null&&(s+=r)}),s}function xr(t,s,r,n){t.push(at(r));var a=r=null,i;for(i in s)if($e.call(s,i)){var o=s[i];if(o!=null)switch(i){case"children":r=o;break;case"dangerouslySetInnerHTML":a=o;break;default:Oe(t,n,i,o)}}return t.push(">"),Ts(t,a,r),typeof r=="string"?(t.push(De(r)),null):r}var td=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,Tn=new Map;function at(t){var s=Tn.get(t);if(s===void 0){if(!td.test(t))throw Error(ee(65,t));s="<"+t,Tn.set(t,s)}return s}function sd(t,s,r,n,a){switch(s){case"select":t.push(at("select"));var i=null,o=null;for(p in r)if($e.call(r,p)){var l=r[p];if(l!=null)switch(p){case"children":i=l;break;case"dangerouslySetInnerHTML":o=l;break;case"defaultValue":case"value":break;default:Oe(t,n,p,l)}}return t.push(">"),Ts(t,o,i),i;case"option":o=a.selectedValue,t.push(at("option"));var c=l=null,d=null,p=null;for(i in r)if($e.call(r,i)){var h=r[i];if(h!=null)switch(i){case"children":l=h;break;case"selected":d=h;break;case"dangerouslySetInnerHTML":p=h;break;case"value":c=h;default:Oe(t,n,i,h)}}if(o!=null)if(r=c!==null?""+c:ed(l),Ar(o)){for(n=0;n<o.length;n++)if(""+o[n]===r){t.push(' selected=""');break}}else""+o===r&&t.push(' selected=""');else d&&t.push(' selected=""');return t.push(">"),Ts(t,p,l),l;case"textarea":t.push(at("textarea")),p=o=i=null;for(l in r)if($e.call(r,l)&&(c=r[l],c!=null))switch(l){case"children":p=c;break;case"value":i=c;break;case"defaultValue":o=c;break;case"dangerouslySetInnerHTML":throw Error(ee(91));default:Oe(t,n,l,c)}if(i===null&&o!==null&&(i=o),t.push(">"),p!=null){if(i!=null)throw Error(ee(92));if(Ar(p)&&1<p.length)throw Error(ee(93));i=""+p}return typeof i=="string"&&i[0]===`
`&&t.push(`
`),i!==null&&t.push(De(""+i)),null;case"input":t.push(at("input")),c=p=l=i=null;for(o in r)if($e.call(r,o)&&(d=r[o],d!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(ee(399,"input"));case"defaultChecked":c=d;break;case"defaultValue":l=d;break;case"checked":p=d;break;case"value":i=d;break;default:Oe(t,n,o,d)}return p!==null?Oe(t,n,"checked",p):c!==null&&Oe(t,n,"checked",c),i!==null?Oe(t,n,"value",i):l!==null&&Oe(t,n,"value",l),t.push("/>"),null;case"menuitem":t.push(at("menuitem"));for(var f in r)if($e.call(r,f)&&(i=r[f],i!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(ee(400));default:Oe(t,n,f,i)}return t.push(">"),null;case"title":t.push(at("title")),i=null;for(h in r)if($e.call(r,h)&&(o=r[h],o!=null))switch(h){case"children":i=o;break;case"dangerouslySetInnerHTML":throw Error(ee(434));default:Oe(t,n,h,o)}return t.push(">"),i;case"listing":case"pre":t.push(at(s)),o=i=null;for(c in r)if($e.call(r,c)&&(l=r[c],l!=null))switch(c){case"children":i=l;break;case"dangerouslySetInnerHTML":o=l;break;default:Oe(t,n,c,l)}if(t.push(">"),o!=null){if(i!=null)throw Error(ee(60));if(typeof o!="object"||!("__html"in o))throw Error(ee(61));r=o.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?t.push(`
`,r):t.push(""+r))}return typeof i=="string"&&i[0]===`
`&&t.push(`
`),i;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(at(s));for(var g in r)if($e.call(r,g)&&(i=r[g],i!=null))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(ee(399,s));default:Oe(t,n,g,i)}return t.push("/>"),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return xr(t,r,s,n);case"html":return a.insertionMode===0&&t.push("<!DOCTYPE html>"),xr(t,r,s,n);default:if(s.indexOf("-")===-1&&typeof r.is!="string")return xr(t,r,s,n);t.push(at(s)),o=i=null;for(d in r)if($e.call(r,d)&&(l=r[d],l!=null))switch(d){case"children":i=l;break;case"dangerouslySetInnerHTML":o=l;break;case"style":qa(t,n,l);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:Ba(d)&&typeof l!="function"&&typeof l!="symbol"&&t.push(" ",d,'="',De(l),'"')}return t.push(">"),Ts(t,o,i),i}}function Dn(t,s,r){if(t.push('<!--$?--><template id="'),r===null)throw Error(ee(395));return t.push(r),t.push('"></template>')}function rd(t,s,r,n){switch(r.insertionMode){case 0:case 1:return t.push('<div hidden id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');case 2:return t.push('<svg aria-hidden="true" style="display:none" id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');case 3:return t.push('<math aria-hidden="true" style="display:none" id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');case 4:return t.push('<table hidden id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');case 5:return t.push('<table hidden><tbody id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');case 6:return t.push('<table hidden><tr id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');case 7:return t.push('<table hidden><colgroup id="'),t.push(s.segmentPrefix),s=n.toString(16),t.push(s),t.push('">');default:throw Error(ee(397))}}function nd(t,s){switch(s.insertionMode){case 0:case 1:return t.push("</div>");case 2:return t.push("</svg>");case 3:return t.push("</math>");case 4:return t.push("</table>");case 5:return t.push("</tbody></table>");case 6:return t.push("</tr></table>");case 7:return t.push("</colgroup></table>");default:throw Error(ee(397))}}var ad=/[<\u2028\u2029]/g;function fr(t){return JSON.stringify(t).replace(ad,function(s){switch(s){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}function id(t,s){return s=s===void 0?"":s,{bootstrapChunks:[],startInlineScript:"<script>",placeholderPrefix:s+"P:",segmentPrefix:s+"S:",boundaryPrefix:s+"B:",idPrefix:s,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1,generateStaticMarkup:t}}function Mn(t,s,r,n){return r.generateStaticMarkup?(t.push(De(s)),!1):(s===""?t=n:(n&&t.push("<!-- -->"),t.push(De(s)),t=!0),t)}var as=Object.assign,od=Symbol.for("react.element"),Ua=Symbol.for("react.portal"),Wa=Symbol.for("react.fragment"),Qa=Symbol.for("react.strict_mode"),Ha=Symbol.for("react.profiler"),Ga=Symbol.for("react.provider"),Ja=Symbol.for("react.context"),Xa=Symbol.for("react.forward_ref"),Ka=Symbol.for("react.suspense"),Ya=Symbol.for("react.suspense_list"),Za=Symbol.for("react.memo"),Yr=Symbol.for("react.lazy"),ld=Symbol.for("react.scope"),cd=Symbol.for("react.debug_trace_mode"),dd=Symbol.for("react.legacy_hidden"),ud=Symbol.for("react.default_value"),Fn=Symbol.iterator;function Tr(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Wa:return"Fragment";case Ua:return"Portal";case Ha:return"Profiler";case Qa:return"StrictMode";case Ka:return"Suspense";case Ya:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Ja:return(t.displayName||"Context")+".Consumer";case Ga:return(t._context.displayName||"Context")+".Provider";case Xa:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Za:return s=t.displayName||null,s!==null?s:Tr(t.type)||"Memo";case Yr:s=t._payload,t=t._init;try{return Tr(t(s))}catch(r){}}return null}var ei={};function In(t,s){if(t=t.contextTypes,!t)return ei;var r={},n;for(n in t)r[n]=s[n];return r}var It=null;function ir(t,s){if(t!==s){t.context._currentValue2=t.parentValue,t=t.parent;var r=s.parent;if(t===null){if(r!==null)throw Error(ee(401))}else{if(r===null)throw Error(ee(401));ir(t,r)}s.context._currentValue2=s.value}}function ti(t){t.context._currentValue2=t.parentValue,t=t.parent,t!==null&&ti(t)}function si(t){var s=t.parent;s!==null&&si(s),t.context._currentValue2=t.value}function ri(t,s){if(t.context._currentValue2=t.parentValue,t=t.parent,t===null)throw Error(ee(402));t.depth===s.depth?ir(t,s):ri(t,s)}function ni(t,s){var r=s.parent;if(r===null)throw Error(ee(402));t.depth===r.depth?ir(t,r):ni(t,r),s.context._currentValue2=s.value}function qs(t){var s=It;s!==t&&(s===null?si(t):t===null?ti(s):s.depth===t.depth?ir(s,t):s.depth>t.depth?ri(s,t):ni(s,t),It=t)}var Pn={isMounted:function(){return!1},enqueueSetState:function(t,s){t=t._reactInternals,t.queue!==null&&t.queue.push(s)},enqueueReplaceState:function(t,s){t=t._reactInternals,t.replace=!0,t.queue=[s]},enqueueForceUpdate:function(){}};function $n(t,s,r,n){var a=t.state!==void 0?t.state:null;t.updater=Pn,t.props=r,t.state=a;var i={queue:[],replace:!1};t._reactInternals=i;var o=s.contextType;if(t.context=typeof o=="object"&&o!==null?o._currentValue2:n,o=s.getDerivedStateFromProps,typeof o=="function"&&(o=o(r,a),a=o==null?a:as({},a,o),t.state=a),typeof s.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(s=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),s!==t.state&&Pn.enqueueReplaceState(t,t.state,null),i.queue!==null&&0<i.queue.length)if(s=i.queue,o=i.replace,i.queue=null,i.replace=!1,o&&s.length===1)t.state=s[0];else{for(i=o?s[0]:t.state,a=!0,o=o?1:0;o<s.length;o++){var l=s[o];l=typeof l=="function"?l.call(t,i,r,n):l,l!=null&&(a?(a=!1,i=as({},i,l)):as(i,l))}t.state=i}else i.queue=null}var md={id:1,overflow:""};function Dr(t,s,r){var n=t.id;t=t.overflow;var a=32-Ds(n)-1;n&=~(1<<a),r+=1;var i=32-Ds(s)+a;if(30<i){var o=a-a%5;return i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,{id:1<<32-Ds(s)+a|r<<a|n,overflow:i+t}}return{id:1<<i|r<<a|n,overflow:t}}var Ds=Math.clz32?Math.clz32:xd,hd=Math.log,pd=Math.LN2;function xd(t){return t>>>=0,t===0?32:31-(hd(t)/pd|0)|0}function fd(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var gd=typeof Object.is=="function"?Object.is:fd,vt=null,Zr=null,Ms=null,de=null,ts=!1,Us=!1,ds=0,St=null,or=0;function Dt(){if(vt===null)throw Error(ee(321));return vt}function Rn(){if(0<or)throw Error(ee(312));return{memoizedState:null,queue:null,next:null}}function en(){return de===null?Ms===null?(ts=!1,Ms=de=Rn()):(ts=!0,de=Ms):de.next===null?(ts=!1,de=de.next=Rn()):(ts=!0,de=de.next),de}function tn(){Zr=vt=null,Us=!1,Ms=null,or=0,de=St=null}function ai(t,s){return typeof s=="function"?s(t):s}function Ln(t,s,r){if(vt=Dt(),de=en(),ts){var n=de.queue;if(s=n.dispatch,St!==null&&(r=St.get(n),r!==void 0)){St.delete(n),n=de.memoizedState;do n=t(n,r.action),r=r.next;while(r!==null);return de.memoizedState=n,[n,s]}return[de.memoizedState,s]}return t=t===ai?typeof s=="function"?s():s:r!==void 0?r(s):s,de.memoizedState=t,t=de.queue={last:null,dispatch:null},t=t.dispatch=jd.bind(null,vt,t),[de.memoizedState,t]}function zn(t,s){if(vt=Dt(),de=en(),s=s===void 0?null:s,de!==null){var r=de.memoizedState;if(r!==null&&s!==null){var n=r[1];e:if(n===null)n=!1;else{for(var a=0;a<n.length&&a<s.length;a++)if(!gd(s[a],n[a])){n=!1;break e}n=!0}if(n)return r[0]}}return t=t(),de.memoizedState=[t,s],t}function jd(t,s,r){if(25<=or)throw Error(ee(301));if(t===vt)if(Us=!0,t={action:r,next:null},St===null&&(St=new Map),r=St.get(s),r===void 0)St.set(s,t);else{for(s=r;s.next!==null;)s=s.next;s.next=t}}function vd(){throw Error(ee(394))}function bs(){}var Vn={readContext:function(t){return t._currentValue2},useContext:function(t){return Dt(),t._currentValue2},useMemo:zn,useReducer:Ln,useRef:function(t){vt=Dt(),de=en();var s=de.memoizedState;return s===null?(t={current:t},de.memoizedState=t):s},useState:function(t){return Ln(ai,t)},useInsertionEffect:bs,useLayoutEffect:function(){},useCallback:function(t,s){return zn(function(){return t},s)},useImperativeHandle:bs,useEffect:bs,useDebugValue:bs,useDeferredValue:function(t){return Dt(),t},useTransition:function(){return Dt(),[!1,vd]},useId:function(){var t=Zr.treeContext,s=t.overflow;t=t.id,t=(t&~(1<<32-Ds(t)-1)).toString(32)+s;var r=Fs;if(r===null)throw Error(ee(404));return s=ds++,t=":"+r.idPrefix+"R"+t,0<s&&(t+="H"+s.toString(32)),t+":"},useMutableSource:function(t,s){return Dt(),s(t._source)},useSyncExternalStore:function(t,s,r){if(r===void 0)throw Error(ee(407));return r()}},Fs=null,gr=Oa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function yd(t){return console.error(t),null}function ss(){}function bd(t,s,r,n,a,i,o,l,c){var d=[],p=new Set;return s={destination:null,responseState:s,progressiveChunkSize:n===void 0?12800:n,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:p,pingedTasks:d,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:a===void 0?yd:a,onAllReady:i===void 0?ss:i,onShellReady:o===void 0?ss:o,onShellError:l===void 0?ss:l,onFatalError:c===void 0?ss:c},r=Ws(s,0,null,r,!1,!1),r.parentFlushed=!0,t=sn(s,t,null,r,p,ei,null,md),d.push(t),s}function sn(t,s,r,n,a,i,o,l){t.allPendingTasks++,r===null?t.pendingRootTasks++:r.pendingTasks++;var c={node:s,ping:function(){var d=t.pingedTasks;d.push(c),d.length===1&&li(t)},blockedBoundary:r,blockedSegment:n,abortSet:a,legacyContext:i,context:o,treeContext:l};return a.add(c),c}function Ws(t,s,r,n,a,i){return{status:0,id:-1,index:s,parentFlushed:!1,chunks:[],children:[],formatContext:n,boundary:r,lastPushedText:a,textEmbedded:i}}function us(t,s){if(t=t.onError(s),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function Qs(t,s){var r=t.onShellError;r(s),r=t.onFatalError,r(s),t.destination!==null?(t.status=2,t.destination.destroy(s)):(t.status=1,t.fatalError=s)}function On(t,s,r,n,a){for(vt={},Zr=s,ds=0,t=r(n,a);Us;)Us=!1,ds=0,or+=1,de=null,t=r(n,a);return tn(),t}function Bn(t,s,r,n){var a=r.render(),i=n.childContextTypes;if(i!=null){var o=s.legacyContext;if(typeof r.getChildContext!="function")n=o;else{r=r.getChildContext();for(var l in r)if(!(l in i))throw Error(ee(108,Tr(n)||"Unknown",l));n=as({},o,r)}s.legacyContext=n,qe(t,s,a),s.legacyContext=o}else qe(t,s,a)}function qn(t,s){if(t&&t.defaultProps){s=as({},s),t=t.defaultProps;for(var r in t)s[r]===void 0&&(s[r]=t[r]);return s}return s}function Mr(t,s,r,n,a){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){a=In(r,s.legacyContext);var i=r.contextType;i=new r(n,typeof i=="object"&&i!==null?i._currentValue2:a),$n(i,r,n,a),Bn(t,s,i,r)}else{i=In(r,s.legacyContext),a=On(t,s,r,n,i);var o=ds!==0;if(typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0)$n(a,r,n,i),Bn(t,s,a,r);else if(o){n=s.treeContext,s.treeContext=Dr(n,1,0);try{qe(t,s,a)}finally{s.treeContext=n}}else qe(t,s,a)}else if(typeof r=="string"){switch(a=s.blockedSegment,i=sd(a.chunks,r,n,t.responseState,a.formatContext),a.lastPushedText=!1,o=a.formatContext,a.formatContext=Zc(o,r,n),Fr(t,s,i),a.formatContext=o,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:a.chunks.push("</",r,">")}a.lastPushedText=!1}else{switch(r){case dd:case cd:case Qa:case Ha:case Wa:qe(t,s,n.children);return;case Ya:qe(t,s,n.children);return;case ld:throw Error(ee(343));case Ka:e:{r=s.blockedBoundary,a=s.blockedSegment,i=n.fallback,n=n.children,o=new Set;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},c=Ws(t,a.chunks.length,l,a.formatContext,!1,!1);a.children.push(c),a.lastPushedText=!1;var d=Ws(t,0,null,a.formatContext,!1,!1);d.parentFlushed=!0,s.blockedBoundary=l,s.blockedSegment=d;try{if(Fr(t,s,n),t.responseState.generateStaticMarkup||d.lastPushedText&&d.textEmbedded&&d.chunks.push("<!-- -->"),d.status=1,Hs(l,d),l.pendingTasks===0)break e}catch(p){d.status=4,l.forceClientRender=!0,l.errorDigest=us(t,p)}finally{s.blockedBoundary=r,s.blockedSegment=a}s=sn(t,i,r,c,o,s.legacyContext,s.context,s.treeContext),t.pingedTasks.push(s)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case Xa:if(n=On(t,s,r.render,n,a),ds!==0){r=s.treeContext,s.treeContext=Dr(r,1,0);try{qe(t,s,n)}finally{s.treeContext=r}}else qe(t,s,n);return;case Za:r=r.type,n=qn(r,n),Mr(t,s,r,n,a);return;case Ga:if(a=n.children,r=r._context,n=n.value,i=r._currentValue2,r._currentValue2=n,o=It,It=n={parent:o,depth:o===null?0:o.depth+1,context:r,parentValue:i,value:n},s.context=n,qe(t,s,a),t=It,t===null)throw Error(ee(403));n=t.parentValue,t.context._currentValue2=n===ud?t.context._defaultValue:n,t=It=t.parent,s.context=t;return;case Ja:n=n.children,n=n(r._currentValue2),qe(t,s,n);return;case Yr:a=r._init,r=a(r._payload),n=qn(r,n),Mr(t,s,r,n,void 0);return}throw Error(ee(130,r==null?r:typeof r,""))}}function qe(t,s,r){if(s.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case od:Mr(t,s,r.type,r.props,r.ref);return;case Ua:throw Error(ee(257));case Yr:var n=r._init;r=n(r._payload),qe(t,s,r);return}if(Ar(r)){Un(t,s,r);return}if(r===null||typeof r!="object"?n=null:(n=Fn&&r[Fn]||r["@@iterator"],n=typeof n=="function"?n:null),n&&(n=n.call(r))){if(r=n.next(),!r.done){var a=[];do a.push(r.value),r=n.next();while(!r.done);Un(t,s,a)}return}throw t=Object.prototype.toString.call(r),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}typeof r=="string"?(n=s.blockedSegment,n.lastPushedText=Mn(s.blockedSegment.chunks,r,t.responseState,n.lastPushedText)):typeof r=="number"&&(n=s.blockedSegment,n.lastPushedText=Mn(s.blockedSegment.chunks,""+r,t.responseState,n.lastPushedText))}function Un(t,s,r){for(var n=r.length,a=0;a<n;a++){var i=s.treeContext;s.treeContext=Dr(i,n,a);try{Fr(t,s,r[a])}finally{s.treeContext=i}}}function Fr(t,s,r){var n=s.blockedSegment.formatContext,a=s.legacyContext,i=s.context;try{return qe(t,s,r)}catch(c){if(tn(),typeof c=="object"&&c!==null&&typeof c.then=="function"){r=c;var o=s.blockedSegment,l=Ws(t,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(l),o.lastPushedText=!1,t=sn(t,s.node,s.blockedBoundary,l,s.abortSet,s.legacyContext,s.context,s.treeContext).ping,r.then(t,t),s.blockedSegment.formatContext=n,s.legacyContext=a,s.context=i,qs(i)}else throw s.blockedSegment.formatContext=n,s.legacyContext=a,s.context=i,qs(i),c}}function wd(t){var s=t.blockedBoundary;t=t.blockedSegment,t.status=3,oi(this,s,t)}function ii(t,s,r){var n=t.blockedBoundary;t.blockedSegment.status=3,n===null?(s.allPendingTasks--,s.status!==2&&(s.status=2,s.destination!==null&&s.destination.push(null))):(n.pendingTasks--,n.forceClientRender||(n.forceClientRender=!0,t=r===void 0?Error(ee(432)):r,n.errorDigest=s.onError(t),n.parentFlushed&&s.clientRenderedBoundaries.push(n)),n.fallbackAbortableTasks.forEach(function(a){return ii(a,s,r)}),n.fallbackAbortableTasks.clear(),s.allPendingTasks--,s.allPendingTasks===0&&(n=s.onAllReady,n()))}function Hs(t,s){if(s.chunks.length===0&&s.children.length===1&&s.children[0].boundary===null){var r=s.children[0];r.id=s.id,r.parentFlushed=!0,r.status===1&&Hs(t,r)}else t.completedSegments.push(s)}function oi(t,s,r){if(s===null){if(r.parentFlushed){if(t.completedRootSegment!==null)throw Error(ee(389));t.completedRootSegment=r}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=ss,s=t.onShellReady,s())}else s.pendingTasks--,s.forceClientRender||(s.pendingTasks===0?(r.parentFlushed&&r.status===1&&Hs(s,r),s.parentFlushed&&t.completedBoundaries.push(s),s.fallbackAbortableTasks.forEach(wd,t),s.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(Hs(s,r),s.completedSegments.length===1&&s.parentFlushed&&t.partialBoundaries.push(s)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function li(t){if(t.status!==2){var s=It,r=gr.current;gr.current=Vn;var n=Fs;Fs=t.responseState;try{var a=t.pingedTasks,i;for(i=0;i<a.length;i++){var o=a[i],l=t,c=o.blockedSegment;if(c.status===0){qs(o.context);try{qe(l,o,o.node),l.responseState.generateStaticMarkup||c.lastPushedText&&c.textEmbedded&&c.chunks.push("<!-- -->"),o.abortSet.delete(o),c.status=1,oi(l,o.blockedBoundary,c)}catch(j){if(tn(),typeof j=="object"&&j!==null&&typeof j.then=="function"){var d=o.ping;j.then(d,d)}else{o.abortSet.delete(o),c.status=4;var p=o.blockedBoundary,h=j,f=us(l,h);if(p===null?Qs(l,h):(p.pendingTasks--,p.forceClientRender||(p.forceClientRender=!0,p.errorDigest=f,p.parentFlushed&&l.clientRenderedBoundaries.push(p))),l.allPendingTasks--,l.allPendingTasks===0){var g=l.onAllReady;g()}}}finally{}}}a.splice(0,i),t.destination!==null&&rn(t,t.destination)}catch(j){us(t,j),Qs(t,j)}finally{Fs=n,gr.current=r,r===Vn&&qs(s)}}}function ws(t,s,r){switch(r.parentFlushed=!0,r.status){case 0:var n=r.id=t.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,t=t.responseState,s.push('<template id="'),s.push(t.placeholderPrefix),t=n.toString(16),s.push(t),s.push('"></template>');case 1:r.status=2;var a=!0;n=r.chunks;var i=0;r=r.children;for(var o=0;o<r.length;o++){for(a=r[o];i<a.index;i++)s.push(n[i]);a=lr(t,s,a)}for(;i<n.length-1;i++)s.push(n[i]);return i<n.length&&(a=s.push(n[i])),a;default:throw Error(ee(390))}}function lr(t,s,r){var n=r.boundary;if(n===null)return ws(t,s,r);if(n.parentFlushed=!0,n.forceClientRender)return t.responseState.generateStaticMarkup||(n=n.errorDigest,s.push("<!--$!-->"),s.push("<template"),n&&(s.push(' data-dgst="'),n=De(n),s.push(n),s.push('"')),s.push("></template>")),ws(t,s,r),t=t.responseState.generateStaticMarkup?!0:s.push("<!--/$-->"),t;if(0<n.pendingTasks){n.rootSegmentID=t.nextSegmentId++,0<n.completedSegments.length&&t.partialBoundaries.push(n);var a=t.responseState,i=a.nextSuspenseID++;return a=a.boundaryPrefix+i.toString(16),n=n.id=a,Dn(s,t.responseState,n),ws(t,s,r),s.push("<!--/$-->")}if(n.byteSize>t.progressiveChunkSize)return n.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(n),Dn(s,t.responseState,n.id),ws(t,s,r),s.push("<!--/$-->");if(t.responseState.generateStaticMarkup||s.push("<!--$-->"),r=n.completedSegments,r.length!==1)throw Error(ee(391));return lr(t,s,r[0]),t=t.responseState.generateStaticMarkup?!0:s.push("<!--/$-->"),t}function Wn(t,s,r){return rd(s,t.responseState,r.formatContext,r.id),lr(t,s,r),nd(s,r.formatContext)}function Qn(t,s,r){for(var n=r.completedSegments,a=0;a<n.length;a++)ci(t,s,r,n[a]);if(n.length=0,t=t.responseState,n=r.id,r=r.rootSegmentID,s.push(t.startInlineScript),t.sentCompleteBoundaryFunction?s.push('$RC("'):(t.sentCompleteBoundaryFunction=!0,s.push('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("')),n===null)throw Error(ee(395));return r=r.toString(16),s.push(n),s.push('","'),s.push(t.segmentPrefix),s.push(r),s.push('")<\/script>')}function ci(t,s,r,n){if(n.status===2)return!0;var a=n.id;if(a===-1){if((n.id=r.rootSegmentID)===-1)throw Error(ee(392));return Wn(t,s,n)}return Wn(t,s,n),t=t.responseState,s.push(t.startInlineScript),t.sentCompleteSegmentFunction?s.push('$RS("'):(t.sentCompleteSegmentFunction=!0,s.push('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("')),s.push(t.segmentPrefix),a=a.toString(16),s.push(a),s.push('","'),s.push(t.placeholderPrefix),s.push(a),s.push('")<\/script>')}function rn(t,s){try{var r=t.completedRootSegment;if(r!==null&&t.pendingRootTasks===0){lr(t,s,r),t.completedRootSegment=null;var n=t.responseState.bootstrapChunks;for(r=0;r<n.length-1;r++)s.push(n[r]);r<n.length&&s.push(n[r])}var a=t.clientRenderedBoundaries,i;for(i=0;i<a.length;i++){var o=a[i];n=s;var l=t.responseState,c=o.id,d=o.errorDigest,p=o.errorMessage,h=o.errorComponentStack;if(n.push(l.startInlineScript),l.sentClientRenderFunction?n.push('$RX("'):(l.sentClientRenderFunction=!0,n.push('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("')),c===null)throw Error(ee(395));if(n.push(c),n.push('"'),d||p||h){n.push(",");var f=fr(d||"");n.push(f)}if(p||h){n.push(",");var g=fr(p||"");n.push(g)}if(h){n.push(",");var j=fr(h);n.push(j)}if(!n.push(")<\/script>")){t.destination=null,i++,a.splice(0,i);return}}a.splice(0,i);var S=t.completedBoundaries;for(i=0;i<S.length;i++)if(!Qn(t,s,S[i])){t.destination=null,i++,S.splice(0,i);return}S.splice(0,i);var b=t.partialBoundaries;for(i=0;i<b.length;i++){var y=b[i];e:{a=t,o=s;var N=y.completedSegments;for(l=0;l<N.length;l++)if(!ci(a,o,y,N[l])){l++,N.splice(0,l);var x=!1;break e}N.splice(0,l),x=!0}if(!x){t.destination=null,i++,b.splice(0,i);return}}b.splice(0,i);var u=t.completedBoundaries;for(i=0;i<u.length;i++)if(!Qn(t,s,u[i])){t.destination=null,i++,u.splice(0,i);return}u.splice(0,i)}finally{t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&s.push(null)}}function Nd(t,s){try{var r=t.abortableTasks;r.forEach(function(n){return ii(n,t,s)}),r.clear(),t.destination!==null&&rn(t,t.destination)}catch(n){us(t,n),Qs(t,n)}}function Sd(){}function di(t,s,r,n){var a=!1,i=null,o="",l={push:function(d){return d!==null&&(o+=d),!0},destroy:function(d){a=!0,i=d}},c=!1;if(t=bd(t,id(r,s?s.identifierPrefix:void 0),{insertionMode:1,selectedValue:null},1/0,Sd,void 0,function(){c=!0},void 0,void 0),li(t),Nd(t,n),t.status===1)t.status=2,l.destroy(t.fatalError);else if(t.status!==2&&t.destination===null){t.destination=l;try{rn(t,l)}catch(d){us(t,d),Qs(t,d)}}if(a)throw i;if(!c)throw Error(ee(426));return o}Xt.renderToNodeStream=function(){throw Error(ee(207))};Xt.renderToStaticMarkup=function(t,s){return di(t,s,!0,'The server used "renderToStaticMarkup" which does not support Suspense. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Xt.renderToStaticNodeStream=function(){throw Error(ee(208))};Xt.renderToString=function(t,s){return di(t,s,!1,'The server used "renderToString" which does not support Suspense. If you intended for this Suspense boundary to render the fallback content on the server consider throwing an Error somewhere within the Suspense boundary. If you intended to have the server wait for the suspended component please switch to "renderToReadableStream" which supports Suspense on the server')};Xt.version="18.3.1";var nn={};/**
 * @license React
 * react-dom-server.browser.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ui=m;function te(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Ue=null,We=0;function W(t,s){if(s.length!==0)if(512<s.length)0<We&&(t.enqueue(new Uint8Array(Ue.buffer,0,We)),Ue=new Uint8Array(512),We=0),t.enqueue(s);else{var r=Ue.length-We;r<s.length&&(r===0?t.enqueue(Ue):(Ue.set(s.subarray(0,r),We),t.enqueue(Ue),s=s.subarray(r)),Ue=new Uint8Array(512),We=0),Ue.set(s,We),We+=s.length}}function pe(t,s){return W(t,s),!0}function Hn(t){Ue&&0<We&&(t.enqueue(new Uint8Array(Ue.buffer,0,We)),Ue=null,We=0)}var mi=new TextEncoder;function ne(t){return mi.encode(t)}function V(t){return mi.encode(t)}function hi(t,s){typeof t.error=="function"?t.error(s):t.close()}var Re=Object.prototype.hasOwnProperty,Cd=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gn={},Jn={};function pi(t){return Re.call(Jn,t)?!0:Re.call(Gn,t)?!1:Cd.test(t)?Jn[t]=!0:(Gn[t]=!0,!1)}function Pe(t,s,r,n,a,i,o){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=s,this.sanitizeURL=i,this.removeEmptyString=o}var ke={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){ke[t]=new Pe(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];ke[s]=new Pe(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){ke[t]=new Pe(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){ke[t]=new Pe(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){ke[t]=new Pe(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){ke[t]=new Pe(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){ke[t]=new Pe(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){ke[t]=new Pe(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){ke[t]=new Pe(t,5,!1,t.toLowerCase(),null,!1,!1)});var an=/[\-:]([a-z])/g;function on(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(an,on);ke[s]=new Pe(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(an,on);ke[s]=new Pe(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(an,on);ke[s]=new Pe(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){ke[t]=new Pe(t,1,!1,t.toLowerCase(),null,!1,!1)});ke.xlinkHref=new Pe("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){ke[t]=new Pe(t,1,!1,t.toLowerCase(),null,!0,!0)});var Is={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},_d=["Webkit","ms","Moz","O"];Object.keys(Is).forEach(function(t){_d.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),Is[s]=Is[t]})});var kd=/["'&<>]/;function Se(t){if(typeof t=="boolean"||typeof t=="number")return""+t;t=""+t;var s=kd.exec(t);if(s){var r="",n,a=0;for(n=s.index;n<t.length;n++){switch(t.charCodeAt(n)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 39:s="&#x27;";break;case 60:s="&lt;";break;case 62:s="&gt;";break;default:continue}a!==n&&(r+=t.substring(a,n)),a=n+1,r+=s}t=a!==n?r+t.substring(a,n):r}return t}var Ed=/([A-Z])/g,Ad=/^ms-/,Ir=Array.isArray,Td=V("<script>"),Dd=V("<\/script>"),Md=V('<script src="'),Fd=V('<script type="module" src="'),Xn=V('" async=""><\/script>'),Id=/(<\/|<)(s)(cript)/gi;function Pd(t,s,r,n){return""+s+(r==="s"?"\\u0073":"\\u0053")+n}function $d(t,s,r,n,a){t=t===void 0?"":t,s=s===void 0?Td:V('<script nonce="'+Se(s)+'">');var i=[];if(r!==void 0&&i.push(s,ne((""+r).replace(Id,Pd)),Dd),n!==void 0)for(r=0;r<n.length;r++)i.push(Md,ne(Se(n[r])),Xn);if(a!==void 0)for(n=0;n<a.length;n++)i.push(Fd,ne(Se(a[n])),Xn);return{bootstrapChunks:i,startInlineScript:s,placeholderPrefix:V(t+"P:"),segmentPrefix:V(t+"S:"),boundaryPrefix:t+"B:",idPrefix:t,nextSuspenseID:0,sentCompleteSegmentFunction:!1,sentCompleteBoundaryFunction:!1,sentClientRenderFunction:!1}}function it(t,s){return{insertionMode:t,selectedValue:s}}function Rd(t){return it(t==="http://www.w3.org/2000/svg"?2:t==="http://www.w3.org/1998/Math/MathML"?3:0,null)}function Ld(t,s,r){switch(s){case"select":return it(1,r.value!=null?r.value:r.defaultValue);case"svg":return it(2,null);case"math":return it(3,null);case"foreignObject":return it(1,null);case"table":return it(4,null);case"thead":case"tbody":case"tfoot":return it(5,null);case"colgroup":return it(7,null);case"tr":return it(6,null)}return 4<=t.insertionMode||t.insertionMode===0?it(1,null):t}var ln=V("<!-- -->");function Kn(t,s,r,n){return s===""?n:(n&&t.push(ln),t.push(ne(Se(s))),!0)}var Yn=new Map,zd=V(' style="'),Zn=V(":"),Vd=V(";");function xi(t,s,r){if(typeof r!="object")throw Error(te(62));s=!0;for(var n in r)if(Re.call(r,n)){var a=r[n];if(a!=null&&typeof a!="boolean"&&a!==""){if(n.indexOf("--")===0){var i=ne(Se(n));a=ne(Se((""+a).trim()))}else{i=n;var o=Yn.get(i);o!==void 0||(o=V(Se(i.replace(Ed,"-$1").toLowerCase().replace(Ad,"-ms-"))),Yn.set(i,o)),i=o,a=typeof a=="number"?a===0||Re.call(Is,n)?ne(""+a):ne(a+"px"):ne(Se((""+a).trim()))}s?(s=!1,t.push(zd,i,Zn,a)):t.push(Vd,i,Zn,a)}}s||t.push(Mt)}var wt=V(" "),Ut=V('="'),Mt=V('"'),ea=V('=""');function Be(t,s,r,n){switch(r){case"style":xi(t,s,n);return;case"defaultValue":case"defaultChecked":case"innerHTML":case"suppressContentEditableWarning":case"suppressHydrationWarning":return}if(!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N"){if(s=ke.hasOwnProperty(r)?ke[r]:null,s!==null){switch(typeof n){case"function":case"symbol":return;case"boolean":if(!s.acceptsBooleans)return}switch(r=ne(s.attributeName),s.type){case 3:n&&t.push(wt,r,ea);break;case 4:n===!0?t.push(wt,r,ea):n!==!1&&t.push(wt,r,Ut,ne(Se(n)),Mt);break;case 5:isNaN(n)||t.push(wt,r,Ut,ne(Se(n)),Mt);break;case 6:!isNaN(n)&&1<=n&&t.push(wt,r,Ut,ne(Se(n)),Mt);break;default:s.sanitizeURL&&(n=""+n),t.push(wt,r,Ut,ne(Se(n)),Mt)}}else if(pi(r)){switch(typeof n){case"function":case"symbol":return;case"boolean":if(s=r.toLowerCase().slice(0,5),s!=="data-"&&s!=="aria-")return}t.push(wt,ne(r),Ut,ne(Se(n)),Mt)}}}var Nt=V(">"),ta=V("/>");function Ps(t,s,r){if(s!=null){if(r!=null)throw Error(te(60));if(typeof s!="object"||!("__html"in s))throw Error(te(61));s=s.__html,s!=null&&t.push(ne(""+s))}}function Od(t){var s="";return ui.Children.forEach(t,function(r){r!=null&&(s+=r)}),s}var jr=V(' selected=""');function vr(t,s,r,n){t.push(ot(r));var a=r=null,i;for(i in s)if(Re.call(s,i)){var o=s[i];if(o!=null)switch(i){case"children":r=o;break;case"dangerouslySetInnerHTML":a=o;break;default:Be(t,n,i,o)}}return t.push(Nt),Ps(t,a,r),typeof r=="string"?(t.push(ne(Se(r))),null):r}var yr=V(`
`),Bd=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,sa=new Map;function ot(t){var s=sa.get(t);if(s===void 0){if(!Bd.test(t))throw Error(te(65,t));s=V("<"+t),sa.set(t,s)}return s}var qd=V("<!DOCTYPE html>");function Ud(t,s,r,n,a){switch(s){case"select":t.push(ot("select"));var i=null,o=null;for(p in r)if(Re.call(r,p)){var l=r[p];if(l!=null)switch(p){case"children":i=l;break;case"dangerouslySetInnerHTML":o=l;break;case"defaultValue":case"value":break;default:Be(t,n,p,l)}}return t.push(Nt),Ps(t,o,i),i;case"option":o=a.selectedValue,t.push(ot("option"));var c=l=null,d=null,p=null;for(i in r)if(Re.call(r,i)){var h=r[i];if(h!=null)switch(i){case"children":l=h;break;case"selected":d=h;break;case"dangerouslySetInnerHTML":p=h;break;case"value":c=h;default:Be(t,n,i,h)}}if(o!=null)if(r=c!==null?""+c:Od(l),Ir(o)){for(n=0;n<o.length;n++)if(""+o[n]===r){t.push(jr);break}}else""+o===r&&t.push(jr);else d&&t.push(jr);return t.push(Nt),Ps(t,p,l),l;case"textarea":t.push(ot("textarea")),p=o=i=null;for(l in r)if(Re.call(r,l)&&(c=r[l],c!=null))switch(l){case"children":p=c;break;case"value":i=c;break;case"defaultValue":o=c;break;case"dangerouslySetInnerHTML":throw Error(te(91));default:Be(t,n,l,c)}if(i===null&&o!==null&&(i=o),t.push(Nt),p!=null){if(i!=null)throw Error(te(92));if(Ir(p)&&1<p.length)throw Error(te(93));i=""+p}return typeof i=="string"&&i[0]===`
`&&t.push(yr),i!==null&&t.push(ne(Se(""+i))),null;case"input":t.push(ot("input")),c=p=l=i=null;for(o in r)if(Re.call(r,o)&&(d=r[o],d!=null))switch(o){case"children":case"dangerouslySetInnerHTML":throw Error(te(399,"input"));case"defaultChecked":c=d;break;case"defaultValue":l=d;break;case"checked":p=d;break;case"value":i=d;break;default:Be(t,n,o,d)}return p!==null?Be(t,n,"checked",p):c!==null&&Be(t,n,"checked",c),i!==null?Be(t,n,"value",i):l!==null&&Be(t,n,"value",l),t.push(ta),null;case"menuitem":t.push(ot("menuitem"));for(var f in r)if(Re.call(r,f)&&(i=r[f],i!=null))switch(f){case"children":case"dangerouslySetInnerHTML":throw Error(te(400));default:Be(t,n,f,i)}return t.push(Nt),null;case"title":t.push(ot("title")),i=null;for(h in r)if(Re.call(r,h)&&(o=r[h],o!=null))switch(h){case"children":i=o;break;case"dangerouslySetInnerHTML":throw Error(te(434));default:Be(t,n,h,o)}return t.push(Nt),i;case"listing":case"pre":t.push(ot(s)),o=i=null;for(c in r)if(Re.call(r,c)&&(l=r[c],l!=null))switch(c){case"children":i=l;break;case"dangerouslySetInnerHTML":o=l;break;default:Be(t,n,c,l)}if(t.push(Nt),o!=null){if(i!=null)throw Error(te(60));if(typeof o!="object"||!("__html"in o))throw Error(te(61));r=o.__html,r!=null&&(typeof r=="string"&&0<r.length&&r[0]===`
`?t.push(yr,ne(r)):t.push(ne(""+r)))}return typeof i=="string"&&i[0]===`
`&&t.push(yr),i;case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":t.push(ot(s));for(var g in r)if(Re.call(r,g)&&(i=r[g],i!=null))switch(g){case"children":case"dangerouslySetInnerHTML":throw Error(te(399,s));default:Be(t,n,g,i)}return t.push(ta),null;case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return vr(t,r,s,n);case"html":return a.insertionMode===0&&t.push(qd),vr(t,r,s,n);default:if(s.indexOf("-")===-1&&typeof r.is!="string")return vr(t,r,s,n);t.push(ot(s)),o=i=null;for(d in r)if(Re.call(r,d)&&(l=r[d],l!=null))switch(d){case"children":i=l;break;case"dangerouslySetInnerHTML":o=l;break;case"style":xi(t,n,l);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":break;default:pi(d)&&typeof l!="function"&&typeof l!="symbol"&&t.push(wt,ne(d),Ut,ne(Se(l)),Mt)}return t.push(Nt),Ps(t,o,i),i}}var Wd=V("</"),Qd=V(">"),Hd=V('<template id="'),Gd=V('"></template>'),Jd=V("<!--$-->"),Xd=V('<!--$?--><template id="'),Kd=V('"></template>'),Yd=V("<!--$!-->"),Zd=V("<!--/$-->"),eu=V("<template"),tu=V('"'),su=V(' data-dgst="');V(' data-msg="');V(' data-stck="');var ru=V("></template>");function ra(t,s,r){if(W(t,Xd),r===null)throw Error(te(395));return W(t,r),pe(t,Kd)}var nu=V('<div hidden id="'),au=V('">'),iu=V("</div>"),ou=V('<svg aria-hidden="true" style="display:none" id="'),lu=V('">'),cu=V("</svg>"),du=V('<math aria-hidden="true" style="display:none" id="'),uu=V('">'),mu=V("</math>"),hu=V('<table hidden id="'),pu=V('">'),xu=V("</table>"),fu=V('<table hidden><tbody id="'),gu=V('">'),ju=V("</tbody></table>"),vu=V('<table hidden><tr id="'),yu=V('">'),bu=V("</tr></table>"),wu=V('<table hidden><colgroup id="'),Nu=V('">'),Su=V("</colgroup></table>");function Cu(t,s,r,n){switch(r.insertionMode){case 0:case 1:return W(t,nu),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,au);case 2:return W(t,ou),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,lu);case 3:return W(t,du),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,uu);case 4:return W(t,hu),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,pu);case 5:return W(t,fu),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,gu);case 6:return W(t,vu),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,yu);case 7:return W(t,wu),W(t,s.segmentPrefix),W(t,ne(n.toString(16))),pe(t,Nu);default:throw Error(te(397))}}function _u(t,s){switch(s.insertionMode){case 0:case 1:return pe(t,iu);case 2:return pe(t,cu);case 3:return pe(t,mu);case 4:return pe(t,xu);case 5:return pe(t,ju);case 6:return pe(t,bu);case 7:return pe(t,Su);default:throw Error(te(397))}}var ku=V('function $RS(a,b){a=document.getElementById(a);b=document.getElementById(b);for(a.parentNode.removeChild(a);a.firstChild;)b.parentNode.insertBefore(a.firstChild,b);b.parentNode.removeChild(b)};$RS("'),Eu=V('$RS("'),Au=V('","'),Tu=V('")<\/script>'),Du=V('function $RC(a,b){a=document.getElementById(a);b=document.getElementById(b);b.parentNode.removeChild(b);if(a){a=a.previousSibling;var f=a.parentNode,c=a.nextSibling,e=0;do{if(c&&8===c.nodeType){var d=c.data;if("/$"===d)if(0===e)break;else e--;else"$"!==d&&"$?"!==d&&"$!"!==d||e++}d=c.nextSibling;f.removeChild(c);c=d}while(c);for(;b.firstChild;)f.insertBefore(b.firstChild,c);a.data="$";a._reactRetry&&a._reactRetry()}};$RC("'),Mu=V('$RC("'),Fu=V('","'),Iu=V('")<\/script>'),Pu=V('function $RX(b,c,d,e){var a=document.getElementById(b);a&&(b=a.previousSibling,b.data="$!",a=a.dataset,c&&(a.dgst=c),d&&(a.msg=d),e&&(a.stck=e),b._reactRetry&&b._reactRetry())};$RX("'),$u=V('$RX("'),Ru=V('"'),Lu=V(")<\/script>"),br=V(","),zu=/[<\u2028\u2029]/g;function wr(t){return JSON.stringify(t).replace(zu,function(s){switch(s){case"<":return"\\u003c";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:throw Error("escapeJSStringsForInstructionScripts encountered a match it does not know how to replace. this means the match regex and the replacement characters are no longer in sync. This is a bug in React")}})}var is=Object.assign,Vu=Symbol.for("react.element"),fi=Symbol.for("react.portal"),gi=Symbol.for("react.fragment"),ji=Symbol.for("react.strict_mode"),vi=Symbol.for("react.profiler"),yi=Symbol.for("react.provider"),bi=Symbol.for("react.context"),wi=Symbol.for("react.forward_ref"),Ni=Symbol.for("react.suspense"),Si=Symbol.for("react.suspense_list"),Ci=Symbol.for("react.memo"),cn=Symbol.for("react.lazy"),Ou=Symbol.for("react.scope"),Bu=Symbol.for("react.debug_trace_mode"),qu=Symbol.for("react.legacy_hidden"),Uu=Symbol.for("react.default_value"),na=Symbol.iterator;function Pr(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case gi:return"Fragment";case fi:return"Portal";case vi:return"Profiler";case ji:return"StrictMode";case Ni:return"Suspense";case Si:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case bi:return(t.displayName||"Context")+".Consumer";case yi:return(t._context.displayName||"Context")+".Provider";case wi:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Ci:return s=t.displayName||null,s!==null?s:Pr(t.type)||"Memo";case cn:s=t._payload,t=t._init;try{return Pr(t(s))}catch(r){}}return null}var _i={};function aa(t,s){if(t=t.contextTypes,!t)return _i;var r={},n;for(n in t)r[n]=s[n];return r}var Pt=null;function cr(t,s){if(t!==s){t.context._currentValue=t.parentValue,t=t.parent;var r=s.parent;if(t===null){if(r!==null)throw Error(te(401))}else{if(r===null)throw Error(te(401));cr(t,r)}s.context._currentValue=s.value}}function ki(t){t.context._currentValue=t.parentValue,t=t.parent,t!==null&&ki(t)}function Ei(t){var s=t.parent;s!==null&&Ei(s),t.context._currentValue=t.value}function Ai(t,s){if(t.context._currentValue=t.parentValue,t=t.parent,t===null)throw Error(te(402));t.depth===s.depth?cr(t,s):Ai(t,s)}function Ti(t,s){var r=s.parent;if(r===null)throw Error(te(402));t.depth===r.depth?cr(t,r):Ti(t,r),s.context._currentValue=s.value}function Gs(t){var s=Pt;s!==t&&(s===null?Ei(t):t===null?ki(s):s.depth===t.depth?cr(s,t):s.depth>t.depth?Ai(s,t):Ti(s,t),Pt=t)}var ia={isMounted:function(){return!1},enqueueSetState:function(t,s){t=t._reactInternals,t.queue!==null&&t.queue.push(s)},enqueueReplaceState:function(t,s){t=t._reactInternals,t.replace=!0,t.queue=[s]},enqueueForceUpdate:function(){}};function oa(t,s,r,n){var a=t.state!==void 0?t.state:null;t.updater=ia,t.props=r,t.state=a;var i={queue:[],replace:!1};t._reactInternals=i;var o=s.contextType;if(t.context=typeof o=="object"&&o!==null?o._currentValue:n,o=s.getDerivedStateFromProps,typeof o=="function"&&(o=o(r,a),a=o==null?a:is({},a,o),t.state=a),typeof s.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function"&&(typeof t.UNSAFE_componentWillMount=="function"||typeof t.componentWillMount=="function"))if(s=t.state,typeof t.componentWillMount=="function"&&t.componentWillMount(),typeof t.UNSAFE_componentWillMount=="function"&&t.UNSAFE_componentWillMount(),s!==t.state&&ia.enqueueReplaceState(t,t.state,null),i.queue!==null&&0<i.queue.length)if(s=i.queue,o=i.replace,i.queue=null,i.replace=!1,o&&s.length===1)t.state=s[0];else{for(i=o?s[0]:t.state,a=!0,o=o?1:0;o<s.length;o++){var l=s[o];l=typeof l=="function"?l.call(t,i,r,n):l,l!=null&&(a?(a=!1,i=is({},i,l)):is(i,l))}t.state=i}else i.queue=null}var Wu={id:1,overflow:""};function $r(t,s,r){var n=t.id;t=t.overflow;var a=32-$s(n)-1;n&=~(1<<a),r+=1;var i=32-$s(s)+a;if(30<i){var o=a-a%5;return i=(n&(1<<o)-1).toString(32),n>>=o,a-=o,{id:1<<32-$s(s)+a|r<<a|n,overflow:i+t}}return{id:1<<i|r<<a|n,overflow:t}}var $s=Math.clz32?Math.clz32:Gu,Qu=Math.log,Hu=Math.LN2;function Gu(t){return t>>>=0,t===0?32:31-(Qu(t)/Hu|0)|0}function Ju(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var Xu=typeof Object.is=="function"?Object.is:Ju,yt=null,dn=null,Rs=null,ue=null,rs=!1,Js=!1,ms=0,Ct=null,dr=0;function Ft(){if(yt===null)throw Error(te(321));return yt}function la(){if(0<dr)throw Error(te(312));return{memoizedState:null,queue:null,next:null}}function un(){return ue===null?Rs===null?(rs=!1,Rs=ue=la()):(rs=!0,ue=Rs):ue.next===null?(rs=!1,ue=ue.next=la()):(rs=!0,ue=ue.next),ue}function mn(){dn=yt=null,Js=!1,Rs=null,dr=0,ue=Ct=null}function Di(t,s){return typeof s=="function"?s(t):s}function ca(t,s,r){if(yt=Ft(),ue=un(),rs){var n=ue.queue;if(s=n.dispatch,Ct!==null&&(r=Ct.get(n),r!==void 0)){Ct.delete(n),n=ue.memoizedState;do n=t(n,r.action),r=r.next;while(r!==null);return ue.memoizedState=n,[n,s]}return[ue.memoizedState,s]}return t=t===Di?typeof s=="function"?s():s:r!==void 0?r(s):s,ue.memoizedState=t,t=ue.queue={last:null,dispatch:null},t=t.dispatch=Ku.bind(null,yt,t),[ue.memoizedState,t]}function da(t,s){if(yt=Ft(),ue=un(),s=s===void 0?null:s,ue!==null){var r=ue.memoizedState;if(r!==null&&s!==null){var n=r[1];e:if(n===null)n=!1;else{for(var a=0;a<n.length&&a<s.length;a++)if(!Xu(s[a],n[a])){n=!1;break e}n=!0}if(n)return r[0]}}return t=t(),ue.memoizedState=[t,s],t}function Ku(t,s,r){if(25<=dr)throw Error(te(301));if(t===yt)if(Js=!0,t={action:r,next:null},Ct===null&&(Ct=new Map),r=Ct.get(s),r===void 0)Ct.set(s,t);else{for(s=r;s.next!==null;)s=s.next;s.next=t}}function Yu(){throw Error(te(394))}function Ns(){}var ua={readContext:function(t){return t._currentValue},useContext:function(t){return Ft(),t._currentValue},useMemo:da,useReducer:ca,useRef:function(t){yt=Ft(),ue=un();var s=ue.memoizedState;return s===null?(t={current:t},ue.memoizedState=t):s},useState:function(t){return ca(Di,t)},useInsertionEffect:Ns,useLayoutEffect:function(){},useCallback:function(t,s){return da(function(){return t},s)},useImperativeHandle:Ns,useEffect:Ns,useDebugValue:Ns,useDeferredValue:function(t){return Ft(),t},useTransition:function(){return Ft(),[!1,Yu]},useId:function(){var t=dn.treeContext,s=t.overflow;t=t.id,t=(t&~(1<<32-$s(t)-1)).toString(32)+s;var r=Ls;if(r===null)throw Error(te(404));return s=ms++,t=":"+r.idPrefix+"R"+t,0<s&&(t+="H"+s.toString(32)),t+":"},useMutableSource:function(t,s){return Ft(),s(t._source)},useSyncExternalStore:function(t,s,r){if(r===void 0)throw Error(te(407));return r()}},Ls=null,Nr=ui.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentDispatcher;function Zu(t){return console.error(t),null}function ns(){}function em(t,s,r,n,a,i,o,l,c){var d=[],p=new Set;return s={destination:null,responseState:s,progressiveChunkSize:n===void 0?12800:n,status:0,fatalError:null,nextSegmentId:0,allPendingTasks:0,pendingRootTasks:0,completedRootSegment:null,abortableTasks:p,pingedTasks:d,clientRenderedBoundaries:[],completedBoundaries:[],partialBoundaries:[],onError:a===void 0?Zu:a,onAllReady:i===void 0?ns:i,onShellReady:o===void 0?ns:o,onShellError:l===void 0?ns:l,onFatalError:c===void 0?ns:c},r=Xs(s,0,null,r,!1,!1),r.parentFlushed=!0,t=hn(s,t,null,r,p,_i,null,Wu),d.push(t),s}function hn(t,s,r,n,a,i,o,l){t.allPendingTasks++,r===null?t.pendingRootTasks++:r.pendingTasks++;var c={node:s,ping:function(){var d=t.pingedTasks;d.push(c),d.length===1&&Ii(t)},blockedBoundary:r,blockedSegment:n,abortSet:a,legacyContext:i,context:o,treeContext:l};return a.add(c),c}function Xs(t,s,r,n,a,i){return{status:0,id:-1,index:s,parentFlushed:!1,chunks:[],children:[],formatContext:n,boundary:r,lastPushedText:a,textEmbedded:i}}function hs(t,s){if(t=t.onError(s),t!=null&&typeof t!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof t+'" instead');return t}function Ks(t,s){var r=t.onShellError;r(s),r=t.onFatalError,r(s),t.destination!==null?(t.status=2,hi(t.destination,s)):(t.status=1,t.fatalError=s)}function ma(t,s,r,n,a){for(yt={},dn=s,ms=0,t=r(n,a);Js;)Js=!1,ms=0,dr+=1,ue=null,t=r(n,a);return mn(),t}function ha(t,s,r,n){var a=r.render(),i=n.childContextTypes;if(i!=null){var o=s.legacyContext;if(typeof r.getChildContext!="function")n=o;else{r=r.getChildContext();for(var l in r)if(!(l in i))throw Error(te(108,Pr(n)||"Unknown",l));n=is({},o,r)}s.legacyContext=n,Qe(t,s,a),s.legacyContext=o}else Qe(t,s,a)}function pa(t,s){if(t&&t.defaultProps){s=is({},s),t=t.defaultProps;for(var r in t)s[r]===void 0&&(s[r]=t[r]);return s}return s}function Rr(t,s,r,n,a){if(typeof r=="function")if(r.prototype&&r.prototype.isReactComponent){a=aa(r,s.legacyContext);var i=r.contextType;i=new r(n,typeof i=="object"&&i!==null?i._currentValue:a),oa(i,r,n,a),ha(t,s,i,r)}else{i=aa(r,s.legacyContext),a=ma(t,s,r,n,i);var o=ms!==0;if(typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0)oa(a,r,n,i),ha(t,s,a,r);else if(o){n=s.treeContext,s.treeContext=$r(n,1,0);try{Qe(t,s,a)}finally{s.treeContext=n}}else Qe(t,s,a)}else if(typeof r=="string"){switch(a=s.blockedSegment,i=Ud(a.chunks,r,n,t.responseState,a.formatContext),a.lastPushedText=!1,o=a.formatContext,a.formatContext=Ld(o,r,n),Lr(t,s,i),a.formatContext=o,r){case"area":case"base":case"br":case"col":case"embed":case"hr":case"img":case"input":case"keygen":case"link":case"meta":case"param":case"source":case"track":case"wbr":break;default:a.chunks.push(Wd,ne(r),Qd)}a.lastPushedText=!1}else{switch(r){case qu:case Bu:case ji:case vi:case gi:Qe(t,s,n.children);return;case Si:Qe(t,s,n.children);return;case Ou:throw Error(te(343));case Ni:e:{r=s.blockedBoundary,a=s.blockedSegment,i=n.fallback,n=n.children,o=new Set;var l={id:null,rootSegmentID:-1,parentFlushed:!1,pendingTasks:0,forceClientRender:!1,completedSegments:[],byteSize:0,fallbackAbortableTasks:o,errorDigest:null},c=Xs(t,a.chunks.length,l,a.formatContext,!1,!1);a.children.push(c),a.lastPushedText=!1;var d=Xs(t,0,null,a.formatContext,!1,!1);d.parentFlushed=!0,s.blockedBoundary=l,s.blockedSegment=d;try{if(Lr(t,s,n),d.lastPushedText&&d.textEmbedded&&d.chunks.push(ln),d.status=1,Ys(l,d),l.pendingTasks===0)break e}catch(p){d.status=4,l.forceClientRender=!0,l.errorDigest=hs(t,p)}finally{s.blockedBoundary=r,s.blockedSegment=a}s=hn(t,i,r,c,o,s.legacyContext,s.context,s.treeContext),t.pingedTasks.push(s)}return}if(typeof r=="object"&&r!==null)switch(r.$$typeof){case wi:if(n=ma(t,s,r.render,n,a),ms!==0){r=s.treeContext,s.treeContext=$r(r,1,0);try{Qe(t,s,n)}finally{s.treeContext=r}}else Qe(t,s,n);return;case Ci:r=r.type,n=pa(r,n),Rr(t,s,r,n,a);return;case yi:if(a=n.children,r=r._context,n=n.value,i=r._currentValue,r._currentValue=n,o=Pt,Pt=n={parent:o,depth:o===null?0:o.depth+1,context:r,parentValue:i,value:n},s.context=n,Qe(t,s,a),t=Pt,t===null)throw Error(te(403));n=t.parentValue,t.context._currentValue=n===Uu?t.context._defaultValue:n,t=Pt=t.parent,s.context=t;return;case bi:n=n.children,n=n(r._currentValue),Qe(t,s,n);return;case cn:a=r._init,r=a(r._payload),n=pa(r,n),Rr(t,s,r,n,void 0);return}throw Error(te(130,r==null?r:typeof r,""))}}function Qe(t,s,r){if(s.node=r,typeof r=="object"&&r!==null){switch(r.$$typeof){case Vu:Rr(t,s,r.type,r.props,r.ref);return;case fi:throw Error(te(257));case cn:var n=r._init;r=n(r._payload),Qe(t,s,r);return}if(Ir(r)){xa(t,s,r);return}if(r===null||typeof r!="object"?n=null:(n=na&&r[na]||r["@@iterator"],n=typeof n=="function"?n:null),n&&(n=n.call(r))){if(r=n.next(),!r.done){var a=[];do a.push(r.value),r=n.next();while(!r.done);xa(t,s,a)}return}throw t=Object.prototype.toString.call(r),Error(te(31,t==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":t))}typeof r=="string"?(n=s.blockedSegment,n.lastPushedText=Kn(s.blockedSegment.chunks,r,t.responseState,n.lastPushedText)):typeof r=="number"&&(n=s.blockedSegment,n.lastPushedText=Kn(s.blockedSegment.chunks,""+r,t.responseState,n.lastPushedText))}function xa(t,s,r){for(var n=r.length,a=0;a<n;a++){var i=s.treeContext;s.treeContext=$r(i,n,a);try{Lr(t,s,r[a])}finally{s.treeContext=i}}}function Lr(t,s,r){var n=s.blockedSegment.formatContext,a=s.legacyContext,i=s.context;try{return Qe(t,s,r)}catch(c){if(mn(),typeof c=="object"&&c!==null&&typeof c.then=="function"){r=c;var o=s.blockedSegment,l=Xs(t,o.chunks.length,null,o.formatContext,o.lastPushedText,!0);o.children.push(l),o.lastPushedText=!1,t=hn(t,s.node,s.blockedBoundary,l,s.abortSet,s.legacyContext,s.context,s.treeContext).ping,r.then(t,t),s.blockedSegment.formatContext=n,s.legacyContext=a,s.context=i,Gs(i)}else throw s.blockedSegment.formatContext=n,s.legacyContext=a,s.context=i,Gs(i),c}}function tm(t){var s=t.blockedBoundary;t=t.blockedSegment,t.status=3,Fi(this,s,t)}function Mi(t,s,r){var n=t.blockedBoundary;t.blockedSegment.status=3,n===null?(s.allPendingTasks--,s.status!==2&&(s.status=2,s.destination!==null&&s.destination.close())):(n.pendingTasks--,n.forceClientRender||(n.forceClientRender=!0,t=r===void 0?Error(te(432)):r,n.errorDigest=s.onError(t),n.parentFlushed&&s.clientRenderedBoundaries.push(n)),n.fallbackAbortableTasks.forEach(function(a){return Mi(a,s,r)}),n.fallbackAbortableTasks.clear(),s.allPendingTasks--,s.allPendingTasks===0&&(n=s.onAllReady,n()))}function Ys(t,s){if(s.chunks.length===0&&s.children.length===1&&s.children[0].boundary===null){var r=s.children[0];r.id=s.id,r.parentFlushed=!0,r.status===1&&Ys(t,r)}else t.completedSegments.push(s)}function Fi(t,s,r){if(s===null){if(r.parentFlushed){if(t.completedRootSegment!==null)throw Error(te(389));t.completedRootSegment=r}t.pendingRootTasks--,t.pendingRootTasks===0&&(t.onShellError=ns,s=t.onShellReady,s())}else s.pendingTasks--,s.forceClientRender||(s.pendingTasks===0?(r.parentFlushed&&r.status===1&&Ys(s,r),s.parentFlushed&&t.completedBoundaries.push(s),s.fallbackAbortableTasks.forEach(tm,t),s.fallbackAbortableTasks.clear()):r.parentFlushed&&r.status===1&&(Ys(s,r),s.completedSegments.length===1&&s.parentFlushed&&t.partialBoundaries.push(s)));t.allPendingTasks--,t.allPendingTasks===0&&(t=t.onAllReady,t())}function Ii(t){if(t.status!==2){var s=Pt,r=Nr.current;Nr.current=ua;var n=Ls;Ls=t.responseState;try{var a=t.pingedTasks,i;for(i=0;i<a.length;i++){var o=a[i],l=t,c=o.blockedSegment;if(c.status===0){Gs(o.context);try{Qe(l,o,o.node),c.lastPushedText&&c.textEmbedded&&c.chunks.push(ln),o.abortSet.delete(o),c.status=1,Fi(l,o.blockedBoundary,c)}catch(j){if(mn(),typeof j=="object"&&j!==null&&typeof j.then=="function"){var d=o.ping;j.then(d,d)}else{o.abortSet.delete(o),c.status=4;var p=o.blockedBoundary,h=j,f=hs(l,h);if(p===null?Ks(l,h):(p.pendingTasks--,p.forceClientRender||(p.forceClientRender=!0,p.errorDigest=f,p.parentFlushed&&l.clientRenderedBoundaries.push(p))),l.allPendingTasks--,l.allPendingTasks===0){var g=l.onAllReady;g()}}}finally{}}}a.splice(0,i),t.destination!==null&&pn(t,t.destination)}catch(j){hs(t,j),Ks(t,j)}finally{Ls=n,Nr.current=r,r===ua&&Gs(s)}}}function Ss(t,s,r){switch(r.parentFlushed=!0,r.status){case 0:var n=r.id=t.nextSegmentId++;return r.lastPushedText=!1,r.textEmbedded=!1,t=t.responseState,W(s,Hd),W(s,t.placeholderPrefix),t=ne(n.toString(16)),W(s,t),pe(s,Gd);case 1:r.status=2;var a=!0;n=r.chunks;var i=0;r=r.children;for(var o=0;o<r.length;o++){for(a=r[o];i<a.index;i++)W(s,n[i]);a=ur(t,s,a)}for(;i<n.length-1;i++)W(s,n[i]);return i<n.length&&(a=pe(s,n[i])),a;default:throw Error(te(390))}}function ur(t,s,r){var n=r.boundary;if(n===null)return Ss(t,s,r);if(n.parentFlushed=!0,n.forceClientRender)n=n.errorDigest,pe(s,Yd),W(s,eu),n&&(W(s,su),W(s,ne(Se(n))),W(s,tu)),pe(s,ru),Ss(t,s,r);else if(0<n.pendingTasks){n.rootSegmentID=t.nextSegmentId++,0<n.completedSegments.length&&t.partialBoundaries.push(n);var a=t.responseState,i=a.nextSuspenseID++;a=V(a.boundaryPrefix+i.toString(16)),n=n.id=a,ra(s,t.responseState,n),Ss(t,s,r)}else if(n.byteSize>t.progressiveChunkSize)n.rootSegmentID=t.nextSegmentId++,t.completedBoundaries.push(n),ra(s,t.responseState,n.id),Ss(t,s,r);else{if(pe(s,Jd),r=n.completedSegments,r.length!==1)throw Error(te(391));ur(t,s,r[0])}return pe(s,Zd)}function fa(t,s,r){return Cu(s,t.responseState,r.formatContext,r.id),ur(t,s,r),_u(s,r.formatContext)}function ga(t,s,r){for(var n=r.completedSegments,a=0;a<n.length;a++)Pi(t,s,r,n[a]);if(n.length=0,t=t.responseState,n=r.id,r=r.rootSegmentID,W(s,t.startInlineScript),t.sentCompleteBoundaryFunction?W(s,Mu):(t.sentCompleteBoundaryFunction=!0,W(s,Du)),n===null)throw Error(te(395));return r=ne(r.toString(16)),W(s,n),W(s,Fu),W(s,t.segmentPrefix),W(s,r),pe(s,Iu)}function Pi(t,s,r,n){if(n.status===2)return!0;var a=n.id;if(a===-1){if((n.id=r.rootSegmentID)===-1)throw Error(te(392));return fa(t,s,n)}return fa(t,s,n),t=t.responseState,W(s,t.startInlineScript),t.sentCompleteSegmentFunction?W(s,Eu):(t.sentCompleteSegmentFunction=!0,W(s,ku)),W(s,t.segmentPrefix),a=ne(a.toString(16)),W(s,a),W(s,Au),W(s,t.placeholderPrefix),W(s,a),pe(s,Tu)}function pn(t,s){Ue=new Uint8Array(512),We=0;try{var r=t.completedRootSegment;if(r!==null&&t.pendingRootTasks===0){ur(t,s,r),t.completedRootSegment=null;var n=t.responseState.bootstrapChunks;for(r=0;r<n.length-1;r++)W(s,n[r]);r<n.length&&pe(s,n[r])}var a=t.clientRenderedBoundaries,i;for(i=0;i<a.length;i++){var o=a[i];n=s;var l=t.responseState,c=o.id,d=o.errorDigest,p=o.errorMessage,h=o.errorComponentStack;if(W(n,l.startInlineScript),l.sentClientRenderFunction?W(n,$u):(l.sentClientRenderFunction=!0,W(n,Pu)),c===null)throw Error(te(395));W(n,c),W(n,Ru),(d||p||h)&&(W(n,br),W(n,ne(wr(d||"")))),(p||h)&&(W(n,br),W(n,ne(wr(p||"")))),h&&(W(n,br),W(n,ne(wr(h)))),pe(n,Lu)}a.splice(0,i);var f=t.completedBoundaries;for(i=0;i<f.length;i++)ga(t,s,f[i]);f.splice(0,i),Hn(s),Ue=new Uint8Array(512),We=0;var g=t.partialBoundaries;for(i=0;i<g.length;i++){var j=g[i];e:{a=t,o=s;var S=j.completedSegments;for(l=0;l<S.length;l++)if(!Pi(a,o,j,S[l])){l++,S.splice(0,l);var b=!1;break e}S.splice(0,l),b=!0}if(!b){t.destination=null,i++,g.splice(0,i);return}}g.splice(0,i);var y=t.completedBoundaries;for(i=0;i<y.length;i++)ga(t,s,y[i]);y.splice(0,i)}finally{Hn(s),t.allPendingTasks===0&&t.pingedTasks.length===0&&t.clientRenderedBoundaries.length===0&&t.completedBoundaries.length===0&&s.close()}}function ja(t,s){try{var r=t.abortableTasks;r.forEach(function(n){return Mi(n,t,s)}),r.clear(),t.destination!==null&&pn(t,t.destination)}catch(n){hs(t,n),Ks(t,n)}}nn.renderToReadableStream=function(t,s){return new Promise(function(r,n){var a,i,o=new Promise(function(p,h){i=p,a=h}),l=em(t,$d(s?s.identifierPrefix:void 0,s?s.nonce:void 0,s?s.bootstrapScriptContent:void 0,s?s.bootstrapScripts:void 0,s?s.bootstrapModules:void 0),Rd(s?s.namespaceURI:void 0),s?s.progressiveChunkSize:void 0,s?s.onError:void 0,i,function(){var p=new ReadableStream({type:"bytes",pull:function(h){if(l.status===1)l.status=2,hi(h,l.fatalError);else if(l.status!==2&&l.destination===null){l.destination=h;try{pn(l,h)}catch(f){hs(l,f),Ks(l,f)}}},cancel:function(){ja(l)}},{highWaterMark:0});p.allReady=o,r(p)},function(p){o.catch(function(){}),n(p)},a);if(s&&s.signal){var c=s.signal,d=function(){ja(l,c.reason),c.removeEventListener("abort",d)};c.addEventListener("abort",d)}Ii(l)})};nn.version="18.3.1";var Kt,$i;Kt=Xt,$i=nn;Kt.version;Kt.renderToString;var sm=Kt.renderToStaticMarkup;Kt.renderToNodeStream;Kt.renderToStaticNodeStream;$i.renderToReadableStream;const rm=[{id:"fa-FaceSmile",name:"ðŸ˜Š Heureux",component:null,category:"Ã‰motions",library:"fa"},{id:"fa-FaceFrown",name:"ðŸ˜ž Triste",component:null,category:"Ã‰motions",library:"fa"},{id:"fa-FaceAngry",name:"ðŸ˜  FÃ¢chÃ©",component:null,category:"Ã‰motions",library:"fa"},{id:"fa-FaLaugh",name:"ðŸ˜„ Rire",component:null,category:"Ã‰motions",library:"fa"},{id:"fa-Heart",name:"â¤ Amour",component:null,category:"Ã‰motions",library:"fa"}],nm=[{id:"fa-Phone",name:"â˜Ž TÃ©lÃ©phone",component:null,category:"Communication",library:"fa"},{id:"fa-Envelope",name:"âœ‰ Email",component:null,category:"Communication",library:"fa"},{id:"fa-MessageDots",name:"ðŸ’¬ Chat",component:null,category:"Communication",library:"fa"},{id:"fa-Share",name:"â†— Partager",component:null,category:"Communication",library:"fa"},{id:"bi-Telephone",name:"â˜Ž Appel",component:null,category:"Communication",library:"bi"}],am=[{id:"fa-HeartPulse",name:"ðŸ’“ CÅ“ur",component:null,category:"MÃ©dical",library:"fa"},{id:"fa-Hospital",name:"ðŸ¥ HÃ´pital",component:null,category:"MÃ©dical",library:"fa"},{id:"fa-Stethoscope",name:"ðŸ©º StÃ©thoscope",component:null,category:"MÃ©dical",library:"fa"},{id:"fa-Pill",name:"ðŸ’Š MÃ©dicament",component:null,category:"MÃ©dical",library:"fa"},{id:"fa-Syringe",name:"ðŸ’‰ Injection",component:null,category:"MÃ©dical",library:"fa"}],im=[{id:"fa-Car",name:"ðŸš— Voiture",component:null,category:"Transport",library:"fa"},{id:"fa-Bus",name:"ðŸšŒ Bus",component:null,category:"Transport",library:"fa"},{id:"fa-Train",name:"ðŸš‚ Train",component:null,category:"Transport",library:"fa"},{id:"fa-Plane",name:"âœˆ Avion",component:null,category:"Transport",library:"fa"},{id:"fa-MapLocation",name:"ðŸ“ Localisation",component:null,category:"Transport",library:"fa"}],om=[{id:"fa-ShoppingCart",name:"ðŸ›’ Panier",component:null,category:"Commerce",library:"fa"},{id:"fa-CreditCard",name:"ðŸ’³ Carte",component:null,category:"Commerce",library:"fa"},{id:"fa-DollarSign",name:"ðŸ’° Prix",component:null,category:"Commerce",library:"fa"},{id:"fa-Barcode",name:"ðŸ“¦ Code barre",component:null,category:"Commerce",library:"fa"},{id:"fa-Store",name:"ðŸª Magasin",component:null,category:"Commerce",library:"fa"}],lm=[{id:"fa-BookOpen",name:"ðŸ“– Livre",component:null,category:"Ã‰ducation",library:"fa"},{id:"fa-Graduation",name:"ðŸŽ“ DiplÃ´me",component:null,category:"Ã‰ducation",library:"fa"},{id:"fa-Pencil",name:"âœ Crayon",component:null,category:"Ã‰ducation",library:"fa"},{id:"fa-Lightbulb",name:"ðŸ’¡ IdÃ©e",component:null,category:"Ã‰ducation",library:"fa"},{id:"fa-Brain",name:"ðŸ§  Intelligence",component:null,category:"Ã‰ducation",library:"fa"}],cm=[{id:"lucide-check-circle",name:"âœ“ Correct",component:ls,category:"Statut"},{id:"lucide-check",name:"âœ“ Check",component:Vs,category:"Statut"},{id:"lucide-x-circle",name:"âœ— Incorrect",component:kt,category:"Statut"},{id:"lucide-alert-circle",name:"âš  Alerte",component:Os,category:"Statut"},{id:"lucide-alert-triangle",name:"âš  Attention",component:Wr,category:"Statut"},{id:"lucide-info",name:"â“˜ Info",component:Ko,category:"Statut"},{id:"lucide-circle",name:"â— Point",component:Yo,category:"Statut"},{id:"lucide-phone",name:"â˜Ž TÃ©lÃ©phone",component:Zo,category:"Contact"},{id:"lucide-phone-call",name:"ðŸ“ž Appel",component:el,category:"Contact"},{id:"lucide-phone-off",name:"ðŸš« Appel Off",component:tl,category:"Contact"},{id:"lucide-phone-missed",name:"âŒ Appel ManquÃ©",component:sl,category:"Contact"},{id:"lucide-smartphone",name:"ðŸ“± Smartphone",component:Aa,category:"Contact"},{id:"lucide-mail",name:"âœ‰ Email",component:cs,category:"Contact"},{id:"lucide-message",name:"ðŸ’¬ Message",component:rl,category:"Contact"},{id:"lucide-message-circle",name:"ðŸ’­ Chat",component:nl,category:"Contact"},{id:"lucide-send",name:"ðŸ“¤ Envoyer",component:al,category:"Contact"},{id:"lucide-reply",name:"â†© RÃ©pondre",component:kr,category:"Contact"},{id:"lucide-forward",name:"â¤³ TransfÃ©rer",component:il,category:"Contact"},{id:"lucide-plus",name:"âž• Ajouter",component:Rt,category:"Actions"},{id:"lucide-minus",name:"âž– Retirer",component:ol,category:"Actions"},{id:"lucide-edit",name:"âœ Ã‰diter",component:bt,category:"Actions"},{id:"lucide-copy",name:"ðŸ“‹ Copier",component:At,category:"Actions"},{id:"lucide-trash",name:"ðŸ—‘ Supprimer",component:ll,category:"Actions"},{id:"lucide-download",name:"â¬‡ TÃ©lÃ©charger",component:Ta,category:"Actions"},{id:"lucide-upload",name:"â¬† Uploader",component:cl,category:"Actions"},{id:"lucide-search",name:"ðŸ” Chercher",component:Qr,category:"Actions"},{id:"lucide-filter",name:"â§‰ Filtrer",component:dl,category:"Actions"},{id:"lucide-share",name:"â†— Partager",component:ul,category:"Actions"},{id:"lucide-chevron-up",name:"â¬† Haut",component:er,category:"Navigation"},{id:"lucide-chevron-down",name:"â¬‡ Bas",component:tr,category:"Navigation"},{id:"lucide-chevron-left",name:"â—€ Gauche",component:Da,category:"Navigation"},{id:"lucide-chevron-right",name:"â–¶ Droite",component:Ma,category:"Navigation"},{id:"lucide-home",name:"ðŸ  Accueil",component:Fa,category:"Navigation"},{id:"lucide-map",name:"ðŸ—º Carte",component:ml,category:"Navigation"},{id:"lucide-compass",name:"ðŸ§­ Boussole",component:hl,category:"Navigation"},{id:"lucide-navigation",name:"ðŸ§­ Navigation",component:pl,category:"Navigation"},{id:"lucide-user",name:"ðŸ‘¤ Utilisateur",component:xl,category:"Utilisateurs"},{id:"lucide-users",name:"ðŸ‘¥ Groupe",component:Hr,category:"Utilisateurs"},{id:"lucide-lock",name:"ðŸ”’ VerrouillÃ©",component:fl,category:"Utilisateurs"},{id:"lucide-unlock",name:"ðŸ”“ DÃ©verrouillÃ©",component:gl,category:"Utilisateurs"},{id:"lucide-eye",name:"ðŸ‘ Visible",component:Gr,category:"Utilisateurs"},{id:"lucide-eye-off",name:"ðŸ‘â€ðŸ—¨ MasquÃ©",component:jl,category:"Utilisateurs"},{id:"lucide-file",name:"ðŸ“„ Fichier",component:vl,category:"Fichiers"},{id:"lucide-file-text",name:"ðŸ“ƒ Texte",component:Ia,category:"Fichiers"},{id:"lucide-folder",name:"ðŸ“ Dossier",component:yl,category:"Fichiers"},{id:"lucide-folder-open",name:"ðŸ“‚ Ouvert",component:bl,category:"Fichiers"},{id:"lucide-archive",name:"ðŸ“¦ Archive",component:wl,category:"Fichiers"},{id:"lucide-image",name:"ðŸ–¼ Image",component:_r,category:"MÃ©dia"},{id:"lucide-music",name:"ðŸŽµ Musique",component:Nl,category:"MÃ©dia"},{id:"lucide-volume",name:"ðŸ”Š Son",component:Sl,category:"MÃ©dia"},{id:"lucide-mic",name:"ðŸŽ¤ Micro",component:Cl,category:"MÃ©dia"},{id:"lucide-settings",name:"âš™ ParamÃ¨tres",component:_l,category:"Outils"},{id:"lucide-settings2",name:"âš™ RÃ©glages",component:kl,category:"Outils"},{id:"lucide-sliders",name:"â‰¡ Curseurs",component:El,category:"Outils"},{id:"lucide-more-vertical",name:"â‹® Plus (V)",component:Al,category:"Outils"},{id:"lucide-more-horizontal",name:"â‹¯ Plus (H)",component:Tl,category:"Outils"},{id:"lucide-heart",name:"â¤ J'aime",component:Dl,category:"Ã‰valuation"},{id:"lucide-star",name:"â­ Favori",component:Pa,category:"Ã‰valuation"},{id:"lucide-flag",name:"ðŸš© Signaler",component:Ml,category:"Ã‰valuation"},{id:"lucide-trophy",name:"ðŸ† TrophÃ©e",component:Fl,category:"Ã‰valuation"},{id:"lucide-award",name:"ðŸŽ– RÃ©compense",component:Il,category:"Ã‰valuation"},{id:"lucide-zap",name:"âš¡ Ã‰lectrique",component:$a,category:"Divers"},{id:"lucide-lightbulb",name:"ðŸ’¡ IdÃ©e",component:Pl,category:"Divers"},{id:"lucide-target",name:"ðŸŽ¯ Cible",component:$l,category:"Divers"},{id:"lucide-package",name:"ðŸ“¦ Paquet",component:Rl,category:"Divers"},{id:"lucide-gift",name:"ðŸŽ Cadeau",component:Ll,category:"Divers"},{id:"lucide-help-circle",name:"â“ Aide",component:Ge,category:"Divers"}];rm.map(t=>$(M({},t),{component:Fe[t.id.split("-")[1]]})).filter(t=>t.component);nm.map(t=>$(M({},t),{component:Fe[t.id.split("-")[1]]})).filter(t=>t.component);am.map(t=>$(M({},t),{component:Fe[t.id.split("-")[1]]})).filter(t=>t.component);im.map(t=>$(M({},t),{component:Fe[t.id.split("-")[1]]})).filter(t=>t.component);om.map(t=>$(M({},t),{component:Fe[t.id.split("-")[1]]})).filter(t=>t.component);lm.map(t=>$(M({},t),{component:Fe[t.id.split("-")[1]]})).filter(t=>t.component);const dm=(t,s="w-8 h-8",r=null)=>{if(!t)return null;if(r)return console.log("âœ… Using stored SVG for:",t),e.jsx("div",{dangerouslySetInnerHTML:{__html:r},className:s});if(console.log("ðŸŽ¨ AdminQuestionnaireEditor renderIcon:",t),t.startsWith("fa6-")||t.startsWith("fa-")){const n=t.replace("fa6-","").replace("fa-","");console.log("ðŸ” Searching FA icon:",n);const a=Fe[n];return console.log("âœ… FA Icon found:",a?"YES":"NO"),a?e.jsx(a,{className:s}):(console.error("âŒ FA Icon NOT FOUND in FA object. Available keys sample:",Object.keys(Fe).slice(0,10)),e.jsx("span",{className:"text-red-500 text-xs",children:n}))}if(t.startsWith("bs-")){const n=t.replace("bs-","");console.log("ðŸ” Searching BS icon:",n);const a=_t[n];return console.log("âœ… BS Icon found:",a?"YES":"NO"),a?e.jsx(a,{className:s}):(console.error("âŒ BS Icon NOT FOUND. Available keys sample:",Object.keys(_t).slice(0,10)),e.jsx("span",{className:"text-red-500 text-xs",children:n}))}if(t.startsWith("md-")){const n=t.replace("md-",""),a=Lt[n];if(a)return e.jsx(a,{className:s})}if(t.startsWith("fi-")){const n=t.replace("fi-",""),a=zt[n];if(a)return e.jsx(a,{className:s})}if(t.startsWith("hi2-")){const n=t.replace("hi2-",""),a=Vt[n];if(a)return e.jsx(a,{className:s})}if(t.startsWith("ai-")){const n=t.replace("ai-",""),a=Ot[n];if(a)return e.jsx(a,{className:s})}if(t.startsWith("lucide-")){const n=cm.find(a=>a.id===t);if(n!=null&&n.component){const a=n.component;return e.jsx(a,{className:s})}}return t.includes(":")?e.jsx("span",{className:"inline-flex items-center justify-center",style:{fontSize:s.includes("32")?"8rem":"2rem"},children:"ðŸ”·"}):(console.warn("âŒ Icon not found:",t),null)},um=({task:t,onSave:s,onCancel:r,onDelete:n})=>{var X;const[a,i]=m.useState(t);m.useState(null);const[o,l]=m.useState([]),[c,d]=m.useState(!1),[p,h]=m.useState([]);m.useState({}),m.useState(null),m.useState({});const{categories:f,isLoading:g}=Xe(),{toast:j}=ge();m.useEffect(()=>{console.log("=== DEBUG AdminQuestionnaireEditor: initialTask reÃ§u ===",t),i(t),t!=null&&t.id?S(t.id):l([])},[t]);const S=A=>R(void 0,null,function*(){try{console.log("=== DEBUG: Chargement questions depuis la base de donnÃ©es ===");const{data:T,error:I}=yield Y.from("versions").select("id, steps(*)").eq("task_id",A).order("created_at");if(I&&console.error("Erreur chargement versions:",I),console.log("Versions chargÃ©es (systÃ¨me actuel):",T),T&&T.length>0){const G=T[0];if(G.steps&&G.steps.length>0){const z=G.steps.map(k=>{let C=k.expected_input||{};if(typeof C=="string")try{C=JSON.parse(C),console.log("âœ… JSON parsed successfully for step:",k.id)}catch(Q){console.error("âŒ Erreur parsing JSON pour step",k.id,":",Q),C={}}return console.log("ðŸ“¦ Expected input after parsing:",{stepId:k.id,hasChoices:!!C.choices,choiceCount:(C.choices||[]).length}),{id:k.id,order:k.step_order,instruction:k.instruction,questionType:"mixed",imageId:C.imageId,imageName:C.imageName,choices:(C.choices||[]).map(Q=>({id:Q.id,text:Q.text||"",imageId:Q.imageId,imageName:Q.imageName,iconId:Q.iconId,icon:Q.icon,iconSvg:Q.iconSvg,isCorrect:Q.isCorrect||!1})),correctAnswers:C.correctAnswers||[]}});console.log("=== DEBUG: Questions finales chargÃ©es (versions/steps) ===",z),l(z);return}}console.log("Aucune version/step trouvÃ©e, essai de la table questionnaire_questions...");const{data:w,error:P}=yield Y.from("questionnaire_questions").select("*").eq("task_id",A).order("question_order");if(P&&console.error("Erreur chargement questions (questionnaire_questions):",P),console.log("Questions chargÃ©es (questionnaire_questions):",w),w&&w.length>0){const G=w.map(Q=>Q.id),{data:z,error:k}=yield Y.from("questionnaire_choices").select("*").in("question_id",G).order("choice_order");k&&console.error("Erreur chargement rÃ©ponses:",k);const C=w.map(Q=>{const le=(z||[]).filter(oe=>oe.question_id===Q.id);return{id:Q.id,order:Q.question_order,instruction:Q.instruction,questionType:Q.question_type,imageId:Q.image_id,imageName:Q.image_name,choices:le.map(oe=>({id:oe.id,text:oe.text,imageId:oe.image_id,imageName:oe.image_name,isCorrect:oe.is_correct||!1,iconSvg:oe.icon_svg||null})),correctAnswers:le.filter(oe=>oe.is_correct).map(oe=>oe.id)}});console.log("=== DEBUG: Questions finales chargÃ©es (questionnaire_questions) ===",C),l(C);return}console.log("Aucune question trouvÃ©e dans les deux systÃ¨mes"),l([])}catch(T){console.error("Erreur lors du chargement des questions:",T),l([])}});m.useEffect(()=>{b()},[]);const b=()=>R(void 0,null,function*(){try{console.log("=== DEBUG: DÃ©marrage loadQCMImages ===");let{data:A,error:T}=yield Y.from("app_images").select("*").eq("category","QCM").order("name");if(console.log("=== DEBUG: RÃ©ponse Supabase (QCM category) ===",{data:A,error:T}),T)throw T;if(!A||A.length===0){console.warn('âš ï¸ Aucune image avec category="QCM" trouvÃ©e. Chargement de TOUTES les images...');const{data:w,error:P}=yield Y.from("app_images").select("*").order("name");if(P)throw P;A=w,console.log("=== DEBUG: Toutes les images chargÃ©es (fallback) ===",A)}const I=(A||[]).map(w=>{const P=Sr(w.file_path);return console.log(`ðŸ“¸ Image: ${w.name}, file_path: "${w.file_path}", publicUrl: ${P?"âœ… Generated":"âŒ NULL"}`),$(M({},w),{publicUrl:P})});console.log("=== DEBUG: Images QCM chargÃ©es ===",I),console.log(`ðŸ“Š Total images: ${I.length}, avec URL valide: ${I.filter(w=>w.publicUrl).length}`),h(I),(!I||I.length===0)&&console.warn("âš ï¸ ATTENTION: Aucune image trouvÃ©e en BD!")}catch(A){console.error("âŒ Erreur chargement images QCM:",A)}}),y=A=>{const{name:T,value:I}=A.target;i(w=>$(M({},w),{[T]:I}))},N=(A,T)=>{i(I=>$(M({},I),{[A]:T}))},x=A=>{const T=f.find(I=>I.id.toString()===A);i(I=>$(M({},I),{category_id:A,category:T?T.name:null}))},u=()=>{const A={id:`temp-${Date.now()}`,order:o.length+1,instruction:"",questionType:"mixed",imageId:null,imageName:null,choices:[],correctAnswers:[]};l([...o,A])},E=A=>{l(T=>T.filter(I=>I.id!==A))},L=(A,T,I)=>{l(w=>w.map(P=>P.id===A?$(M({},P),{[T]:I}):P))},v=A=>{l(T=>T.map(I=>{if(I.id===A){const w={id:`choice-${Date.now()}`,text:"",imageId:null,imageName:null};return $(M({},I),{choices:[...I.choices,w]})}return I}))},D=(A,T)=>{l(I=>I.map(w=>w.id===A?$(M({},w),{choices:w.choices.filter(P=>P.id!==T),correctAnswers:w.correctAnswers.filter(P=>P!==T)}):w))},F=(A,T,I,w)=>{l(P=>P.map(G=>G.id===A?$(M({},G),{choices:G.choices.map(z=>z.id===T?$(M({},z),{[I]:w}):z)}):G))},O=(A,T)=>{l(I=>I.map(w=>{if(w.id===A){const P=w.correctAnswers.includes(T);return $(M({},w),{correctAnswers:P?w.correctAnswers.filter(G=>G!==T):[...w.correctAnswers,T]})}return w}))},U=()=>R(void 0,null,function*(){var A,T;try{if(!((A=a.title)!=null&&A.trim())){j({title:"Erreur",description:"Le titre est obligatoire",variant:"destructive"});return}if(o.length===0){j({title:"Erreur",description:"Ajoutez au moins une question",variant:"destructive"});return}for(let w=0;w<o.length;w++){const P=o[w];if(!((T=P.instruction)!=null&&T.trim())){j({title:"Erreur",description:`Question ${w+1}: L'Ã©noncÃ© est obligatoire`,variant:"destructive"});return}if(P.choices.length===0){j({title:"Erreur",description:`Question "${P.instruction}": Ajoutez au moins une rÃ©ponse`,variant:"destructive"});return}if(P.choices.filter(z=>z.text&&z.text.trim()||z.icon||z.iconId||z.iconSvg||z.imageUrl||z.imageId).length!==P.choices.length){j({title:"Erreur",description:`Question "${P.instruction}": Toutes les rÃ©ponses doivent avoir un texte, une icÃ´ne ou une image`,variant:"destructive"});return}if(P.correctAnswers.length===0){j({title:"Erreur",description:`La question "${P.instruction}" doit avoir au moins une bonne rÃ©ponse. Cochez au moins une rÃ©ponse.`,variant:"destructive"});return}}console.log("=== DEBUG: Questions avant sauvegarde ==="),o.forEach((w,P)=>{console.log(`Question ${P+1}: "${w.instruction}"`),console.log(`  RÃ©ponses: ${w.choices.length}`,w.choices),console.log(`  Bonnes rÃ©ponses: ${w.correctAnswers.length}`,w.correctAnswers)});const I=$(M({},a),{task_type:"questionnaire",questions:o});console.log("=== DEBUG: TaskData Ã  sauvegarder ===",I),s(I)}catch(I){console.error("Erreur sauvegarde QCM:",I),j({title:"Erreur",description:"Impossible de sauvegarder le QCM",variant:"destructive"})}}),H=()=>{const A=$(M({},a),{id:null,title:`${a.title} (Copie)`,isNew:!0});s(A)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(Ge,{className:"h-6 w-6 text-blue-600"}),"Ã‰diter le Questionnaire (QCM)"]}),e.jsx(me,{children:"Modifiez les informations et questions de ce QCM"})]}),e.jsxs(Z,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"title",children:"Titre du QCM *"}),e.jsx(se,{id:"title",name:"title",value:a.title||"",onChange:y,placeholder:"Ex: Test de connaissances sur..."})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"description",children:"Description"}),e.jsx(mt,{id:"description",name:"description",value:a.description||"",onChange:y,placeholder:"DÃ©crivez briÃ¨vement ce QCM",rows:3})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"category",children:"CatÃ©gorie"}),e.jsxs(ye,{value:((X=a.category_id)==null?void 0:X.toString())||"",onValueChange:x,children:[e.jsx(be,{children:e.jsx(we,{placeholder:"SÃ©lectionner une catÃ©gorie"})}),e.jsx(Ne,{children:f.map(A=>e.jsx(xe,{value:A.id.toString(),children:A.name},A.id))})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"status",children:"Statut"}),e.jsxs(ye,{value:a.creation_status||"draft",onValueChange:A=>N("creation_status",A),children:[e.jsx(be,{children:e.jsx(we,{})}),e.jsx(Ne,{children:xs.map(A=>e.jsx(xe,{value:A.id,children:A.label},A.id))})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(q,{className:"text-lg",children:["Questions (",o.length,")"]}),e.jsxs(_,{onClick:u,variant:"outline",size:"sm",children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"Ajouter une question"]})]}),o.map((A,T)=>{var I;return e.jsxs(J,{className:"border-blue-200",children:[e.jsx(ae,{className:"bg-blue-50 pb-3",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs(ie,{className:"text-base text-blue-900",children:["Question ",T+1]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>E(A.id),className:"text-destructive hover:text-destructive",children:e.jsx(he,{className:"h-4 w-4"})})]})}),e.jsxs(Z,{className:"pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{children:"Ã‰noncÃ© de la question *"}),e.jsx(mt,{value:A.instruction,onChange:w=>L(A.id,"instruction",w.target.value),placeholder:"Posez votre question ici...",rows:2})]}),e.jsxs("div",{children:[e.jsx(q,{children:"Image de la question (optionnelle)"}),e.jsxs(ye,{value:A.imageId||"none",onValueChange:w=>{L(A.id,"imageId",w==="none"?null:w);const P=p.find(G=>G.id===w);L(A.id,"imageName",w==="none"?null:(P==null?void 0:P.name)||null)},children:[e.jsx(be,{children:e.jsx(we,{placeholder:"Aucune image"})}),e.jsxs(Ne,{children:[e.jsx(xe,{value:"none",children:"Aucune image"}),p.map(w=>e.jsx(xe,{value:w.id,children:w.name},w.id))]})]}),A.imageId&&e.jsx("div",{className:"mt-2 p-2 bg-gray-100 rounded",children:e.jsx("img",{src:(I=p.find(w=>w.id===A.imageId))==null?void 0:I.publicUrl,alt:"AperÃ§u",className:"max-h-32 rounded border",onError:w=>{w.target.style.display="none",w.target.parentElement.innerHTML='<p class="text-xs text-gray-500">Image non disponible</p>'}})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(q,{children:"RÃ©ponses possibles *"}),e.jsxs(_,{onClick:()=>v(A.id),variant:"outline",size:"sm",children:[e.jsx(Rt,{className:"h-3 w-3 mr-1"}),"Ajouter une rÃ©ponse"]})]}),A.choices.map((w,P)=>{var G;return e.jsx(J,{className:"border",children:e.jsxs(Z,{className:"pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"checkbox",checked:A.correctAnswers.includes(w.id),onChange:()=>O(A.id,w.id),className:"h-4 w-4 accent-green-600",title:"Cocher si c'est une bonne rÃ©ponse"}),e.jsx("div",{className:"flex-1",children:e.jsx(se,{value:w.text,onChange:z=>F(A.id,w.id,"text",z.target.value),placeholder:`Proposition texte ${P+1} (optionnelle)`,className:"text-sm"})}),e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>D(A.id,w.id),className:"text-destructive hover:text-destructive",children:e.jsx(he,{className:"h-4 w-4"})})]}),(w.imageName||w.icon)&&e.jsxs("div",{className:"p-2 bg-blue-50 rounded border border-blue-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[w.icon?(()=>{const z=(()=>{if(w.icon.library&&w.icon.name){const C={lucide:js,fa6:Fe,fa:Fe,bs:_t,md:Lt,fi:zt,hi2:Vt,ai:Ot}[w.icon.library];return C&&C[w.icon.name]?C[w.icon.name]:null}return null})();return z?e.jsx(z,{className:"w-32 h-32 text-blue-600"}):e.jsx(_r,{className:"w-32 h-32 text-blue-600"})})():w.imageId&&(w.imageId.startsWith("fa6-")||w.imageId.startsWith("fa-")||w.imageId.startsWith("bs-")||w.imageId.startsWith("md-")||w.imageId.startsWith("fi-")||w.imageId.startsWith("hi2-")||w.imageId.startsWith("ai-")||w.imageId.startsWith("lucide-")||w.imageId.includes(":"))?(()=>{const z=dm(w.imageId,"w-32 h-32 text-blue-600",w.iconSvg);return z||e.jsx(_r,{className:"w-32 h-32 text-blue-600"})})():e.jsx("img",{src:(G=p.find(z=>z.id===w.imageId))==null?void 0:G.publicUrl,alt:w.imageName,className:"w-32 h-32 object-contain rounded",onError:z=>{z.target.style.display="none"}}),e.jsx("span",{className:"text-sm text-blue-900",children:w.icon?`IcÃ´ne: ${w.icon.name}`:w.imageName})]}),e.jsx(_,{variant:"ghost",size:"sm",onClick:()=>{F(A.id,w.id,"imageId",null),F(A.id,w.id,"imageName",""),F(A.id,w.id,"icon",null)},className:"text-blue-600 hover:text-blue-700 p-0 h-6",children:e.jsx(Je,{className:"w-3 h-3"})})]}),e.jsxs("div",{className:"p-2 border rounded-lg bg-gray-50 mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"ðŸ“¸ Images systÃ¨me:"}),e.jsx("div",{className:"grid grid-cols-4 gap-2 max-h-32 overflow-y-auto",children:p.map(z=>e.jsxs("button",{onClick:()=>{F(A.id,w.id,"imageId",z.id),F(A.id,w.id,"imageName",z.name)},className:"p-1 rounded border border-gray-300 hover:border-blue-400 hover:bg-blue-100 transition-colors bg-white flex flex-col items-center gap-1",title:z.name,children:[e.jsx("img",{src:z.publicUrl,alt:z.name,className:"w-16 h-16 object-contain rounded",onError:k=>{k.target.style.display="none"}}),e.jsx("p",{className:"text-xs text-gray-600 line-clamp-1",children:z.name})]},z.id))})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-2",children:"â­ IcÃ´nes:"}),e.jsx(sr,{selectedIcon:w.iconSvg?{id:w.imageId||"custom-svg",name:w.imageName||"Icon",displayName:w.imageName||"Icon",svg:w.iconSvg}:null,onSelect:z=>{console.log("ðŸ“Œ Icon selected:",z),console.log("ðŸ“Œ Icon ID:",z.id),console.log("ðŸ“Œ Icon component:",z.component);let k="";try{const C=z.component;k=sm(e.jsx(C,{className:"w-8 h-8"})),console.log("âœ… SVG gÃ©nÃ©rÃ©:",k)}catch(C){console.error("âŒ Erreur gÃ©nÃ©ration SVG:",C)}F(A.id,w.id,"imageId",z.id),F(A.id,w.id,"imageName",z.displayName||z.name),F(A.id,w.id,"iconSvg",k)},onRemove:()=>{F(A.id,w.id,"imageId",null),F(A.id,w.id,"imageName","")},libraries:["lucide","fa6","bs","md","fi","hi2","ai","logos","skill","devicon"],showSearch:!0,showLibraryTabs:!0})]})]})},w.id)}),A.choices.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground italic",children:'Aucune rÃ©ponse ajoutÃ©e. Cliquez sur "Ajouter une rÃ©ponse".'})]})]})]},A.id)}),o.length===0&&e.jsx(J,{className:"border-dashed",children:e.jsx(Z,{className:"py-8 text-center text-muted-foreground",children:'Aucune question ajoutÃ©e. Cliquez sur "Ajouter une question" pour commencer.'})})]})]}),e.jsxs(Bt,{className:"flex justify-between border-t pt-6",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{variant:"outline",onClick:r,children:[e.jsx(kt,{className:"mr-2 h-4 w-4"}),"Annuler"]}),!a.isNew&&e.jsxs(_,{variant:"secondary",onClick:H,children:[e.jsx(At,{className:"mr-2 h-4 w-4"}),"Dupliquer"]}),!a.isNew&&e.jsxs(_,{variant:"destructive",onClick:()=>d(!0),children:[e.jsx(he,{className:"mr-2 h-4 w-4"}),"Supprimer"]})]}),e.jsxs(_,{onClick:U,children:[e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Enregistrer le QCM"]})]})]}),e.jsx(Ke,{open:c,onOpenChange:d,children:e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"Confirmer la suppression"}),e.jsx(tt,{children:"ÃŠtes-vous sÃ»r de vouloir supprimer ce QCM ? Cette action est irrÃ©versible."})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>{d(!1),n(a.id)},className:"bg-destructive hover:bg-destructive/90",children:"Supprimer"})]})]})})]})};function va(t,s){return R(this,null,function*(){console.log("=== Sauvegarde QCM dans versions/steps ==="),console.log("Task ID:",t),console.log("Questions:",s);try{const{data:r}=yield Y.from("versions").select("id").eq("task_id",t).order("created_at",{ascending:!0}).limit(1);let n;if(r&&r.length>0){n=r[0].id,console.log("Version existante trouvÃ©e:",n);const{error:o}=yield Y.from("steps").delete().eq("version_id",n);if(o)throw o;console.log("Anciens steps supprimÃ©s")}else{const{data:o,error:l}=yield Y.from("versions").insert({task_id:t,version_number:"1.0",status:"draft"}).select().single();if(l)throw l;n=o.id,console.log("Nouvelle version crÃ©Ã©e:",n)}const a=s.map((o,l)=>{const c={questionType:"mixed",type:"mixed",imageId:o.imageId,imageName:o.imageName,choices:o.choices.map(d=>({id:d.id,imageId:d.imageId,imageName:d.imageName,iconSvg:d.iconSvg||null,text:d.text,isCorrect:o.correctAnswers.includes(d.id)})),correctAnswers:o.correctAnswers};return{version_id:n,step_order:l+1,instruction:o.instruction,expected_input:c}}),{error:i}=yield Y.from("steps").insert(a);if(i)throw i;return console.log("Steps crÃ©Ã©s avec succÃ¨s:",a.length),{success:!0,versionId:n}}catch(r){throw console.error("Erreur sauvegarde QCM:",r),r}})}const mm=()=>{const{tasks:t,images:s,categories:r,fetchAllData:n,isLoading:a,error:i,deleteTask:o,updateTask:l,createTask:c}=Xe(),[d,p]=m.useState("list"),[h,f]=m.useState(null),{toast:g}=ge(),j=Ca();m.useEffect(()=>{d==="list"&&n()},[d,n]);const S=m.useCallback(D=>{f(D),p("form")},[]),b=()=>{const D={id:Et(),title:"Nouvelle TÃ¢che",description:"",creation_status:"to_create",versions:[],isNew:!0};f(D),p("form")},y=()=>{j("/contributeur/questionnaire")},N=()=>{f(null),p("list")},x=D=>R(void 0,null,function*(){try{const F=D,{isNew:O,questions:U}=F,H=He(F,["isNew","questions"]);let X;O?(X=yield c(H),g({title:"TÃ¢che crÃ©Ã©e",description:"Vous pouvez maintenant ajouter des versions."}),H.task_type==="questionnaire"&&U&&U.length>0&&(yield va(X.id,U))):(X=yield l(D.id,H),D.task_type==="questionnaire"&&U&&U.length>0&&(yield va(D.id,U)),g({title:"TÃ¢che enregistrÃ©e",description:"Les modifications ont Ã©tÃ© sauvegardÃ©es."}));const I=((yield n(!0)).tasksData||[]).find(w=>w.id===X.id);I?f($(M({},I),{isNew:!1})):(f(w=>$(M(M({},w),X),{isNew:!1})),N())}catch(O){console.error("Task saving error:",O),g({title:"Erreur",description:O.message||"Impossible d'enregistrer la tÃ¢che.",variant:"destructive"})}}),u=D=>R(void 0,null,function*(){try{yield o(D),g({title:"TÃ¢che dÃ©placÃ©e dans la corbeille",description:"Vous pouvez la restaurer depuis la corbeille."}),h&&h.id===D?N():n(!0)}catch(F){g({title:"Erreur",description:"Impossible de supprimer la tÃ¢che.",variant:"destructive"})}}),E=D=>{const F=$(M({},D),{id:Et(),title:`${D.title} (Copie)`,isNew:!0});f(F),p("form")},L=m.useMemo(()=>t?[...t].sort((D,F)=>new Date(F.created_at)-new Date(D.created_at)):[],[t]),v=m.useMemo(()=>!s||!(s instanceof Map)?new Map:s,[s]);return a&&!t.length?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Ee,{className:"h-8 w-8 animate-spin text-primary"})}):i?e.jsxs("div",{className:"text-center text-red-500 p-4",children:["Erreur de chargement: ",i]}):e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("div",{children:d==="form"&&e.jsxs(_,{variant:"outline",onClick:N,children:[e.jsx(Da,{className:"mr-2 h-4 w-4"})," Retour Ã  la liste"]})}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>n(!0),disabled:a,children:e.jsx(qt,{className:`h-4 w-4 ${a?"animate-spin":""}`})})})]}),e.jsx(gs,{mode:"wait",children:e.jsx(Gt.div,{initial:{opacity:0,x:d==="form"?300:-300},animate:{opacity:1,x:0},exit:{opacity:0,x:d==="form"?-300:300},transition:{duration:.3},children:d==="list"?e.jsx(Tc,{tasks:L,onSelectTask:S,onAddNewTask:b,onCreateQuestionnaire:y,onDeleteTask:u,onDuplicateTask:E,imagesMap:v,categories:r}):h&&e.jsx("div",{children:h.task_type==="questionnaire"?e.jsx(um,{task:h,onSave:x,onCancel:N,onDelete:u},h.id):e.jsxs(e.Fragment,{children:[e.jsx(Ic,{task:h,onSave:x,onCancel:N,onDelete:u},h.id),!h.isNew&&e.jsx(Hc,{task:h})]})})},d)})]})},hm=(t,s=300)=>{let r;return function(...a){const i=()=>{clearTimeout(r),t(...a)};clearTimeout(r),r=setTimeout(i,s)}};var Ri=["PageUp","PageDown"],Li=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],zi={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Yt="Slider",[zr,pm,xm]=ao(Yt),[Vi,Jp]=io(Yt,[xm]),[fm,mr]=Vi(Yt),Oi=m.forwardRef((t,s)=>{const U=t,{name:r,min:n=0,max:a=100,step:i=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:c=0,defaultValue:d=[n],value:p,onValueChange:h=()=>{},onValueCommit:f=()=>{},inverted:g=!1,form:j}=U,S=He(U,["name","min","max","step","orientation","disabled","minStepsBetweenThumbs","defaultValue","value","onValueChange","onValueCommit","inverted","form"]),b=m.useRef(new Set),y=m.useRef(0),x=o==="horizontal"?gm:jm,[u=[],E]=oo({prop:p,defaultProp:d,onChange:H=>{var A;(A=[...b.current][y.current])==null||A.focus(),h(H)}}),L=m.useRef(u);function v(H){const X=Nm(u,H);O(H,X)}function D(H){O(H,y.current)}function F(){const H=L.current[y.current];u[y.current]!==H&&f(u)}function O(H,X,{commit:A}={commit:!1}){const T=km(i),I=Em(Math.round((H-n)/i)*i+n,T),w=Va(I,[n,a]);E((P=[])=>{const G=bm(P,w,X);if(_m(G,c*i)){y.current=G.indexOf(w);const z=String(G)!==String(P);return z&&A&&f(G),z?G:P}else return P})}return e.jsx(fm,{scope:t.__scopeSlider,name:r,disabled:l,min:n,max:a,valueIndexToChangeRef:y,thumbs:b.current,values:u,orientation:o,form:j,children:e.jsx(zr.Provider,{scope:t.__scopeSlider,children:e.jsx(zr.Slot,{scope:t.__scopeSlider,children:e.jsx(x,$(M({"aria-disabled":l,"data-disabled":l?"":void 0},S),{ref:s,onPointerDown:Wt(S.onPointerDown,()=>{l||(L.current=u)}),min:n,max:a,inverted:g,onSlideStart:l?void 0:v,onSlideMove:l?void 0:D,onSlideEnd:l?void 0:F,onHomeKeyDown:()=>!l&&O(n,0,{commit:!0}),onEndKeyDown:()=>!l&&O(a,u.length-1,{commit:!0}),onStepKeyDown:({event:H,direction:X})=>{if(!l){const I=Ri.includes(H.key)||H.shiftKey&&Li.includes(H.key)?10:1,w=y.current,P=u[w],G=i*I*X;O(P+G,w,{commit:!0})}}}))})})})});Oi.displayName=Yt;var[Bi,qi]=Vi(Yt,{startEdge:"left",endEdge:"right",size:"width",direction:1}),gm=m.forwardRef((t,s)=>{const x=t,{min:r,max:n,dir:a,inverted:i,onSlideStart:o,onSlideMove:l,onSlideEnd:c,onStepKeyDown:d}=x,p=He(x,["min","max","dir","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),[h,f]=m.useState(null),g=Jt(s,u=>f(u)),j=m.useRef(void 0),S=lo(a),b=S==="ltr",y=b&&!i||!b&&i;function N(u){const E=j.current||h.getBoundingClientRect(),L=[0,E.width],D=xn(L,y?[r,n]:[n,r]);return j.current=E,D(u-E.left)}return e.jsx(Bi,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:e.jsx(Ui,$(M({dir:S,"data-orientation":"horizontal"},p),{ref:g,style:$(M({},p.style),{"--radix-slider-thumb-transform":"translateX(-50%)"}),onSlideStart:u=>{const E=N(u.clientX);o==null||o(E)},onSlideMove:u=>{const E=N(u.clientX);l==null||l(E)},onSlideEnd:()=>{j.current=void 0,c==null||c()},onStepKeyDown:u=>{const L=zi[y?"from-left":"from-right"].includes(u.key);d==null||d({event:u,direction:L?-1:1})}}))})}),jm=m.forwardRef((t,s)=>{const S=t,{min:r,max:n,inverted:a,onSlideStart:i,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c}=S,d=He(S,["min","max","inverted","onSlideStart","onSlideMove","onSlideEnd","onStepKeyDown"]),p=m.useRef(null),h=Jt(s,p),f=m.useRef(void 0),g=!a;function j(b){const y=f.current||p.current.getBoundingClientRect(),N=[0,y.height],u=xn(N,g?[n,r]:[r,n]);return f.current=y,u(b-y.top)}return e.jsx(Bi,{scope:t.__scopeSlider,startEdge:g?"bottom":"top",endEdge:g?"top":"bottom",size:"height",direction:g?1:-1,children:e.jsx(Ui,$(M({"data-orientation":"vertical"},d),{ref:h,style:$(M({},d.style),{"--radix-slider-thumb-transform":"translateY(50%)"}),onSlideStart:b=>{const y=j(b.clientY);i==null||i(y)},onSlideMove:b=>{const y=j(b.clientY);o==null||o(y)},onSlideEnd:()=>{f.current=void 0,l==null||l()},onStepKeyDown:b=>{const N=zi[g?"from-bottom":"from-top"].includes(b.key);c==null||c({event:b,direction:N?-1:1})}}))})}),Ui=m.forwardRef((t,s)=>{const h=t,{__scopeSlider:r,onSlideStart:n,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:c}=h,d=He(h,["__scopeSlider","onSlideStart","onSlideMove","onSlideEnd","onHomeKeyDown","onEndKeyDown","onStepKeyDown"]),p=mr(Yt,r);return e.jsx(ps.span,$(M({},d),{ref:s,onKeyDown:Wt(t.onKeyDown,f=>{f.key==="Home"?(o(f),f.preventDefault()):f.key==="End"?(l(f),f.preventDefault()):Ri.concat(Li).includes(f.key)&&(c(f),f.preventDefault())}),onPointerDown:Wt(t.onPointerDown,f=>{const g=f.target;g.setPointerCapture(f.pointerId),f.preventDefault(),p.thumbs.has(g)?g.focus():n(f)}),onPointerMove:Wt(t.onPointerMove,f=>{f.target.hasPointerCapture(f.pointerId)&&a(f)}),onPointerUp:Wt(t.onPointerUp,f=>{const g=f.target;g.hasPointerCapture(f.pointerId)&&(g.releasePointerCapture(f.pointerId),i(f))})}))}),Wi="SliderTrack",Qi=m.forwardRef((t,s)=>{const i=t,{__scopeSlider:r}=i,n=He(i,["__scopeSlider"]),a=mr(Wi,r);return e.jsx(ps.span,$(M({"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation},n),{ref:s}))});Qi.displayName=Wi;var Vr="SliderRange",Hi=m.forwardRef((t,s)=>{const f=t,{__scopeSlider:r}=f,n=He(f,["__scopeSlider"]),a=mr(Vr,r),i=qi(Vr,r),o=m.useRef(null),l=Jt(s,o),c=a.values.length,d=a.values.map(g=>Xi(g,a.min,a.max)),p=c>1?Math.min(...d):0,h=100-Math.max(...d);return e.jsx(ps.span,$(M({"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0},n),{ref:l,style:$(M({},t.style),{[i.startEdge]:p+"%",[i.endEdge]:h+"%"})}))});Hi.displayName=Vr;var Or="SliderThumb",Gi=m.forwardRef((t,s)=>{const r=pm(t.__scopeSlider),[n,a]=m.useState(null),i=Jt(s,l=>a(l)),o=m.useMemo(()=>n?r().findIndex(l=>l.ref.current===n):-1,[r,n]);return e.jsx(vm,$(M({},t),{ref:i,index:o}))}),vm=m.forwardRef((t,s)=>{const N=t,{__scopeSlider:r,index:n,name:a}=N,i=He(N,["__scopeSlider","index","name"]),o=mr(Or,r),l=qi(Or,r),[c,d]=m.useState(null),p=Jt(s,x=>d(x)),h=c?o.form||!!c.closest("form"):!0,f=co(c),g=o.values[n],j=g===void 0?0:Xi(g,o.min,o.max),S=wm(n,o.values.length),b=f==null?void 0:f[l.size],y=b?Sm(b,j,l.direction):0;return m.useEffect(()=>{if(c)return o.thumbs.add(c),()=>{o.thumbs.delete(c)}},[c,o.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${j}% + ${y}px)`},children:[e.jsx(zr.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(ps.span,$(M({role:"slider","aria-label":t["aria-label"]||S,"aria-valuemin":o.min,"aria-valuenow":g,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0},i),{ref:p,style:g===void 0?{display:"none"}:t.style,onFocus:Wt(t.onFocus,()=>{o.valueIndexToChangeRef.current=n})}))}),h&&e.jsx(Ji,{name:a!=null?a:o.name?o.name+(o.values.length>1?"[]":""):void 0,form:o.form,value:g},n)]})});Gi.displayName=Or;var ym="RadioBubbleInput",Ji=m.forwardRef((a,n)=>{var i=a,{__scopeSlider:t,value:s}=i,r=He(i,["__scopeSlider","value"]);const o=m.useRef(null),l=Jt(o,n),c=dc(s);return m.useEffect(()=>{const d=o.current;if(!d)return;const p=window.HTMLInputElement.prototype,f=Object.getOwnPropertyDescriptor(p,"value").set;if(c!==s&&f){const g=new Event("input",{bubbles:!0});f.call(d,s),d.dispatchEvent(g)}},[c,s]),e.jsx(ps.input,$(M({style:{display:"none"}},r),{ref:l,defaultValue:s}))});Ji.displayName=ym;function bm(t=[],s,r){const n=[...t];return n[r]=s,n.sort((a,i)=>a-i)}function Xi(t,s,r){const i=100/(r-s)*(t-s);return Va(i,[0,100])}function wm(t,s){return s>2?`Value ${t+1} of ${s}`:s===2?["Minimum","Maximum"][t]:void 0}function Nm(t,s){if(t.length===1)return 0;const r=t.map(a=>Math.abs(a-s)),n=Math.min(...r);return r.indexOf(n)}function Sm(t,s,r){const n=t/2,i=xn([0,50],[0,n]);return(n-i(s)*r)*r}function Cm(t){return t.slice(0,-1).map((s,r)=>t[r+1]-s)}function _m(t,s){if(s>0){const r=Cm(t);return Math.min(...r)>=s}return!0}function xn(t,s){return r=>{if(t[0]===t[1]||s[0]===s[1])return s[0];const n=(s[1]-s[0])/(t[1]-t[0]);return s[0]+n*(r-t[0])}}function km(t){return(String(t).split(".")[1]||"").length}function Em(t,s){const r=Math.pow(10,s);return Math.round(t*r)/r}var Ki=Oi,Am=Qi,Tm=Hi,Dm=Gi;const Yi=uo.forwardRef((n,r)=>{var a=n,{className:t}=a,s=He(a,["className"]);return e.jsxs(Ki,$(M({ref:r,className:qr("relative flex w-full touch-none select-none items-center",t)},s),{children:[e.jsx(Am,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(Tm,{className:"absolute h-full bg-primary"})}),e.jsx(Dm,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}))});Yi.displayName=Ki.displayName;function Mm(t){if(!t)return"default";try{return t.normalize("NFKD").replace(new RegExp("\\p{Diacritic}","gu"),"").replace(/[^a-zA-Z0-9._-]/g,"-").replace(/-+/g,"-").replace(/(^-|-$)/g,"").toLowerCase()}catch(s){return t.replace(/[^a-zA-Z0-9._-]/g,"-").toLowerCase()}}const Fm=({onImageProcessedAndUploaded:t,categories:s=[]})=>{const{toast:r}=ge(),[n,a]=m.useState(null),[i,o]=m.useState(null),[l,c]=m.useState(800),[d,p]=m.useState(.8),[h,f]=m.useState(!1),[g,j]=m.useState(!1),[S,b]=m.useState(s&&s.length>0?s.includes("default")?"default":s[0]:"default"),[y,N]=m.useState("gÃ©nÃ©ral"),[x,u]=m.useState(Ht),[E,L]=m.useState(""),[v,D]=m.useState(""),[F,O]=m.useState(""),[U,H]=m.useState(!1),X=m.useRef(null);m.useEffect(()=>{(()=>R(void 0,null,function*(){try{const P=yield Zs(S);u(P),P.includes(y)||N(P[0]||"gÃ©nÃ©ral")}catch(P){console.error("Error loading subcategories:",P),u(Ht)}}))()},[S]);const A=w=>{const P=w.target.files[0];if(P){a(P);const G=P.name.split(".").slice(0,-1).join(".");L(G);const z=new FileReader;z.onloadend=()=>{o(z.result)},z.readAsDataURL(P),f(!0)}},T=(w="default")=>R(void 0,null,function*(){if(!n||!i){r({title:"Aucune image",description:"Veuillez sÃ©lectionner une image.",variant:"destructive"});return}j(!0);const P=new Image;P.onload=()=>R(void 0,null,function*(){const G=document.createElement("canvas");let z=P.width,k=P.height;U||z>l&&(k=l/z*k,z=l),G.width=z,G.height=k,G.getContext("2d").drawImage(P,0,0,P.width,P.height,0,0,z,k),G.toBlob(Q=>R(void 0,null,function*(){if(Q){const le="jpg",oe=`${Et()}.${le}`,Te=`${Mm(w||"default")}/${oe}`,Ve=new File([Q],oe,{type:"image/jpeg",lastModified:Date.now()});try{const{data:Tt,error:B}=yield Y.storage.from("images").upload(Te,Ve,{cacheControl:"3600",upsert:!1});if(B)throw B;t(Te,{originalName:n.name,customName:E.trim()||n.name.split(".").slice(0,-1).join("."),customDescription:v.trim()||`TÃ©lÃ©versÃ© le ${new Date().toLocaleDateString()}`,androidVersion:F.trim()||"Non spÃ©cifiÃ©e",newWidth:z,newHeight:k,quality:d,size:Ve.size,mimeType:Ve.type,subcategory:y},w),r({title:"Image traitÃ©e et tÃ©lÃ©versÃ©e",description:"L'image a Ã©tÃ© ajoutÃ©e Ã  la galerie."}),I()}catch(Tt){console.error("Upload error: ",Tt),r({title:"Erreur de tÃ©lÃ©versement",description:Tt.message||"Impossible de tÃ©lÃ©verser l'image.",variant:"destructive"}),j(!1)}}else r({title:"Erreur de traitement",description:"Impossible de convertir l'image (blob).",variant:"destructive"}),j(!1)}),`image/${n.name.split(".").pop()==="png"?"png":"jpeg"}`,d)}),P.onerror=()=>{r({title:"Erreur de chargement",description:"Impossible de charger l'image pour traitement.",variant:"destructive"}),j(!1)},P.src=i}),I=()=>{a(null),o(null),c(800),p(.8),L(""),D(""),O(""),N("gÃ©nÃ©ral"),H(!1),f(!1),j(!1),X.current&&(X.current.value="")};return e.jsxs(e.Fragment,{children:[e.jsxs(_,{variant:"outline",onClick:()=>{var w;return(w=X.current)==null?void 0:w.click()},disabled:g,children:[e.jsx(zl,{className:"mr-2 h-4 w-4"})," ",g?"Traitement...":"TÃ©lÃ©verser Image"]}),e.jsx("input",{type:"file",ref:X,accept:"image/png, image/jpeg, image/webp",onChange:A,className:"hidden",disabled:g}),e.jsx(ht,{open:h,onOpenChange:w=>{w?f(!0):I()},children:e.jsxs(pt,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto flex flex-col",children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"Traiter & TÃ©lÃ©verser"}),e.jsx(gt,{children:"Ajustez les options de traitement de votre image avant de l'ajouter Ã  la galerie."})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[i&&e.jsx("div",{className:"my-4 flex justify-center max-h-[300px] overflow-hidden rounded-md border",children:e.jsx("img",{src:i,alt:"AperÃ§u",className:"max-h-full object-contain"})}),e.jsxs("div",{className:"space-y-4 px-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",id:"uploadOriginalSize",checked:U,onChange:w=>H(w.target.checked),disabled:g,className:"rounded"}),e.jsx(q,{htmlFor:"uploadOriginalSize",className:"text-sm",children:"TÃ©lÃ©verser en taille originale (sans redimensionnement)"})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"targetWidth",className:"flex items-center",children:[e.jsx(Vl,{className:"mr-2 h-4 w-4"})," Largeur maximale (px)"]}),e.jsx(se,{id:"targetWidth",type:"number",value:l,onChange:w=>c(parseInt(w.target.value,10)||300),min:"100",max:"4000",step:"50",disabled:g||U})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"compressionQuality",className:"flex items-center",children:[e.jsx(Ol,{className:"mr-2 h-4 w-4"})," QualitÃ© de compression"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Yi,{id:"compressionQuality",min:.1,max:1,step:.05,value:[d],onValueChange:w=>p(w[0]),disabled:g}),e.jsx("span",{className:"text-sm text-muted-foreground w-12 text-right",children:d.toFixed(2)})]})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"imageName",className:"flex items-center",children:[e.jsx(Bl,{className:"mr-2 h-4 w-4"})," Nom de l'image"]}),e.jsx(se,{id:"imageName",type:"text",value:E,onChange:w=>L(w.target.value),placeholder:"Nom de l'image",disabled:g})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"imageDescription",className:"flex items-center",children:[e.jsx(Ia,{className:"mr-2 h-4 w-4"})," Description"]}),e.jsx(mt,{id:"imageDescription",value:v,onChange:w=>D(w.target.value),placeholder:"Description de l'image...",disabled:g,rows:2})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"androidVersion",className:"flex items-center",children:[e.jsx(Aa,{className:"mr-2 h-4 w-4"})," Version Android"]}),e.jsx(se,{id:"androidVersion",type:"text",value:F,onChange:w=>O(w.target.value),placeholder:"Ex: 14, 13, 12...",disabled:g})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"upload-category",className:"flex items-center",children:"CatÃ©gorie"}),e.jsx("select",{id:"upload-category",name:"category",value:S,onChange:w=>b(w.target.value),className:"block w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:g,children:(s||[]).filter(w=>w!=="all").map(w=>e.jsx("option",{value:w,children:w},w))})]}),e.jsxs("div",{children:[e.jsxs(q,{htmlFor:"upload-subcategory",className:"flex items-center",children:[e.jsx(ql,{className:"mr-2 h-4 w-4"})," Sous-catÃ©gorie"]}),e.jsx("select",{id:"upload-subcategory",name:"subcategory",value:y,onChange:w=>N(w.target.value),className:"block w-full rounded-md border border-input bg-background px-3 py-2 text-sm",disabled:g,children:x.map(w=>e.jsx("option",{value:w,children:w},w))})]})]})]}),e.jsxs(jt,{className:"mt-4 pt-4 border-t flex-shrink-0",children:[e.jsx(_,{type:"button",variant:"outline",onClick:I,disabled:g,children:"Annuler"}),e.jsx(_,{type:"button",onClick:()=>T(S),disabled:g,children:g?"En cours...":"Traiter et TÃ©lÃ©verser"})]})]})})]})};function Im({open:t,onOpenChange:s,editImage:r,onSubmit:n,isEditing:a,adminCategories:i}){const[o,l]=m.useState((r==null?void 0:r.category)||""),[c,d]=m.useState(Ht),p=m.useMemo(()=>Array.from(new Set(i||[])),[i]);return m.useEffect(()=>{(()=>R(this,null,function*(){if(o)try{const f=yield Zs(o);d(f)}catch(f){console.error("Error loading subcategories:",f),d(Ht)}}))()},[o]),m.useEffect(()=>{r!=null&&r.category&&l(r.category)},[r]),e.jsx(ht,{open:t,onOpenChange:s,children:e.jsxs(pt,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"Modifier l'image"}),e.jsx(gt,{children:"Modifiez le nom, la description et les mÃ©tadonnÃ©es de l'image."})]}),r&&e.jsxs("form",{onSubmit:n,className:"space-y-4",children:[e.jsx("div",{className:"aspect-square w-full bg-muted flex items-center justify-center overflow-hidden rounded-md",children:e.jsx("img",{src:r.publicUrl,alt:r.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"edit-name",children:"Nom"}),e.jsx(se,{id:"edit-name",name:"name",defaultValue:r.name,required:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"edit-description",children:"Description"}),e.jsx(mt,{id:"edit-description",name:"description",defaultValue:r.description,required:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"edit-category",children:"CatÃ©gorie"}),e.jsx("select",{id:"edit-category",name:"category",value:o,onChange:h=>l(h.target.value),className:"block w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:(p||[]).filter(h=>h!=="all").map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"edit-subcategory",children:"Sous-catÃ©gorie"}),e.jsx("select",{id:"edit-subcategory",name:"subcategory",defaultValue:r.subcategory||"gÃ©nÃ©ral",className:"block w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:c.map(h=>e.jsx("option",{value:h,children:h},h))})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"edit-android-version",children:"Version Android"}),e.jsx(se,{id:"edit-android-version",name:"android_version",defaultValue:r.android_version||"",placeholder:"Ex: Android 13"})]}),e.jsxs(jt,{children:[e.jsx(_,{type:"button",variant:"secondary",onClick:()=>s(!1),children:"Annuler"}),e.jsxs(_,{type:"submit",disabled:a,children:[a?e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Mettre Ã  jour"]})]})]})]})})}function Pm({open:t,onOpenChange:s,adminCategories:r,refreshImageCategories:n}){const{toast:a}=ge(),[i,o]=m.useState(""),[l,c]=m.useState(!1),d=m.useMemo(()=>Array.from(new Set(r||[])),[r]),p=()=>R(this,null,function*(){if(i.trim()){c(!0);try{yield vo(i.trim()),a({title:"CatÃ©gorie ajoutÃ©e"}),o(""),yield n()}catch(j){a({title:"Erreur",description:j.message,variant:"destructive"})}c(!1)}}),h=j=>{j.preventDefault(),p()},f=j=>{j.key==="Enter"&&(j.preventDefault(),p())},g=j=>R(this,null,function*(){c(!0);try{yield jo(j),a({title:"CatÃ©gorie supprimÃ©e",variant:"destructive"}),yield n()}catch(S){a({title:"Erreur",description:S.message,variant:"destructive"})}c(!1)});return e.jsxs(ht,{open:t,onOpenChange:s,children:[e.jsx(os,{asChild:!0,children:e.jsxs(_,{variant:"outline",children:[e.jsx(Wl,{className:"mr-2 h-4 w-4"}),"GÃ©rer les catÃ©gories"]})}),e.jsxs(pt,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"GÃ©rer les catÃ©gories d'images"}),e.jsx(gt,{children:"Ajoutez, supprimez ou gÃ©rez les catÃ©gories utilisÃ©es pour la galerie d'images."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("form",{onSubmit:h,className:"flex gap-2",children:[e.jsx(se,{value:i,onChange:j=>o(j.target.value),onKeyDown:f,placeholder:"Nouvelle catÃ©gorie..."}),e.jsx(_,{type:"submit",disabled:l||!i.trim(),children:l?e.jsx(Ee,{className:"animate-spin h-4 w-4"}):e.jsx(Ql,{className:"h-4 w-4"})})]}),e.jsx(Jr,{className:"h-48",children:e.jsx("ul",{className:"space-y-2",children:d.filter(j=>j!=="all").map(j=>e.jsxs("li",{className:"flex justify-between items-center p-2 border rounded-md",children:[e.jsx("span",{children:j}),e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>g(j),disabled:l,children:e.jsx(he,{className:"h-4 w-4"})})]},j))})})]}),e.jsx(jt,{children:e.jsx(_,{variant:"secondary",onClick:()=>s(!1),children:"Fermer"})})]})]})}const $m=(t,s=2)=>{if(t===0)return"0 Bytes";const r=1024,n=s<0?0:s,a=["Bytes","Ko","Mo","Go","To"],i=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,i)).toFixed(n))+" "+a[i]},Rm=()=>{const{images:t,fetchAllData:s,imageCategories:r,refreshImageCategories:n,deleteImage:a}=Xe(),i=m.useMemo(()=>Array.from(new Set(r||[])),[r]),{toast:o}=ge(),[l,c]=m.useState(""),[d,p]=m.useState(""),[h,f]=m.useState("all"),[g,j]=m.useState("all");m.useEffect(()=>{hm(()=>{p(l)},300)()},[l]);const[S,b]=m.useState([]),[y,N]=m.useState(!1),[x,u]=m.useState(null),[E,L]=m.useState(!1),[v,D]=m.useState(!1),[F,O]=m.useState(!1),[U,H]=m.useState(null),X=m.useMemo(()=>t instanceof Map?Array.from(t.values()):[],[t]);m.useEffect(()=>{(()=>R(void 0,null,function*(){if(h==="all"){b([]),j("all");return}try{const C=yield Zs(h);b(C),j("all")}catch(C){console.error("Error loading subcategories:",C),b([])}}))()},[h]);const A=m.useMemo(()=>X.filter(k=>{var Ae,Te;const C=d.toLowerCase(),Q=((Ae=k.name)==null?void 0:Ae.toLowerCase().includes(C))||((Te=k.description)==null?void 0:Te.toLowerCase().includes(C)),le=h==="all"||k.category===h,oe=g==="all"||k.subcategory===g;return Q&&le&&oe}).sort((k,C)=>new Date(C.created_at)-new Date(k.created_at)),[X,d,h,g]),T=(k,C,Q="default")=>R(void 0,null,function*(){try{yield go({name:C.customName||C.originalName.split(".").slice(0,-1).join("."),description:C.customDescription||`TÃ©lÃ©versÃ© le ${new Date().toLocaleDateString()}`,category:Q,subcategory:C.subcategory||"gÃ©nÃ©ral",file_path:k,android_version:C.androidVersion||"Non spÃ©cifiÃ©e",metadata:{size:C.size,mimeType:C.mimeType}}),o({title:"SuccÃ¨s",description:"Image ajoutÃ©e Ã  la galerie."}),yield s(!0)}catch(le){console.error("Error adding image to db",le),o({title:"Erreur Base de donnÃ©es",description:"L'image a Ã©tÃ© tÃ©lÃ©versÃ©e mais n'a pas pu Ãªtre ajoutÃ©e Ã  la base de donnÃ©es.",variant:"destructive"})}}),I=k=>{u(k),L(!0)},w=k=>R(void 0,null,function*(){if(k.preventDefault(),!x)return;const C=new FormData(k.target),Q=C.get("name"),le=C.get("description"),oe=C.get("category"),Ae=C.get("subcategory"),Te=C.get("android_version");N(!0);try{yield bn(x.id,{name:Q,description:le,category:oe,subcategory:Ae,android_version:Te}),o({title:"SuccÃ¨s",description:"Image mise Ã  jour."}),yield s(!0),L(!1),u(null)}catch(Ve){console.error("Error updating image:",Ve),o({title:"Erreur de mise Ã  jour",description:Ve.message,variant:"destructive"})}finally{N(!1)}}),P=k=>R(void 0,null,function*(){try{yield a(k.id,k.file_path),o({title:"SuccÃ¨s",description:"Image supprimÃ©e."})}catch(C){console.error("Error deleting image:",C),o({title:"Erreur de suppression",description:C.message,variant:"destructive"})}}),G=k=>{console.log("ðŸŽ¨ Ouverture Ã©diteur pour image:",k),console.log("ðŸ–¼ï¸ URL publique:",k==null?void 0:k.publicUrl),H(k),O(!0)},z=k=>R(void 0,null,function*(){if(!U||!k){console.error("Image ou blob manquant");return}try{o({title:"Traitement...",description:"Sauvegarde de l'image modifiÃ©e en cours"});const C=Date.now(),Q=U.file_path.split(".").pop()||"png",le=`${C}_${Math.random().toString(36).substring(7)}.${Q}`,oe=`public/${le}`,Ae=new File([k],le,{type:"image/png"}),{data:Te,error:Ve}=yield Y.storage.from("images").upload(oe,Ae,{cacheControl:"3600",upsert:!1});if(Ve)throw Ve;yield bn(U.id,{file_path:oe,updated_at:new Date().toISOString()}),U.file_path&&(yield Y.storage.from("images").remove([U.file_path])),o({title:"SuccÃ¨s",description:"Image modifiÃ©e sauvegardÃ©e avec succÃ¨s"}),O(!1),H(null),yield s(!0)}catch(C){console.error("Error saving edited image:",C),o({title:"Erreur",description:"Impossible de sauvegarder l'image modifiÃ©e",variant:"destructive"})}});return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-4 gap-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Galerie d'images"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Qr,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),e.jsx(se,{type:"search",placeholder:"Rechercher...",value:l,onChange:k=>c(k.target.value),className:"pl-8 sm:w-[200px] md:w-[300px]"}),l&&e.jsx(_,{variant:"ghost",size:"icon",className:"absolute right-1 top-1/2 -translate-y-1/2 h-6 w-6",onClick:()=>c(""),children:e.jsx(Je,{className:"h-4 w-4"})})]}),e.jsx(Fm,{onImageProcessedAndUploaded:T,categories:r})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[i.map(k=>e.jsx(_,{variant:h===k?"secondary":"outline",onClick:()=>f(k),className:"capitalize",children:k==="all"?"Toutes":k},k)),e.jsx(Pm,{open:v,onOpenChange:D,adminCategories:r,refreshImageCategories:n})]}),h!=="all"&&S.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4 ml-4",children:[e.jsx("span",{className:"text-sm text-muted-foreground self-center mr-2",children:"Sous-catÃ©gories:"}),e.jsx(_,{size:"sm",variant:g==="all"?"default":"ghost",onClick:()=>j("all"),children:"Toutes"}),S.map(k=>e.jsx(_,{size:"sm",variant:g===k?"default":"ghost",onClick:()=>j(k),className:"capitalize",children:k},k))]}),e.jsx(Jr,{className:"h-[calc(100vh-250px)]",children:A.length>0?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-4",children:A.map(k=>{var C;return e.jsxs(J,{className:"overflow-hidden flex flex-col",children:[e.jsx(ae,{className:"p-0",children:e.jsx("div",{className:"aspect-square w-full bg-muted flex items-center justify-center",children:e.jsx("img",{src:k.publicUrl,alt:k.name,className:"w-full h-full object-cover"})})}),e.jsxs(Z,{className:"p-3 flex-grow",children:[e.jsx(ie,{className:"text-base font-semibold truncate",children:k.name}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:k.category}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:$m(((C=k.metadata)==null?void 0:C.size)||0)})]}),e.jsxs(Bt,{className:"p-2 flex justify-end gap-1",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>G(k),title:"Ã‰diter l'image (flou, masques)",children:e.jsx(Ul,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>I(k),children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsxs(Ke,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",children:e.jsx(he,{className:"h-4 w-4"})})}),e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"ÃŠtes-vous sÃ»r ?"}),e.jsx(tt,{children:"Cette action est irrÃ©versible. L'image sera supprimÃ©e dÃ©finitivement du stockage."})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>P(k),className:"bg-destructive hover:bg-destructive/90",children:"Supprimer"})]})]})]})]})]},k.id)})}):e.jsxs("div",{className:"text-center py-16 text-muted-foreground",children:[e.jsx(Wr,{className:"mx-auto h-12 w-12"}),e.jsx("p",{className:"mt-4",children:"Aucune image trouvÃ©e pour les critÃ¨res sÃ©lectionnÃ©s."})]})}),e.jsx(Im,{open:E,onOpenChange:k=>{k||u(null),L(k)},editImage:x,onSubmit:w,isEditing:y,adminCategories:r}),e.jsx(uc,{open:F,onOpenChange:O,imageUrl:U==null?void 0:U.publicUrl,onSave:z})]})},Lm=({step:t,index:s,onStepChange:r,onRemoveStep:n,images:a})=>{const[i,o]=m.useState(t),[l,c]=m.useState(null),[d,p]=m.useState(null);m.useEffect(()=>{o(t)},[t]),m.useEffect(()=>{(()=>R(void 0,null,function*(){if(i.image_id){const S=yield wn(i.image_id);c(S)}else c(null);if(i.pictogram_id){const S=yield wn(i.pictogram_id);p(S)}else p(null)}))()},[i.image_id,i.pictogram_id]);const h=(j,S)=>{const b=$(M({},i),{[j]:S});o(b),r(s,b)},f=(j,S)=>{h(j,S==="_none_"?null:S)},g=Array.isArray(a)?a:[];return e.jsxs("div",{className:"p-3 border rounded-md space-y-3 bg-muted/50 mb-3",children:[e.jsxs(q,{children:["Ã‰tape ",s+1]}),e.jsx(mt,{placeholder:"Instruction pour cette Ã©tape",value:i.instruction||"",onChange:j=>h("instruction",j.target.value),rows:2}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:`step-image-${s}`,children:"Image (optionnel)"}),e.jsxs(ye,{value:i.image_id||"_none_",onValueChange:j=>f("image_id",j),children:[e.jsx(be,{id:`step-image-${s}`,children:e.jsx(we,{placeholder:"SÃ©lectionner une image"})}),e.jsxs(Ne,{children:[e.jsx(xe,{value:"_none_",children:"Aucune"}),g.map(j=>e.jsx(xe,{value:j.id,children:j.name},j.id))]})]}),l&&e.jsx("img",{src:Sr(l.file_path),alt:l.description,className:"mt-1 h-10 w-10 object-contain rounded border"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:`step-pictogram-${s}`,children:"Pictogramme (optionnel)"}),e.jsxs(ye,{value:i.pictogram_id||"_none_",onValueChange:j=>f("pictogram_id",j),children:[e.jsx(be,{id:`step-pictogram-${s}`,children:e.jsx(we,{placeholder:"SÃ©lectionner un pictogramme"})}),e.jsxs(Ne,{children:[e.jsx(xe,{value:"_none_",children:"Aucun"}),g.filter(j=>j.category==="IcÃ´ne"||j.category==="Pictogramme").map(j=>e.jsx(xe,{value:j.id,children:j.name},j.id))]})]}),d&&e.jsx("img",{src:Sr(d.file_path),alt:d.description,className:"mt-1 h-8 w-8 object-contain rounded border"})]})]}),e.jsxs(_,{type:"button",variant:"outline",size:"xs",onClick:()=>n(s),children:[e.jsx(he,{className:"mr-1 h-3 w-3"})," Supprimer Ã‰tape"]})]})},zm=({faqItem:t,onSave:s,onCancel:r,images:n})=>{var b;const[a,i]=m.useState(t||{question:"",category:"Technique",keywords:[],answer_steps:[{instruction:"",image_id:null,pictogram_id:null}]}),[o,l]=m.useState(((b=t==null?void 0:t.keywords)==null?void 0:b.join(", "))||""),{toast:c}=ge();m.useEffect(()=>{var N;const y=t||{question:"",category:"Technique",keywords:[],answer_steps:[{instruction:"",image_id:null,pictogram_id:null}]};y.answerSteps&&(y.answer_steps=y.answerSteps,delete y.answerSteps),y.answer_steps||(y.answer_steps=[{instruction:"",image_id:null,pictogram_id:null}]),i(y),l(((N=y==null?void 0:y.keywords)==null?void 0:N.join(", "))||"")},[t]);const d=y=>{const{name:N,value:x}=y.target;i(u=>$(M({},u),{[N]:x}))},p=y=>{l(y.target.value),i(N=>$(M({},N),{keywords:y.target.value.split(",").map(x=>x.trim()).filter(Boolean)}))},h=(y,N)=>{const x=[...a.answer_steps];x[y]=N,i(u=>$(M({},u),{answer_steps:x}))},f=()=>{i(y=>$(M({},y),{answer_steps:[...y.answer_steps,{instruction:"",image_id:null,pictogram_id:null}]}))},g=y=>{i(N=>$(M({},N),{answer_steps:N.answer_steps.filter((x,u)=>u!==y)}))},j=y=>{if(y.preventDefault(),!a.question.trim()||a.answer_steps.some(N=>!N.instruction.trim())){c({title:"Champs requis",description:"La question et l'instruction de chaque Ã©tape sont requises.",variant:"destructive"});return}s(a)},S=["Technique","PÃ©dagogie","Compte","Autre"];return e.jsx(J,{children:e.jsxs("form",{onSubmit:j,children:[e.jsx(ae,{children:e.jsxs(ie,{children:[t?"Modifier":"Ajouter"," une Q&R"]})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"faq-question",children:"Question"}),e.jsx(se,{id:"faq-question",name:"question",value:a.question,onChange:d,required:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"faq-category",children:"CatÃ©gorie"}),e.jsxs(ye,{name:"category",value:a.category,onValueChange:y=>i(N=>$(M({},N),{category:y})),children:[e.jsx(be,{id:"faq-category",children:e.jsx(we,{placeholder:"SÃ©lectionner une catÃ©gorie"})}),e.jsx(Ne,{children:S.map(y=>e.jsx(xe,{value:y,children:y},y))})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"faq-keywords",children:"Mots-clÃ©s (sÃ©parÃ©s par des virgules)"}),e.jsx(se,{id:"faq-keywords",value:o,onChange:p})]}),e.jsxs("div",{children:[e.jsx(q,{children:"Ã‰tapes de la RÃ©ponse"}),a.answer_steps.map((y,N)=>e.jsx(Lm,{step:y,index:N,onStepChange:h,onRemoveStep:g,images:n},N)),e.jsxs(_,{type:"button",variant:"outline",size:"sm",onClick:f,className:"mt-2",children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une Ã©tape"]})]})]}),e.jsxs(Bt,{className:"flex justify-end space-x-2",children:[e.jsx(_,{type:"button",variant:"outline",onClick:r,children:"Annuler"}),e.jsxs(_,{type:"submit",children:[e.jsx(Me,{className:"mr-2 h-4 w-4"})," Sauvegarder"]})]})]})})},Vm=({faqData:t,onEdit:s,onDelete:r})=>{const[n,a]=m.useState({}),i=l=>{a(c=>$(M({},c),{[l]:!c[l]}))},o=t.reduce((l,c)=>{const d=c.category||"Autre";return l[d]||(l[d]=[]),l[d].push(c),l},{});return e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Liste des Questions & RÃ©ponses"}),e.jsx(me,{children:"GÃ©rez les Q&R de la FAQ pour les formateurs."})]}),e.jsx(Z,{children:Object.keys(o).length===0?e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"Aucune Q&R pour le moment."}):Object.entries(o).map(([l,c])=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-primary flex justify-between items-center cursor-pointer py-2 px-3 rounded-md hover:bg-muted/30 transition-colors",onClick:()=>i(l),children:[l," (",c.length,")",n[l]?e.jsx(er,{className:"h-5 w-5"}):e.jsx(tr,{className:"h-5 w-5"})]}),e.jsx(gs,{children:n[l]&&e.jsx(Gt.ul,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2 mt-1 pl-3 border-l-2 border-muted",children:c.map(d=>{var p;return e.jsxs(Gt.li,{layout:!0,initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:10},className:"p-3 border rounded-md bg-background hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("p",{className:"font-medium text-foreground flex-grow pr-2",children:d.question}),e.jsxs("div",{className:"flex space-x-1 shrink-0",children:[e.jsx(_,{variant:"ghost",size:"icon_xs",onClick:()=>s(d),title:"Modifier",children:e.jsx(bt,{className:"h-4 w-4 text-blue-600"})}),e.jsxs(ht,{children:[e.jsx(os,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon_xs",title:"Supprimer",children:e.jsx(he,{className:"h-4 w-4 text-red-600"})})}),e.jsxs(pt,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"Confirmer la suppression"}),e.jsxs(gt,{children:['ÃŠtes-vous sÃ»r de vouloir supprimer la Q&R : "',d.question,'" ? Cette action est irrÃ©versible.']})]}),e.jsxs(jt,{children:[e.jsx(Cr,{asChild:!0,children:e.jsx(_,{variant:"outline",children:"Annuler"})}),e.jsx(Cr,{asChild:!0,children:e.jsx(_,{variant:"destructive",onClick:()=>r(d.id),children:"Supprimer"})})]})]})]})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Mots-clÃ©s: ",((p=d.keywords)==null?void 0:p.join(", "))||"N/A"]}),d.isUserSubmitted&&e.jsx(ze,{variant:"outline",className:"mt-1 text-xs bg-yellow-100 text-yellow-700 border-yellow-300",children:"Soumis par utilisateur"})]},d.id)})})})]},l))})]})},Om=()=>{const[t,s]=m.useState([]),[r,n]=m.useState([]),[a,i]=m.useState(null),[o,l]=m.useState(!1),[c,d]=m.useState(!0),{toast:p}=ge(),h=m.useCallback(()=>R(void 0,null,function*(){d(!0);try{const[S,b]=yield Promise.all([mc(),yo()]);s(S||[]),n(Array.isArray(b)?b:[])}catch(S){console.error("Error loading FAQ data:",S),n([]),p({title:"Erreur de chargement",description:"Impossible de charger les donnÃ©es pour la FAQ.",variant:"destructive"})}finally{d(!1)}}),[p]);m.useEffect(()=>{h()},[h]);const f=S=>R(void 0,null,function*(){try{S.id?yield hc(S.id,S):yield pc($(M({},S),{id:Et()})),yield h(),l(!1),i(null),p({title:"Q&R sauvegardÃ©e avec succÃ¨s !"})}catch(b){p({title:"Erreur de sauvegarde",description:b.message,variant:"destructive"})}}),g=S=>{i(S),l(!0)},j=S=>R(void 0,null,function*(){try{yield xc(S),yield h(),p({title:"Q&R supprimÃ©e.",variant:"destructive"})}catch(b){p({title:"Erreur de suppression",description:b.message,variant:"destructive"})}});return c?e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Gestionnaire FAQ"}),e.jsx(me,{children:"Chargement en cours..."})]}),e.jsx(Z,{children:e.jsx("div",{className:"flex justify-center items-center h-32",children:e.jsx(qt,{className:"h-8 w-8 animate-spin text-primary"})})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(gs,{children:o&&e.jsx(Gt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},children:e.jsx(zm,{faqItem:a,onSave:f,onCancel:()=>{l(!1),i(null)},images:r})})}),!o&&e.jsxs(_,{onClick:()=>{i(null),l(!0)},className:"w-full",children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une Q&R"]}),e.jsx(Vm,{faqData:t,onEdit:g,onDelete:j})]})},Bm=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0),[a,i]=m.useState(!1),[o,l]=m.useState(""),[c,d]=m.useState(null),[p,h]=m.useState({}),{toast:f}=ge(),g=()=>R(void 0,null,function*(){n(!0);try{const x=yield Ur("apprenant");s(x)}catch(x){f({title:"Erreur de chargement",description:"Impossible de rÃ©cupÃ©rer la liste des apprenants.",variant:"destructive"})}finally{n(!1)}});m.useEffect(()=>{g()},[]);const j=x=>R(void 0,null,function*(){if(x.preventDefault(),!o.trim()){f({title:"PrÃ©nom requis",description:"Veuillez entrer un prÃ©nom.",variant:"destructive"});return}i(!0);try{const u=yield bo(o);f({title:"Apprenant crÃ©Ã© !",description:`${u.first_name} a Ã©tÃ© ajoutÃ© avec le code : ${u.learner_code}`}),l(""),g()}catch(u){f({title:"Erreur de crÃ©ation",description:u.message||"Une erreur est survenue.",variant:"destructive"})}finally{i(!1)}}),S=x=>{d(x.id),h({first_name:x.first_name||"",last_name:x.last_name||"",pseudo:x.pseudo||""})},b=x=>R(void 0,null,function*(){try{yield _a(x,p),f({title:"Profil mis Ã  jour !",description:"Les informations ont Ã©tÃ© sauvegardÃ©es."}),d(null),g()}catch(u){f({title:"Erreur",description:`La mise Ã  jour a Ã©chouÃ©: ${u.message}`,variant:"destructive"})}}),y=x=>R(void 0,null,function*(){try{yield ka(x),f({title:"Apprenant supprimÃ©",description:"L'utilisateur et son profil ont Ã©tÃ© supprimÃ©s.",variant:"destructive"}),g()}catch(u){f({title:"Erreur de suppression",description:`La suppression a Ã©chouÃ©: ${u.message}`,variant:"destructive"})}}),N=x=>{navigator.clipboard.writeText(x).then(()=>{f({title:"CopiÃ© !",description:`Le code ${x} a Ã©tÃ© copiÃ©.`})})};return e.jsxs("div",{className:"grid gap-6",children:[e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center",children:[e.jsx(Ra,{className:"mr-2 h-5 w-5"}),"CrÃ©er un apprenant (sans email)"]}),e.jsx(me,{children:"CrÃ©ez un compte pour un apprenant qui n'a pas d'adresse email. Un code unique sera gÃ©nÃ©rÃ©."})]}),e.jsxs("form",{onSubmit:j,children:[e.jsx(Z,{children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"firstName",children:"PrÃ©nom de l'apprenant"}),e.jsx(se,{id:"firstName",value:o,onChange:x=>l(x.target.value),placeholder:"Ex: Jean",required:!0,disabled:a})]})}),e.jsx(Bt,{children:e.jsx(_,{type:"submit",disabled:a,children:a?"CrÃ©ation en cours...":"CrÃ©er le compte"})})]})]}),e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Hr,{className:"mr-2 h-5 w-5"})," Liste des Apprenants"]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:g,disabled:r,children:e.jsx(qt,{className:`h-4 w-4 ${r?"animate-spin":""}`})})]}),e.jsx(me,{children:"Voici la liste de tous les comptes apprenants."})]}),e.jsx(Z,{children:e.jsx("div",{className:"border rounded-lg max-h-[600px] overflow-auto",children:e.jsxs(rr,{children:[e.jsx(nr,{className:"sticky top-0 bg-muted/50 backdrop-blur-sm",children:e.jsxs(Le,{children:[e.jsx(je,{children:"PrÃ©nom"}),e.jsx(je,{children:"Nom"}),e.jsx(je,{children:"Pseudo"}),e.jsx(je,{children:"Code Apprenant"}),e.jsx(je,{children:"Email"}),e.jsx(je,{className:"text-right",children:"Actions"})]})}),e.jsx(ar,{children:e.jsx(gs,{children:r?e.jsx(Le,{children:e.jsx(re,{colSpan:6,className:"text-center",children:"Chargement..."})}):t.length>0?t.map(x=>{var u;return e.jsx(Gt.tr,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hover:bg-muted/50",children:c===x.id?e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(se,{value:p.first_name,onChange:E=>h($(M({},p),{first_name:E.target.value}))})}),e.jsx(re,{children:e.jsx(se,{value:p.last_name,onChange:E=>h($(M({},p),{last_name:E.target.value}))})}),e.jsx(re,{children:e.jsx(se,{value:p.pseudo,onChange:E=>h($(M({},p),{pseudo:E.target.value}))})}),e.jsx(re,{colSpan:2}),e.jsxs(re,{className:"text-right",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>b(x.id),children:e.jsx(Me,{className:"h-4 w-4 text-green-600"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>d(null),children:e.jsx(Je,{className:"h-4 w-4 text-red-600"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"font-medium",children:x.first_name||"N/A"}),e.jsx(re,{children:x.last_name||"N/A"}),e.jsx(re,{children:x.pseudo||"N/A"}),e.jsx(re,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono tracking-wider",children:x.learner_code||"N/A"}),x.learner_code&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>N(x.learner_code),children:e.jsx(At,{className:"h-4 w-4"})})]})}),e.jsx(re,{className:"text-muted-foreground",children:(u=x.email)!=null&&u.includes("@example.com")?"Aucun":x.email}),e.jsxs(re,{className:"text-right space-x-1",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>S(x),children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsxs(Ke,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",children:e.jsx(he,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsxs(et,{children:["Supprimer ",x.first_name,"?"]}),e.jsx(tt,{children:"Cette action est irrÃ©versible et supprimera dÃ©finitivement le compte et le profil de l'apprenant."})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>y(x.id),className:"bg-destructive hover:bg-destructive/80",children:"Supprimer"})]})]})]})]})]})},x.id)}):e.jsx(Le,{children:e.jsx(re,{colSpan:6,className:"text-center",children:"Aucun apprenant trouvÃ©."})})})})]})})})]})]})},qm=({onTrainerCreated:t})=>{const[s,r]=m.useState([]),[n,a]=m.useState(!0),[i,o]=m.useState(null),[l,c]=m.useState({}),[d,p]=m.useState(!1),[h,f]=m.useState({firstName:"",pseudo:""}),[g,j]=m.useState(!1),{toast:S}=ge(),b=()=>R(void 0,null,function*(){a(!0);try{const v=yield Ur("formateur");r(v)}catch(v){S({title:"Erreur de chargement",description:"Impossible de rÃ©cupÃ©rer la liste des formateurs.",variant:"destructive"})}finally{a(!1)}});m.useEffect(()=>{b()},[]);const y=(v,D)=>{v&&navigator.clipboard.writeText(v).then(()=>{S({title:"CopiÃ© !",description:`Le ${D} ${v} a Ã©tÃ© copiÃ©.`})})},N=v=>{o(v.id),c({first_name:v.first_name||"",last_name:v.last_name||"",pseudo:v.pseudo||""})},x=v=>R(void 0,null,function*(){try{yield _a(v,l),S({title:"Profil mis Ã  jour !",description:"Les informations ont Ã©tÃ© sauvegardÃ©es."}),o(null),b()}catch(D){S({title:"Erreur",description:`La mise Ã  jour a Ã©chouÃ©: ${D.message}`,variant:"destructive"})}}),u=v=>R(void 0,null,function*(){try{yield ka(v),S({title:"Formateur supprimÃ©",description:"L'utilisateur et son profil ont Ã©tÃ© supprimÃ©s.",variant:"destructive"}),b()}catch(D){S({title:"Erreur de suppression",description:`La suppression a Ã©chouÃ©: ${D.message}`,variant:"destructive"})}}),E=()=>R(void 0,null,function*(){if(!h.firstName||!h.pseudo){S({title:"Champs requis",description:"Veuillez remplir tous les champs",variant:"destructive"});return}p(!0);try{const v=yield wo(h.firstName,h.pseudo);S({title:"Formateur crÃ©Ã© !",description:`Code: ${v.trainer_code} - Pseudo: ${v.pseudo}`,duration:1e4}),f({firstName:"",pseudo:""}),j(!1),b(),t&&t()}catch(v){S({title:"Erreur",description:`La crÃ©ation a Ã©chouÃ©: ${v.message}`,variant:"destructive"})}finally{p(!1)}}),L=(v,D)=>R(void 0,null,function*(){try{const{error:F}=yield Y.functions.invoke("update-user-password",{body:{userId:v,password:D}});if(F)throw F;S({title:"Mot de passe rÃ©initialisÃ©",description:`Le mot de passe est maintenant: ${D}`,duration:1e4})}catch(F){S({title:"Erreur",description:`La rÃ©initialisation a Ã©chouÃ©: ${F.message}`,variant:"destructive"})}});return e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Hr,{className:"mr-2 h-5 w-5"})," Liste des Formateurs"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ht,{open:g,onOpenChange:j,children:[e.jsx(os,{asChild:!0,children:e.jsxs(_,{variant:"default",size:"sm",children:[e.jsx(Rt,{className:"mr-2 h-4 w-4"})," CrÃ©er un formateur"]})}),e.jsxs(pt,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"CrÃ©er un nouveau formateur"}),e.jsx(gt,{children:"Le code formateur sera gÃ©nÃ©rÃ© automatiquement"})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"firstName",children:"PrÃ©nom"}),e.jsx(se,{id:"firstName",value:h.firstName,onChange:v=>f($(M({},h),{firstName:v.target.value})),placeholder:"Jean"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"pseudo",children:"Pseudo (identifiant de connexion)"}),e.jsx(se,{id:"pseudo",value:h.pseudo,onChange:v=>f($(M({},h),{pseudo:v.target.value})),placeholder:"jean.formateur"})]})]}),e.jsxs(jt,{children:[e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:"Annuler"}),e.jsx(_,{onClick:E,disabled:d,children:d?"CrÃ©ation...":"CrÃ©er"})]})]})]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:b,disabled:n,children:e.jsx(qt,{className:`h-4 w-4 ${n?"animate-spin":""}`})})]})]}),e.jsx(me,{children:"Voici la liste de tous les comptes formateurs et leurs codes uniques."})]}),e.jsx(Z,{children:e.jsx("div",{className:"border rounded-lg max-h-[600px] overflow-auto",children:e.jsxs(rr,{children:[e.jsx(nr,{className:"sticky top-0 bg-muted/50 backdrop-blur-sm",children:e.jsxs(Le,{children:[e.jsx(je,{children:"PrÃ©nom"}),e.jsx(je,{children:"Nom"}),e.jsx(je,{children:"Email"}),e.jsx(je,{children:"Pseudo"}),e.jsx(je,{children:"Code Formateur"}),e.jsx(je,{className:"text-right",children:"Actions"})]})}),e.jsx(ar,{children:e.jsx(gs,{children:n?e.jsx(Le,{children:e.jsx(re,{colSpan:6,className:"text-center",children:"Chargement..."})}):s.length>0?s.map(v=>e.jsx(Gt.tr,{layout:!0,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"hover:bg-muted/50",children:i===v.id?e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(se,{value:l.first_name,onChange:D=>c($(M({},l),{first_name:D.target.value}))})}),e.jsx(re,{children:e.jsx(se,{value:l.last_name,onChange:D=>c($(M({},l),{last_name:D.target.value}))})}),e.jsx(re,{className:"text-muted-foreground",children:v.email||"Aucun"}),e.jsx(re,{children:e.jsx(se,{value:l.pseudo,onChange:D=>c($(M({},l),{pseudo:D.target.value}))})}),e.jsx(re,{}),e.jsxs(re,{className:"text-right",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>x(v.id),children:e.jsx(Me,{className:"h-4 w-4 text-green-600"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>o(null),children:e.jsx(Je,{className:"h-4 w-4 text-red-600"})})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"font-medium",children:v.first_name||"N/A"}),e.jsx(re,{children:v.last_name||"N/A"}),e.jsx(re,{className:"text-muted-foreground",children:v.email||"Aucun"}),e.jsx(re,{children:v.pseudo||"N/A"}),e.jsx(re,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-mono tracking-wider",children:v.trainer_code||"N/A"}),v.trainer_code&&e.jsx(_,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>y(v.trainer_code,"code"),children:e.jsx(At,{className:"h-4 w-4"})})]})}),e.jsxs(re,{className:"text-right space-x-1",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>N(v),title:"Modifier",children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>L(v.id,v.trainer_code),title:"RÃ©initialiser le mot de passe",children:e.jsx(Hl,{className:"h-4 w-4 text-amber-600"})}),e.jsxs(Ke,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",title:"Supprimer",children:e.jsx(he,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsxs(et,{children:["Supprimer ",v.first_name,"?"]}),e.jsx(tt,{children:"Cette action est irrÃ©versible et supprimera dÃ©finitivement le compte et le profil du formateur."})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>u(v.id),className:"bg-destructive hover:bg-destructive/80",children:"Supprimer"})]})]})]})]})]})},v.id)):e.jsx(Le,{children:e.jsx(re,{colSpan:6,className:"text-center",children:"Aucun formateur trouvÃ©."})})})})]})})})]})},Um=()=>{var x;const[t,s]=m.useState([]),[r,n]=m.useState([]),[a,i]=m.useState(null),[o,l]=m.useState([]),[c,d]=m.useState(null),[p,h]=m.useState(!0),[f,g]=m.useState(!1),{toast:j}=ge(),S=m.useCallback(()=>R(void 0,null,function*(){h(!0);try{const[u,E]=yield Promise.all([Ur("formateur"),hr()]);if(s(u),n(E),u.length>0){const L=u[0].id;i(L)}}catch(u){j({title:"Erreur de chargement",description:"Impossible de charger les donnÃ©es.",variant:"destructive"})}finally{h(!1)}}),[j]),b=m.useCallback(u=>R(void 0,null,function*(){if(u){h(!0);try{const E=yield No(u);l(E)}catch(E){j({title:"Erreur",description:"Impossible de charger les apprenants pour ce formateur.",variant:"destructive"})}finally{h(!1)}}}),[j]);m.useEffect(()=>{S()},[S]),m.useEffect(()=>{a?b(a):l([])},[a,b]);const y=()=>R(void 0,null,function*(){if(!a||!c){j({title:"SÃ©lection requise",description:"Veuillez sÃ©lectionner un formateur et un apprenant.",variant:"destructive"});return}g(!0);try{yield So(c,a),j({title:"Association rÃ©ussie !",description:"L'apprenant a Ã©tÃ© assignÃ© au formateur."}),d(null);const u=yield hr();n(u),yield b(a)}catch(u){j({title:"Erreur d'assignation",description:u.message,variant:"destructive"})}finally{g(!1)}}),N=u=>R(void 0,null,function*(){try{yield Co(u),j({title:"Dissociation rÃ©ussie !",description:"L'apprenant n'est plus assignÃ© Ã  ce formateur."});const E=yield hr();n(E),yield b(a)}catch(E){j({title:"Erreur de dissociation",description:E.message,variant:"destructive"})}});return e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center",children:[e.jsx(Gl,{className:"mr-2 h-5 w-5"}),"Associer un Apprenant"]}),e.jsx(me,{children:"SÃ©lectionnez un formateur, puis un apprenant Ã  lui assigner."})]}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Formateur"}),e.jsxs(ye,{onValueChange:i,value:a||"",children:[e.jsx(be,{children:e.jsx(we,{placeholder:"SÃ©lectionnez un formateur"})}),e.jsx(Ne,{children:t.map(u=>e.jsxs(xe,{value:u.id,children:[u.first_name," (",u.pseudo,")"]},u.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Apprenant non assignÃ©"}),e.jsxs(ye,{onValueChange:d,value:c||"",children:[e.jsx(be,{children:e.jsx(we,{placeholder:"SÃ©lectionnez un apprenant"})}),e.jsx(Ne,{children:r.length>0?r.map(u=>e.jsxs(xe,{value:u.id,children:[u.first_name," (",u.learner_code,")"]},u.id)):e.jsx(xe,{value:"none",disabled:!0,children:"Aucun apprenant disponible"})})]})]}),e.jsxs(_,{onClick:y,disabled:!a||!c||f,children:[f?e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Jl,{className:"mr-2 h-4 w-4"}),"Assigner l'apprenant"]})]})]}),e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Xl,{className:"mr-2 h-5 w-5"}),"Apprenants AssignÃ©s"]}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>{a&&b(a)},disabled:!a||p,children:e.jsx(qt,{className:`h-4 w-4 ${p?"animate-spin":""}`})})]}),e.jsx(me,{children:a?`Liste des apprenants assignÃ©s Ã  ${((x=t.find(u=>u.id===a))==null?void 0:x.first_name)||""}`:"SÃ©lectionnez un formateur pour voir ses apprenants."})]}),e.jsx(Z,{children:e.jsx("div",{className:"border rounded-lg h-[300px] overflow-auto",children:e.jsxs(rr,{children:[e.jsx(nr,{children:e.jsxs(Le,{children:[e.jsx(je,{children:"Nom de l'apprenant"}),e.jsx(je,{className:"text-right",children:"Actions"})]})}),e.jsx(ar,{children:p?e.jsx(Le,{children:e.jsx(re,{colSpan:2,className:"text-center",children:"Chargement..."})}):a&&o.length>0?o.map(u=>e.jsxs(Le,{children:[e.jsx(re,{className:"font-medium",children:u.first_name}),e.jsx(re,{className:"text-right",children:e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>N(u.id),children:[e.jsx(Kl,{className:"mr-2 h-4 w-4"})," Dissocier"]})})]},u.id)):e.jsx(Le,{children:e.jsx(re,{colSpan:2,className:"text-center text-muted-foreground",children:a?"Aucun apprenant assignÃ©.":"Veuillez sÃ©lectionner un formateur."})})})]})})})]})]})};function Wm({trainers:t}){const[s,r]=m.useState(""),[n,a]=m.useState([]),[i,o]=m.useState(!1),{toast:l}=ge();m.useEffect(()=>{s&&c()},[s]);const c=()=>R(this,null,function*(){try{o(!0);const h=yield gc(s);a(h),h.length===0&&l({title:"Attention",description:"Aucune catÃ©gorie trouvÃ©e. VÃ©rifier que la migration SQL a Ã©tÃ© exÃ©cutÃ©e et les catÃ©gories ajoutÃ©es en base.",variant:"destructive"})}catch(h){console.error("Erreur dÃ©taillÃ©e:",h),l({title:"Erreur",description:h.message||"Impossible de charger les catÃ©gories. VÃ©rifier la base de donnÃ©es.",variant:"destructive"})}finally{o(!1)}}),d=(h,f)=>R(this,null,function*(){try{f?(yield jc(s,h),l({title:"Licence dÃ©sactivÃ©e",description:"La licence a Ã©tÃ© retirÃ©e avec succÃ¨s"})):(yield vc(s,h,null),l({title:"Licence activÃ©e",description:"La licence a Ã©tÃ© accordÃ©e avec succÃ¨s"})),yield c()}catch(g){l({title:"Erreur",description:"Impossible de modifier la licence",variant:"destructive"})}}),p=t.find(h=>h.id===s);return e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"w-5 h-5"}),"Gestion des Licences par CatÃ©gorie"]}),e.jsx(me,{children:'GÃ©rez les licences des formateurs. La catÃ©gorie "Tactile" reste gratuite pour tous.'})]}),e.jsxs(Z,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"SÃ©lectionner un formateur"}),e.jsxs(ye,{value:s,onValueChange:r,children:[e.jsx(be,{children:e.jsx(we,{placeholder:"Choisir un formateur..."})}),e.jsx(Ne,{children:t.map(h=>e.jsxs(xe,{value:h.id,children:[h.first_name," (",h.pseudo,") - Code: ",h.trainer_code]},h.id))})]})]}),s&&e.jsx("div",{className:"space-y-3",children:i?e.jsx("p",{className:"text-sm text-muted-foreground",children:"Chargement..."}):e.jsxs(e.Fragment,{children:[p&&e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg",children:[e.jsxs("p",{className:"text-sm font-medium",children:["Formateur: ",p.first_name," (",p.pseudo,")"]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Code: ",p.trainer_code]})]}),e.jsx("div",{className:"space-y-2",children:n.map(h=>{var g;const f=((g=h.name)==null?void 0:g.toLowerCase())==="tactile";return e.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/30 transition-colors",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h4",{className:"font-medium",children:h.name}),f&&e.jsx(ze,{variant:"secondary",className:"text-xs",children:"Gratuit"}),h.hasLicense&&e.jsxs(ze,{className:"text-xs bg-green-600",children:[e.jsx(Bs,{className:"w-3 h-3 mr-1"}),"Actif"]})]}),h.description&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:h.description}),h.expiresAt?e.jsxs("p",{className:"text-xs text-orange-600 flex items-center gap-1 mt-1",children:[e.jsx(La,{className:"w-3 h-3"}),"Expire le: ",new Date(h.expiresAt).toLocaleDateString("fr-FR")]}):h.hasLicense?e.jsxs("p",{className:"text-xs text-green-600 flex items-center gap-1 mt-1",children:[e.jsx(Yl,{className:"w-3 h-3"}),"Licence Ã  vie"]}):null]}),e.jsx("div",{className:"flex items-center gap-3",children:f?e.jsx(ze,{variant:"outline",className:"text-xs",children:"Toujours accessible"}):e.jsx(fc,{checked:h.hasLicense,onCheckedChange:()=>d(h.id,h.hasLicense)})})]},h.id)})})]})})]})]})}const Qm=({onContributorCreated:t})=>{const[s,r]=m.useState([]),[n,a]=m.useState(!0),[i,o]=m.useState(!1),[l,c]=m.useState(!1),[d,p]=m.useState(null),{toast:h}=ge(),f=x=>{const u=x.cgu_accepted===!0,E=x.cgu_accepted_date;return{hasAccepted:u,acceptedDate:E}},g=x=>R(void 0,null,function*(){try{const E=!f(x).hasAccepted,{error:L}=yield Y.from("profiles").update({cgu_accepted:E,cgu_accepted_date:E?new Date().toISOString():null}).eq("id",x.id);if(L)throw L;h({title:"Statut CGU mis Ã  jour",description:`CGU ${E?"acceptÃ©es":"rÃ©voquÃ©es"} pour ${x.email}`}),b()}catch(u){console.error("Erreur lors de la mise Ã  jour du statut CGU:",u),h({title:"Erreur",description:"Impossible de mettre Ã  jour le statut CGU",variant:"destructive"})}}),[j,S]=m.useState({email:"",password:"",firstName:"",lastName:"",username:""});m.useEffect(()=>{b()},[]);const b=()=>R(void 0,null,function*(){try{a(!0);const{data:x,error:u}=yield Y.from("profiles").select(`
          id,
          email,
          first_name,
          last_name,
          created_at,
          role,
          cgu_accepted,
          cgu_accepted_date
        `).eq("role","contributor").order("created_at",{ascending:!1});if(u)throw u;r(x||[])}catch(x){console.error("Error loading contributors:",x),h({title:"Erreur",description:"Impossible de charger les contributeurs",variant:"destructive"})}finally{a(!1)}}),y=x=>R(void 0,null,function*(){if(x.preventDefault(),!j.email||!j.password){h({title:"Erreur",description:"Email et mot de passe sont requis",variant:"destructive"});return}try{o(!0);const{data:u,error:E}=yield Y.auth.signUp({email:j.email,password:j.password,options:{data:{role:"contributor",first_name:j.firstName,last_name:j.lastName}}});if(E)throw E;if(!u.user)throw new Error("Erreur lors de la crÃ©ation du compte");const{error:L}=yield Y.from("profiles").update({role:"contributor",first_name:j.firstName,last_name:j.lastName}).eq("id",u.user.id);if(L)throw L;const{error:v}=yield Y.from("contributor_profiles").insert({user_id:u.user.id,username:j.username||j.email.split("@")[0],bio:"",is_public:!0});if(v)throw v;h({title:"Contributeur crÃ©Ã©",description:`Le compte contributeur pour ${j.email} a Ã©tÃ© crÃ©Ã© avec succÃ¨s`}),S({email:"",password:"",firstName:"",lastName:"",username:""}),c(!1),b(),t&&t()}catch(u){console.error("Error creating contributor:",u),h({title:"Erreur",description:u.message||"Impossible de crÃ©er le contributeur",variant:"destructive"})}finally{o(!1)}}),N=x=>R(void 0,null,function*(){try{const{error:u}=yield Y.from("contributor_profiles").delete().eq("user_id",x.id);if(u)throw u;const{error:E}=yield Y.from("profiles").update({role:"user"}).eq("id",x.id);if(E)throw E;h({title:"Contributeur supprimÃ©",description:`Le rÃ´le contributeur de ${x.email} a Ã©tÃ© rÃ©voquÃ©`,variant:"destructive"}),b()}catch(u){console.error("Error deleting contributor:",u),h({title:"Erreur",description:"Impossible de supprimer le contributeur",variant:"destructive"})}finally{p(null)}});return n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs(J,{children:[e.jsx(ae,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(Bs,{className:"w-5 h-5"}),"Gestion des Contributeurs"]}),e.jsx(me,{children:"CrÃ©ez et gÃ©rez les comptes contributeurs de la plateforme"})]}),e.jsxs(_,{onClick:()=>c(!l),className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(Ra,{className:"w-4 h-4 mr-2"}),l?"Annuler":"Nouveau Contributeur"]})]})}),l&&e.jsx(Z,{children:e.jsxs("form",{onSubmit:y,className:"space-y-4 bg-blue-50 p-6 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(q,{htmlFor:"email",className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-4 h-4"}),"Email *"]}),e.jsx(se,{id:"email",type:"email",value:j.email,onChange:x=>S($(M({},j),{email:x.target.value})),placeholder:"contributeur@example.com",required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"password",children:"Mot de passe *"}),e.jsx(se,{id:"password",type:"password",value:j.password,onChange:x=>S($(M({},j),{password:x.target.value})),placeholder:"Min. 6 caractÃ¨res",minLength:6,required:!0})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"firstName",children:"PrÃ©nom"}),e.jsx(se,{id:"firstName",type:"text",value:j.firstName,onChange:x=>S($(M({},j),{firstName:x.target.value})),placeholder:"Jean"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"lastName",children:"Nom"}),e.jsx(se,{id:"lastName",type:"text",value:j.lastName,onChange:x=>S($(M({},j),{lastName:x.target.value})),placeholder:"Dupont"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(q,{htmlFor:"username",children:"Pseudo (optionnel)"}),e.jsx(se,{id:"username",type:"text",value:j.username,onChange:x=>S($(M({},j),{username:x.target.value})),placeholder:"jean_creator"})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(_,{type:"submit",disabled:i,className:"bg-green-600 hover:bg-green-700",children:i?"CrÃ©ation...":"CrÃ©er le Contributeur"}),e.jsx(_,{type:"button",variant:"outline",onClick:()=>c(!1),children:"Annuler"})]})]})})]}),e.jsxs(J,{children:[e.jsx(ae,{children:e.jsxs(ie,{children:["Contributeurs Actifs (",s.length,")"]})}),e.jsx(Z,{children:s.length===0?e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(Bs,{className:"w-16 h-16 mx-auto mb-4 opacity-20"}),e.jsx("p",{className:"text-lg font-medium",children:"Aucun contributeur"}),e.jsx("p",{className:"text-sm",children:"CrÃ©ez votre premier compte contributeur"})]}):e.jsx("div",{className:"space-y-3",children:s.map(x=>{var u;return e.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border border-gray-200 rounded-lg hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-purple-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:(((u=x.first_name)==null?void 0:u[0])||x.email[0]).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:x.first_name&&x.last_name?`${x.first_name} ${x.last_name}`:x.email}),e.jsx(ze,{variant:"secondary",className:"text-xs",children:"Contributeur"}),(()=>f(x).hasAccepted?e.jsxs("span",{className:"text-xs px-2 py-1 bg-green-100 text-green-700 rounded flex items-center gap-1",children:[e.jsx(ls,{className:"w-3 h-3"}),"CGU acceptÃ©es"]}):e.jsxs("span",{className:"text-xs px-2 py-1 bg-red-100 text-red-700 rounded flex items-center gap-1",children:[e.jsx(kt,{className:"w-3 h-3"}),"CGU non acceptÃ©es"]}))()]}),e.jsxs("div",{className:"flex items-center gap-4 mt-1",children:[e.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[e.jsx(cs,{className:"w-3 h-3"}),x.email]}),x.created_at&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Zl,{className:"w-3 h-3"}),"CrÃ©Ã© le ",new Date(x.created_at).toLocaleDateString("fr-FR")]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[(()=>f(x).hasAccepted?e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>g(x),className:"gap-2 text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(kt,{className:"w-4 h-4"}),"RÃ©voquer CGU"]}):e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>g(x),className:"gap-2 text-green-600 border-green-300 hover:bg-green-50",children:[e.jsx(ls,{className:"w-4 h-4"}),"Marquer CGU acceptÃ©es"]}))(),e.jsxs(_,{variant:"destructive",size:"sm",onClick:()=>p(x),className:"gap-2",children:[e.jsx(he,{className:"w-4 h-4"}),"RÃ©voquer"]})]})]},x.id)})})})]}),e.jsx(Ke,{open:!!d,onOpenChange:()=>p(null),children:e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"RÃ©voquer le rÃ´le contributeur"}),e.jsxs(tt,{children:["ÃŠtes-vous sÃ»r de vouloir rÃ©voquer le rÃ´le contributeur de"," ",e.jsx("strong",{children:d==null?void 0:d.email})," ?",e.jsx("br",{}),e.jsx("br",{}),"Le profil contributeur sera supprimÃ© et l'utilisateur redeviendra un utilisateur standard. Cette action ne peut pas Ãªtre annulÃ©e."]})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>N(d),className:"bg-red-600 hover:bg-red-700",children:"RÃ©voquer"})]})]})})]})},Hm=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0),{toast:a}=ge(),i=()=>R(void 0,null,function*(){try{n(!0);const o=yield Eo();s(o)}catch(o){a({title:"Erreur",description:"Impossible de charger les formateurs",variant:"destructive"})}finally{n(!1)}});return m.useEffect(()=>{i()},[]),e.jsxs(_o,{defaultValue:"learners",className:"w-full",children:[e.jsxs(ko,{className:"grid w-full grid-cols-5",children:[e.jsx(Zt,{value:"learners",children:"Apprenants"}),e.jsx(Zt,{value:"trainers",children:"Formateurs"}),e.jsx(Zt,{value:"contributors",children:"Contributeurs"}),e.jsx(Zt,{value:"associations",children:"Associations"}),e.jsx(Zt,{value:"licenses",children:"Licences"})]}),e.jsx(es,{value:"learners",children:e.jsx(Bm,{})}),e.jsx(es,{value:"trainers",children:e.jsx(qm,{onTrainerCreated:i})}),e.jsx(es,{value:"contributors",children:e.jsx(Qm,{onContributorCreated:()=>{}})}),e.jsx(es,{value:"associations",children:e.jsx(Um,{})}),e.jsx(es,{value:"licenses",children:r?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Chargement..."}):e.jsx(Wm,{trainers:t})})]})};function Ce(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function Gm(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}const Cs=43200,ya=1440;let Jm={};function Xm(){return Jm}function ba(t){const s=Ce(t),r=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return r.setUTCFullYear(s.getFullYear()),+t-+r}function zs(t,s){const r=Ce(t),n=Ce(s),a=r.getTime()-n.getTime();return a<0?-1:a>0?1:a}function Km(t){return Gm(t,Date.now())}function Ym(t,s){const r=Ce(t),n=Ce(s),a=r.getFullYear()-n.getFullYear(),i=r.getMonth()-n.getMonth();return a*12+i}function Zm(t){return s=>{const n=(t?Math[t]:Math.trunc)(s);return n===0?0:n}}function eh(t,s){return+Ce(t)-+Ce(s)}function th(t){const s=Ce(t);return s.setHours(23,59,59,999),s}function sh(t){const s=Ce(t),r=s.getMonth();return s.setFullYear(s.getFullYear(),r+1,0),s.setHours(23,59,59,999),s}function rh(t){const s=Ce(t);return+th(s)==+sh(s)}function nh(t,s){const r=Ce(t),n=Ce(s),a=zs(r,n),i=Math.abs(Ym(r,n));let o;if(i<1)o=0;else{r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*i);let l=zs(r,n)===-a;rh(Ce(t))&&i===1&&zs(t,n)===1&&(l=!1),o=a*(i-Number(l))}return o===0?0:o}function ah(t,s,r){const n=eh(t,s)/1e3;return Zm(r==null?void 0:r.roundingMethod)(n)}const ih={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},oh=(t,s,r)=>{let n;const a=ih[t];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",s.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Qt(t){return(s={})=>{const r=s.width?String(s.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const lh={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},ch={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},dh={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},uh={date:Qt({formats:lh,defaultWidth:"full"}),time:Qt({formats:ch,defaultWidth:"full"}),dateTime:Qt({formats:dh,defaultWidth:"full"})},mh={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},hh=(t,s,r,n)=>mh[t];function lt(t){return(s,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,l=r!=null&&r.width?String(r.width):o;a=t.formattingValues[l]||t.formattingValues[o]}else{const o=t.defaultWidth,l=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[l]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(s):s;return a[i]}}const ph={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},xh={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},fh={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},gh={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},vh={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},yh=(t,s)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},bh={ordinalNumber:yh,era:lt({values:ph,defaultWidth:"wide"}),quarter:lt({values:xh,defaultWidth:"wide",argumentCallback:t=>t-1}),month:lt({values:fh,defaultWidth:"wide"}),day:lt({values:gh,defaultWidth:"wide"}),dayPeriod:lt({values:jh,defaultWidth:"wide",formattingValues:vh,defaultFormattingWidth:"wide"})};function ct(t){return(s,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=s.match(a);if(!i)return null;const o=i[0],l=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],c=Array.isArray(l)?Nh(l,h=>h.test(o)):wh(l,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(c):c,d=r.valueCallback?r.valueCallback(d):d;const p=s.slice(o.length);return{value:d,rest:p}}}function wh(t,s){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&s(t[r]))return r}function Nh(t,s){for(let r=0;r<t.length;r++)if(s(t[r]))return r}function Zi(t){return(s,r={})=>{const n=s.match(t.matchPattern);if(!n)return null;const a=n[0],i=s.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const l=s.slice(a.length);return{value:o,rest:l}}}const Sh=/^(\d+)(th|st|nd|rd)?/i,Ch=/\d+/i,_h={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},kh={any:[/^b/i,/^(a|c)/i]},Eh={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Ah={any:[/1/i,/2/i,/3/i,/4/i]},Th={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Dh={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Mh={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Fh={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ih={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ph={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},$h={ordinalNumber:Zi({matchPattern:Sh,parsePattern:Ch,valueCallback:t=>parseInt(t,10)}),era:ct({matchPatterns:_h,defaultMatchWidth:"wide",parsePatterns:kh,defaultParseWidth:"any"}),quarter:ct({matchPatterns:Eh,defaultMatchWidth:"wide",parsePatterns:Ah,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ct({matchPatterns:Th,defaultMatchWidth:"wide",parsePatterns:Dh,defaultParseWidth:"any"}),day:ct({matchPatterns:Mh,defaultMatchWidth:"wide",parsePatterns:Fh,defaultParseWidth:"any"}),dayPeriod:ct({matchPatterns:Ih,defaultMatchWidth:"any",parsePatterns:Ph,defaultParseWidth:"any"})},Rh={code:"en-US",formatDistance:oh,formatLong:uh,formatRelative:hh,localize:bh,match:$h,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Lh(t,s,r){var j,S;const n=Xm(),a=(S=(j=r==null?void 0:r.locale)!=null?j:n.locale)!=null?S:Rh,i=2520,o=zs(t,s);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:o});let c,d;o>0?(c=Ce(s),d=Ce(t)):(c=Ce(t),d=Ce(s));const p=ah(d,c),h=(ba(d)-ba(c))/1e3,f=Math.round((p-h)/60);let g;if(f<2)return r!=null&&r.includeSeconds?p<5?a.formatDistance("lessThanXSeconds",5,l):p<10?a.formatDistance("lessThanXSeconds",10,l):p<20?a.formatDistance("lessThanXSeconds",20,l):p<40?a.formatDistance("halfAMinute",0,l):p<60?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",1,l):f===0?a.formatDistance("lessThanXMinutes",1,l):a.formatDistance("xMinutes",f,l);if(f<45)return a.formatDistance("xMinutes",f,l);if(f<90)return a.formatDistance("aboutXHours",1,l);if(f<ya){const b=Math.round(f/60);return a.formatDistance("aboutXHours",b,l)}else{if(f<i)return a.formatDistance("xDays",1,l);if(f<Cs){const b=Math.round(f/ya);return a.formatDistance("xDays",b,l)}else if(f<Cs*2)return g=Math.round(f/Cs),a.formatDistance("aboutXMonths",g,l)}if(g=nh(d,c),g<12){const b=Math.round(f/Cs);return a.formatDistance("xMonths",b,l)}else{const b=g%12,y=Math.trunc(g/12);return b<3?a.formatDistance("aboutXYears",y,l):b<9?a.formatDistance("overXYears",y,l):a.formatDistance("almostXYears",y+1,l)}}function eo(t,s){return Lh(t,Km(t),s)}const zh={lessThanXSeconds:{one:"moins dâ€™une seconde",other:"moins de {{count}} secondes"},xSeconds:{one:"1 seconde",other:"{{count}} secondes"},halfAMinute:"30 secondes",lessThanXMinutes:{one:"moins dâ€™une minute",other:"moins de {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"environ 1 heure",other:"environ {{count}} heures"},xHours:{one:"1 heure",other:"{{count}} heures"},xDays:{one:"1 jour",other:"{{count}} jours"},aboutXWeeks:{one:"environ 1 semaine",other:"environ {{count}} semaines"},xWeeks:{one:"1 semaine",other:"{{count}} semaines"},aboutXMonths:{one:"environ 1 mois",other:"environ {{count}} mois"},xMonths:{one:"1 mois",other:"{{count}} mois"},aboutXYears:{one:"environ 1 an",other:"environ {{count}} ans"},xYears:{one:"1 an",other:"{{count}} ans"},overXYears:{one:"plus dâ€™un an",other:"plus de {{count}} ans"},almostXYears:{one:"presquâ€™un an",other:"presque {{count}} ans"}},Vh=(t,s,r)=>{let n;const a=zh[t];return typeof a=="string"?n=a:s===1?n=a.one:n=a.other.replace("{{count}}",String(s)),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"dans "+n:"il y a "+n:n},Oh={full:"EEEE d MMMM y",long:"d MMMM y",medium:"d MMM y",short:"dd/MM/y"},Bh={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},qh={full:"{{date}} 'Ã ' {{time}}",long:"{{date}} 'Ã ' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Uh={date:Qt({formats:Oh,defaultWidth:"full"}),time:Qt({formats:Bh,defaultWidth:"full"}),dateTime:Qt({formats:qh,defaultWidth:"full"})},Wh={lastWeek:"eeee 'dernier Ã ' p",yesterday:"'hier Ã ' p",today:"'aujourdâ€™hui Ã ' p",tomorrow:"'demain Ã ' p'",nextWeek:"eeee 'prochain Ã ' p",other:"P"},Qh=(t,s,r,n)=>Wh[t],Hh={narrow:["av. J.-C","ap. J.-C"],abbreviated:["av. J.-C","ap. J.-C"],wide:["avant JÃ©sus-Christ","aprÃ¨s JÃ©sus-Christ"]},Gh={narrow:["T1","T2","T3","T4"],abbreviated:["1er trim.","2Ã¨me trim.","3Ã¨me trim.","4Ã¨me trim."],wide:["1er trimestre","2Ã¨me trimestre","3Ã¨me trimestre","4Ã¨me trimestre"]},Jh={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["janv.","fÃ©vr.","mars","avr.","mai","juin","juil.","aoÃ»t","sept.","oct.","nov.","dÃ©c."],wide:["janvier","fÃ©vrier","mars","avril","mai","juin","juillet","aoÃ»t","septembre","octobre","novembre","dÃ©cembre"]},Xh={narrow:["D","L","M","M","J","V","S"],short:["di","lu","ma","me","je","ve","sa"],abbreviated:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],wide:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"]},Kh={narrow:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"mat.",afternoon:"ap.m.",evening:"soir",night:"mat."},abbreviated:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"matin",afternoon:"aprÃ¨s-midi",evening:"soir",night:"matin"},wide:{am:"AM",pm:"PM",midnight:"minuit",noon:"midi",morning:"du matin",afternoon:"de lâ€™aprÃ¨s-midi",evening:"du soir",night:"du matin"}},Yh=(t,s)=>{const r=Number(t),n=s==null?void 0:s.unit;if(r===0)return"0";const a=["year","week","hour","minute","second"];let i;return r===1?i=n&&a.includes(n)?"Ã¨re":"er":i="Ã¨me",r+i},Zh=["MMM","MMMM"],ep={preprocessor:(t,s)=>t.getDate()===1||!s.some(n=>n.isToken&&Zh.includes(n.value))?s:s.map(n=>n.isToken&&n.value==="do"?{isToken:!0,value:"d"}:n),ordinalNumber:Yh,era:lt({values:Hh,defaultWidth:"wide"}),quarter:lt({values:Gh,defaultWidth:"wide",argumentCallback:t=>t-1}),month:lt({values:Jh,defaultWidth:"wide"}),day:lt({values:Xh,defaultWidth:"wide"}),dayPeriod:lt({values:Kh,defaultWidth:"wide"})},tp=/^(\d+)(iÃ¨me|Ã¨re|Ã¨me|er|e)?/i,sp=/\d+/i,rp={narrow:/^(av\.J\.C|ap\.J\.C|ap\.J\.-C)/i,abbreviated:/^(av\.J\.-C|av\.J-C|apr\.J\.-C|apr\.J-C|ap\.J-C)/i,wide:/^(avant JÃ©sus-Christ|aprÃ¨s JÃ©sus-Christ)/i},np={any:[/^av/i,/^ap/i]},ap={narrow:/^T?[1234]/i,abbreviated:/^[1234](er|Ã¨me|e)? trim\.?/i,wide:/^[1234](er|Ã¨me|e)? trimestre/i},ip={any:[/1/i,/2/i,/3/i,/4/i]},op={narrow:/^[jfmasond]/i,abbreviated:/^(janv|fÃ©vr|mars|avr|mai|juin|juill|juil|aoÃ»t|sept|oct|nov|dÃ©c)\.?/i,wide:/^(janvier|fÃ©vrier|mars|avril|mai|juin|juillet|aoÃ»t|septembre|octobre|novembre|dÃ©cembre)/i},lp={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^av/i,/^ma/i,/^juin/i,/^juil/i,/^ao/i,/^s/i,/^o/i,/^n/i,/^d/i]},cp={narrow:/^[lmjvsd]/i,short:/^(di|lu|ma|me|je|ve|sa)/i,abbreviated:/^(dim|lun|mar|mer|jeu|ven|sam)\.?/i,wide:/^(dimanche|lundi|mardi|mercredi|jeudi|vendredi|samedi)/i},dp={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^di/i,/^lu/i,/^ma/i,/^me/i,/^je/i,/^ve/i,/^sa/i]},up={narrow:/^(a|p|minuit|midi|mat\.?|ap\.?m\.?|soir|nuit)/i,any:/^([ap]\.?\s?m\.?|du matin|de l'aprÃ¨s[-\s]midi|du soir|de la nuit)/i},mp={any:{am:/^a/i,pm:/^p/i,midnight:/^min/i,noon:/^mid/i,morning:/mat/i,afternoon:/ap/i,evening:/soir/i,night:/nuit/i}},hp={ordinalNumber:Zi({matchPattern:tp,parsePattern:sp,valueCallback:t=>parseInt(t)}),era:ct({matchPatterns:rp,defaultMatchWidth:"wide",parsePatterns:np,defaultParseWidth:"any"}),quarter:ct({matchPatterns:ap,defaultMatchWidth:"wide",parsePatterns:ip,defaultParseWidth:"any",valueCallback:t=>t+1}),month:ct({matchPatterns:op,defaultMatchWidth:"wide",parsePatterns:lp,defaultParseWidth:"any"}),day:ct({matchPatterns:cp,defaultMatchWidth:"wide",parsePatterns:dp,defaultParseWidth:"any"}),dayPeriod:ct({matchPatterns:up,defaultMatchWidth:"any",parsePatterns:mp,defaultParseWidth:"any"})},to={code:"fr",formatDistance:Vh,formatLong:Uh,formatRelative:Qh,localize:ep,match:hp,options:{weekStartsOn:1,firstWeekContainsDate:4}},pp=()=>{const[t,s]=m.useState([]),[r,n]=m.useState(!0),[a,i]=m.useState(null),[o,l]=m.useState(!1),{toast:c}=ge(),d=m.useCallback((b=!1)=>R(void 0,null,function*(){n(!0);try{const y=yield Ao(b);s(y||[])}catch(y){c({title:"Erreur",description:"Impossible de charger les rapports d'erreurs.",variant:"destructive"})}finally{n(!1)}}),[c]);m.useEffect(()=>{d()},[d]);const p=b=>R(void 0,null,function*(){try{yield To(b),c({title:"Rapport supprimÃ©",description:"Le rapport a Ã©tÃ© supprimÃ© avec succÃ¨s.",variant:"destructive"}),d(!0)}catch(y){c({title:"Erreur",description:"La suppression du rapport a Ã©chouÃ©.",variant:"destructive"})}}),h=b=>R(void 0,null,function*(){try{yield Do(b,{is_sent:!0,sent_at:new Date().toISOString()}),c({title:"MarquÃ© comme traitÃ©",description:"Le rapport a Ã©tÃ© marquÃ© comme traitÃ©.",className:"bg-green-600 text-white"}),d(!0)}catch(y){c({title:"Erreur",description:"Impossible de mettre Ã  jour le rapport.",variant:"destructive"})}}),f=b=>{i(b),l(!0)},g=m.useMemo(()=>t.sort((b,y)=>new Date(y.report_date)-new Date(b.report_date)),[t]),j=m.useMemo(()=>t.filter(b=>b.is_sent).length,[t]),S=m.useMemo(()=>t.filter(b=>!b.is_sent).length,[t]);return e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex justify-between items-center",children:[e.jsx("span",{children:"Visionneuse des Rapports d'Erreurs"}),e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>d(!0),disabled:r,children:e.jsx(qt,{className:`h-4 w-4 ${r?"animate-spin":""}`})})]}),e.jsxs(me,{children:[S," rapport(s) non traitÃ©(s) et ",j," rapport(s) traitÃ©(s)."]})]}),e.jsxs(Z,{children:[e.jsx("div",{className:"border rounded-lg overflow-hidden",children:e.jsxs(rr,{children:[e.jsx(nr,{children:e.jsxs(Le,{children:[e.jsx(je,{children:"Statut"}),e.jsx(je,{children:"CatÃ©gorie"}),e.jsx(je,{children:"TÃ¢che / Version"}),e.jsx(je,{children:"Date"}),e.jsx(je,{className:"text-right",children:"Actions"})]})}),e.jsx(ar,{children:r?e.jsx(Le,{children:e.jsx(re,{colSpan:5,className:"h-24 text-center",children:"Chargement..."})}):g.length===0?e.jsx(Le,{children:e.jsx(re,{colSpan:5,className:"h-24 text-center",children:"Aucun rapport d'erreur."})}):g.map(b=>e.jsxs(Le,{className:b.is_sent?"":"bg-yellow-50 dark:bg-yellow-900/20",children:[e.jsx(re,{children:e.jsx(ze,{variant:b.is_sent?"default":"secondary",className:b.is_sent?"bg-green-600":"",children:b.is_sent?"TraitÃ©":"Non traitÃ©"})}),e.jsx(re,{className:"font-medium",children:b.category||"N/A"}),e.jsxs(re,{className:"text-sm text-muted-foreground",children:[e.jsx("div",{children:b.exercise_title||"TÃ¢che non spÃ©cifiÃ©e"}),e.jsx("div",{className:"text-xs",children:b.version_name?`${b.version_name} (${b.version_android||"N/A"})`:""})]}),e.jsx(re,{children:eo(new Date(b.report_date),{addSuffix:!0,locale:to})}),e.jsxs(re,{className:"text-right",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>f(b),title:"Voir les dÃ©tails",children:e.jsx(Gr,{className:"h-4 w-4"})}),!b.is_sent&&e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>h(b.id),title:"Marquer comme traitÃ©",children:e.jsx(ls,{className:"h-4 w-4 text-green-600"})}),e.jsxs(Ke,{children:[e.jsx(vs,{asChild:!0,children:e.jsx(_,{variant:"ghost",size:"icon",title:"Supprimer",children:e.jsx(he,{className:"h-4 w-4 text-destructive"})})}),e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"Supprimer ce rapport ?"}),e.jsx(tt,{children:"Cette action est irrÃ©versible. Le rapport sera dÃ©finitivement supprimÃ©."})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>p(b.id),className:"bg-destructive hover:bg-destructive/80",children:"Supprimer"})]})]})]})]})]},b.id))})]})}),e.jsx(ht,{open:o,onOpenChange:l,children:e.jsxs(pt,{className:"max-h-[90vh] overflow-y-auto sm:max-w-[600px]",children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"DÃ©tails du Rapport d'Erreur"}),e.jsxs(gt,{children:["Rapport de ",(a==null?void 0:a.user_first_name)||"Anonyme"," du ",a?new Date(a.report_date).toLocaleString("fr-FR"):""]})]}),e.jsxs("div",{className:"grid gap-4 py-4 max-h-[70vh] overflow-y-auto px-2",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("p",{className:"text-right text-muted-foreground",children:"CatÃ©gorie"}),e.jsx("p",{className:"col-span-3 font-semibold",children:a==null?void 0:a.category})]}),e.jsxs("div",{className:"grid grid-cols-4 items-start gap-4",children:[e.jsx("p",{className:"text-right text-muted-foreground pt-1",children:"Description"}),e.jsx("p",{className:"col-span-3 bg-muted p-3 rounded-md",children:a==null?void 0:a.description})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("p",{className:"text-right text-muted-foreground",children:"TÃ¢che"}),e.jsx("p",{className:"col-span-3",children:(a==null?void 0:a.exercise_title)||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("p",{className:"text-right text-muted-foreground",children:"Version"}),e.jsx("p",{className:"col-span-3",children:a!=null&&a.version_name?`${a.version_name} (Android ${a.version_android})`:"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("p",{className:"text-right text-muted-foreground",children:"Ã‰tape NÂ°"}),e.jsx("p",{className:"col-span-3",children:(a==null?void 0:a.step_index)||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx("p",{className:"text-right text-muted-foreground",children:"App Version"}),e.jsx("p",{className:"col-span-3",children:a==null?void 0:a.app_version})]})]}),e.jsxs(jt,{children:[(a==null?void 0:a.task_id)&&(a==null?void 0:a.version_id)&&e.jsx(_,{asChild:!0,variant:"outline",children:e.jsx(Sa,{to:`/admin/preview/tache/${a.task_id}/version/${a.version_id}?stepIndex=${(a.step_index||1)-1}`,children:"Voir l'Ã©tape"})}),e.jsx(Cr,{asChild:!0,children:e.jsx(_,{children:"Fermer"})})]})]})})]})]})};function xp(){const[t,s]=m.useState([]),[r,n]=m.useState(0),[a,i]=m.useState(!1),[o,l]=m.useState(null),[c,d]=m.useState(!1),{toast:p}=ge();m.useEffect(()=>{h(),f()},[]);const h=()=>R(this,null,function*(){try{i(!0);const y=yield Mo();s(y)}catch(y){p({title:"Erreur",description:"Impossible de charger les messages",variant:"destructive"})}finally{i(!1)}}),f=()=>R(this,null,function*(){const y=yield Fo();n(y)}),g=y=>R(this,null,function*(){try{yield Io(y),yield h(),yield f(),p({title:"Message marquÃ© comme lu"})}catch(N){p({title:"Erreur",description:"Impossible de marquer le message",variant:"destructive"})}}),j=y=>R(this,null,function*(){try{yield Po(y),yield h(),yield f(),p({title:"Message marquÃ© comme rÃ©pondu"})}catch(N){p({title:"Erreur",description:"Impossible de marquer le message",variant:"destructive"})}}),S=()=>R(this,null,function*(){if(o)try{yield $o(o.id),yield h(),yield f(),d(!1),l(null),p({title:"Message supprimÃ©"})}catch(y){p({title:"Erreur",description:"Impossible de supprimer le message",variant:"destructive"})}}),b=y=>new Date(y).toLocaleString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"});return e.jsxs(e.Fragment,{children:[e.jsxs(J,{children:[e.jsx(ae,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5"}),"Messages de Contact",r>0&&e.jsxs(ze,{variant:"destructive",className:"ml-2",children:[r," nouveau",r>1?"x":""]})]}),e.jsx(me,{children:"GÃ©rez les messages reÃ§us via le formulaire de contact"})]}),e.jsx(_,{onClick:h,variant:"outline",size:"sm",disabled:a,children:e.jsx(qt,{className:`w-4 h-4 ${a?"animate-spin":""}`})})]})}),e.jsx(Z,{children:a&&t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Chargement..."}):t.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-8",children:"Aucun message reÃ§u"}):e.jsx("div",{className:"space-y-3",children:t.map(y=>e.jsx("div",{className:`p-4 border rounded-lg transition-colors ${y.is_read?"hover:bg-muted/30":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[y.is_read?e.jsx(Nn,{className:"w-4 h-4 text-muted-foreground"}):e.jsx(cs,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:y.name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",y.email,")"]}),y.replied&&e.jsxs(ze,{variant:"outline",className:"text-xs",children:[e.jsx(kr,{className:"w-3 h-3 mr-1"}),"RÃ©pondu"]})]}),y.subject&&e.jsxs("p",{className:"font-medium text-sm",children:["Sujet: ",y.subject]}),e.jsx("p",{className:"text-sm whitespace-pre-wrap bg-white p-3 rounded border",children:y.message}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ReÃ§u le ",b(y.created_at)]})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[!y.is_read&&e.jsx(_,{onClick:()=>g(y.id),variant:"outline",size:"sm",title:"Marquer comme lu",children:e.jsx(Nn,{className:"w-4 h-4"})}),!y.replied&&e.jsx(_,{onClick:()=>j(y.id),variant:"outline",size:"sm",title:"Marquer comme rÃ©pondu",children:e.jsx(kr,{className:"w-4 h-4"})}),e.jsx(_,{onClick:()=>{l(y),d(!0)},variant:"outline",size:"sm",title:"Supprimer",children:e.jsx(he,{className:"w-4 h-4 text-destructive"})})]})]})},y.id))})})]}),e.jsx(Ke,{open:c,onOpenChange:d,children:e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"Supprimer ce message ?"}),e.jsx(tt,{children:"Cette action est irrÃ©versible. Le message sera dÃ©finitivement supprimÃ©."})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:S,className:"bg-destructive text-destructive-foreground",children:"Supprimer"})]})]})})]})}const fp=()=>{const{fetchDeletedTasks:t,restoreTask:s,permanentlyDeleteTask:r,isLoading:n}=Xe(),{toast:a}=ge(),[i,o]=m.useState([]),[l,c]=m.useState(!0),d=m.useCallback(()=>R(void 0,null,function*(){c(!0);const g=yield t();o(g),c(!1)}),[t]);m.useEffect(()=>{d()},[d]);const p=g=>R(void 0,null,function*(){try{yield s(g),a({title:"TÃ¢che restaurÃ©e",description:"La tÃ¢che est de nouveau visible dans la liste principale."}),d()}catch(j){a({title:"Erreur",description:"Impossible de restaurer la tÃ¢che.",variant:"destructive"})}}),h=g=>R(void 0,null,function*(){try{yield r(g),a({title:"TÃ¢che supprimÃ©e dÃ©finitivement",description:"La tÃ¢che a Ã©tÃ© supprimÃ©e pour de bon."}),d()}catch(j){a({title:"Erreur",description:"Impossible de supprimer la tÃ¢che dÃ©finitivement.",variant:"destructive"})}}),f=n||l;return e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Corbeille"}),e.jsx(me,{children:"GÃ©rez les tÃ¢ches supprimÃ©es. Elles seront dÃ©finitivement effacÃ©es aprÃ¨s 30 jours."})]}),e.jsx(Z,{children:f?e.jsx("div",{className:"flex justify-center items-center h-40",children:e.jsx(Ee,{className:"h-8 w-8 animate-spin text-primary"})}):i.length>0?e.jsx("ul",{className:"space-y-3",children:i.map(g=>e.jsxs("li",{className:"flex items-center justify-between p-3 rounded-lg bg-muted/50",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:g.title}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["SupprimÃ©e ",eo(new Date(g.updated_at),{addSuffix:!0,locale:to})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs(_,{variant:"outline",size:"sm",onClick:()=>p(g.id),children:[e.jsx(ec,{className:"mr-2 h-4 w-4"})," Restaurer"]}),e.jsxs(Ke,{children:[e.jsx(vs,{asChild:!0,children:e.jsxs(_,{variant:"destructive",size:"sm",children:[e.jsx(he,{className:"mr-2 h-4 w-4"})," Supprimer"]})}),e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"ÃŠtes-vous absolument sÃ»r ?"}),e.jsxs(tt,{children:['Cette action est irrÃ©versible. La tÃ¢che "',g.title,'" sera supprimÃ©e dÃ©finitivement.']})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:()=>h(g.id),children:"Confirmer la suppression"})]})]})]})]})]},g.id))}):e.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[e.jsx(he,{className:"mx-auto h-12 w-12"}),e.jsx("p",{className:"mt-4",children:"La corbeille est vide."})]})})]})},gp=()=>{const{toast:t}=ge(),{categories:s,categoriesHierarchy:r,renameCategory:n,deleteCategory:a,addCategory:i,addSubcategory:o,removeSubcategoryParent:l}=Xe(),[c,d]=m.useState([]),[p,h]=m.useState([]),[f,g]=m.useState(null),[j,S]=m.useState(""),[b,y]=m.useState(!1),[N,x]=m.useState(!1),[u,E]=m.useState(""),[L,v]=m.useState(""),[D,F]=m.useState(""),[O,U]=m.useState(!1),[H,X]=m.useState({});m.useEffect(()=>{d(s||[])},[s]),m.useEffect(()=>{h(r||[])},[r]);const A=C=>{g(C),S(C.name)},T=()=>R(void 0,null,function*(){if(!f||!j.trim()){t({title:"Nom invalide",description:"Le nom de la catÃ©gorie ne peut pas Ãªtre vide.",variant:"destructive"});return}if(c.some(C=>C.name.toLowerCase()===j.trim().toLowerCase()&&C.id!==f.id)){t({title:"CatÃ©gorie existante",description:"Ce nom de catÃ©gorie existe dÃ©jÃ .",variant:"destructive"});return}U(!0),yield n(f.id,j.trim()),U(!1),t({title:"CatÃ©gorie renommÃ©e",description:`"${f.name}" est devenu "${j.trim()}".`}),g(null),S("")}),I=C=>R(void 0,null,function*(){if(C.name==="GÃ©nÃ©ral"){t({title:"Suppression impossible",description:"La catÃ©gorie 'GÃ©nÃ©ral' ne peut pas Ãªtre supprimÃ©e.",variant:"destructive"});return}U(!0),yield a(C.id),U(!1),t({title:"CatÃ©gorie supprimÃ©e",description:`La catÃ©gorie "${C.name}" a Ã©tÃ© supprimÃ©e.`,variant:"destructive"})}),w=()=>R(void 0,null,function*(){const C=u.trim();if(!C){t({title:"Nom invalide",description:"Le nom de la catÃ©gorie ne peut pas Ãªtre vide.",variant:"destructive"});return}if(c.some(Q=>Q.name.toLowerCase()===C.toLowerCase())){t({title:"CatÃ©gorie existante",description:"Ce nom de catÃ©gorie existe dÃ©jÃ .",variant:"destructive"});return}U(!0),yield i(C),U(!1),t({title:"CatÃ©gorie ajoutÃ©e",description:`La catÃ©gorie "${C}" a Ã©tÃ© ajoutÃ©e.`}),E(""),y(!1)}),P=C=>{C.key==="Enter"&&(C.preventDefault(),w())},G=C=>{C.key==="Enter"&&(C.preventDefault(),z())},z=()=>R(void 0,null,function*(){const C=L.trim();if(!C){t({title:"Nom invalide",description:"Le nom de la sous-catÃ©gorie ne peut pas Ãªtre vide.",variant:"destructive"});return}if(!D){t({title:"CatÃ©gorie parente manquante",description:"Veuillez sÃ©lectionner une catÃ©gorie parente.",variant:"destructive"});return}U(!0),yield o(parseInt(D),C),U(!1),t({title:"Sous-catÃ©gorie ajoutÃ©e",description:`La sous-catÃ©gorie "${C}" a Ã©tÃ© ajoutÃ©e.`}),v(""),F(""),x(!1)}),k=C=>{X(Q=>$(M({},Q),{[C]:!Q[C]}))};return e.jsxs(J,{children:[e.jsxs(ae,{children:[e.jsx(ie,{children:"Gestion des CatÃ©gories"}),e.jsx(me,{children:"Modifiez, ajoutez ou supprimez des catÃ©gories et sous-catÃ©gories. La suppression d'une catÃ©gorie nÃ©cessite une rÃ©affectation manuelle des tÃ¢ches."})]}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(ht,{open:b,onOpenChange:y,children:[e.jsx(os,{asChild:!0,children:e.jsxs(_,{size:"sm",className:"flex-1",children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une CatÃ©gorie"]})}),e.jsx(pt,{className:"max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:C=>{C.preventDefault(),w()},children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"Ajouter une nouvelle catÃ©gorie"}),e.jsx(gt,{children:"Entrez le nom de la nouvelle catÃ©gorie."})]}),e.jsx("div",{className:"grid gap-4 py-4",children:e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(q,{htmlFor:"new-category-name",className:"text-right",children:"Nom"}),e.jsx(se,{id:"new-category-name",value:u,onChange:C=>E(C.target.value),onKeyDown:P,className:"col-span-3"})]})}),e.jsx(jt,{children:e.jsxs(_,{type:"submit",disabled:O,children:[O?e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Ajouter"]})})]})})]}),e.jsxs(ht,{open:N,onOpenChange:x,children:[e.jsx(os,{asChild:!0,children:e.jsxs(_,{size:"sm",className:"flex-1",variant:"outline",children:[e.jsx($t,{className:"mr-2 h-4 w-4"})," Ajouter une Sous-CatÃ©gorie"]})}),e.jsx(pt,{className:"max-h-[90vh] overflow-y-auto",children:e.jsxs("form",{onSubmit:C=>{C.preventDefault(),z()},children:[e.jsxs(xt,{children:[e.jsx(ft,{children:"Ajouter une sous-catÃ©gorie"}),e.jsx(gt,{children:"SÃ©lectionnez une catÃ©gorie parente et entrez le nom de la sous-catÃ©gorie."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(q,{htmlFor:"parent-category",className:"text-right",children:"CatÃ©gorie Parente"}),e.jsxs(ye,{value:D,onValueChange:F,children:[e.jsx(be,{className:"col-span-3",id:"parent-category",children:e.jsx(we,{placeholder:"SÃ©lectionner une catÃ©gorie"})}),e.jsx(Ne,{children:c.map(C=>e.jsx(xe,{value:C.id.toString(),children:C.name},C.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(q,{htmlFor:"new-subcategory-name",className:"text-right",children:"Nom"}),e.jsx(se,{id:"new-subcategory-name",value:L,onChange:C=>v(C.target.value),onKeyDown:G,className:"col-span-3"})]})]}),e.jsx(jt,{children:e.jsxs(_,{type:"submit",disabled:O,children:[O?e.jsx(Ee,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(Me,{className:"mr-2 h-4 w-4"}),"Ajouter"]})})]})})]})]}),O&&c.length===0?e.jsx("div",{className:"text-center p-4",children:e.jsx(Ee,{className:"h-6 w-6 animate-spin mx-auto"})}):e.jsx("ul",{className:"space-y-2",children:p.map(C=>e.jsxs("div",{children:[e.jsxs("li",{className:"flex items-center justify-between p-3 border rounded-md bg-muted/20 hover:bg-muted/40 transition-colors",children:[e.jsxs("div",{className:"flex-grow flex items-center space-x-2",children:[C.subcategories&&C.subcategories.length>0&&e.jsx("button",{onClick:()=>k(C.id),className:"p-1",children:e.jsx(Ma,{className:`h-4 w-4 transition-transform ${H[C.id]?"rotate-90":""}`})}),(f==null?void 0:f.id)===C.id?e.jsx(se,{value:j,onChange:Q=>S(Q.target.value),className:"h-8 text-sm"}):e.jsx("span",{className:"text-sm font-bold",children:C.name})]}),(f==null?void 0:f.id)!==C.id&&e.jsxs("div",{className:"space-x-1",children:[e.jsx(_,{onClick:()=>A(C),size:"icon",variant:"ghost",className:"text-blue-600 hover:text-blue-700 h-8 w-8",disabled:O,children:e.jsx(Sn,{className:"h-4 w-4"})}),C.name!=="GÃ©nÃ©ral"&&e.jsx(_,{onClick:()=>I(C),size:"icon",variant:"ghost",className:"text-red-500 hover:text-red-600 h-8 w-8",disabled:O,children:e.jsx(he,{className:"h-4 w-4"})})]}),(f==null?void 0:f.id)===C.id&&e.jsxs("div",{className:"space-x-1",children:[e.jsx(_,{onClick:T,size:"icon",variant:"ghost",className:"text-green-600 hover:text-green-700 h-8 w-8",disabled:O,children:O?e.jsx(Ee,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(_,{onClick:()=>g(null),size:"icon",variant:"ghost",className:"h-8 w-8",disabled:O,children:e.jsx(Je,{className:"h-4 w-4"})})]})]}),H[C.id]&&C.subcategories&&C.subcategories.length>0&&e.jsx("ul",{className:"ml-8 space-y-2 mt-2",children:C.subcategories.map(Q=>e.jsxs("li",{className:"flex items-center justify-between p-3 border border-l-4 border-l-blue-400 rounded-md bg-blue-50 hover:bg-blue-100 transition-colors",children:[(f==null?void 0:f.id)===Q.id?e.jsxs("div",{className:"flex-grow flex items-center space-x-2",children:[e.jsx(se,{value:j,onChange:le=>S(le.target.value),className:"h-8 text-sm"}),e.jsx(_,{onClick:T,size:"icon",variant:"ghost",className:"text-green-600 hover:text-green-700 h-8 w-8",disabled:O,children:O?e.jsx(Ee,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"})}),e.jsx(_,{onClick:()=>g(null),size:"icon",variant:"ghost",className:"h-8 w-8",disabled:O,children:e.jsx(Je,{className:"h-4 w-4"})})]}):e.jsx("span",{className:"text-sm text-gray-700 flex-grow",children:Q.name}),(f==null?void 0:f.id)!==Q.id&&e.jsxs("div",{className:"space-x-1",children:[e.jsx(_,{onClick:()=>A(Q),size:"icon",variant:"ghost",className:"text-blue-600 hover:text-blue-700 h-8 w-8",disabled:O,children:e.jsx(Sn,{className:"h-4 w-4"})}),e.jsx(_,{onClick:()=>I(Q),size:"icon",variant:"ghost",className:"text-red-500 hover:text-red-600 h-8 w-8",disabled:O,children:e.jsx(he,{className:"h-4 w-4"})})]})]},Q.id))})]},C.id))})]})]})};function jp({currentUser:t}){const[s,r]=m.useState([]),[n,a]=m.useState([]),[i,o]=m.useState(!0),[l,c]=m.useState(""),[d,p]=m.useState("all"),[h,f]=m.useState({totalReviews:0,averageRating:0,ratingDistribution:{5:0,4:0,3:0,2:0,1:0}});m.useEffect(()=>{g()},[t]);const g=()=>R(this,null,function*(){try{o(!0);let u=Y.from("learner_reviews").select(`
          id,
          rating,
          comment,
          created_at,
          learner:learner_id(id, email, first_name),
          task:task_id(id, title),
          trainer:trainer_id(id, email, first_name)
        `).order("created_at",{ascending:!1});(t==null?void 0:t.role)==="formateur"&&(u=u.eq("trainer_id",t.id));const{data:E,error:L}=yield u;if(L)throw L;r(E||[]),j(E||[]),S(E||[],l,d)}catch(u){console.error("Erreur lors de la rÃ©cupÃ©ration des avis:",u)}finally{o(!1)}}),j=u=>{const E={5:0,4:0,3:0,2:0,1:0};let L=0;u.forEach(D=>{D.rating&&(E[D.rating]++,L+=D.rating)});const v=u.length>0?(L/u.length).toFixed(1):0;f({totalReviews:u.length,averageRating:v,ratingDistribution:E})},S=(u,E,L)=>{let v=u;E.trim()&&(v=v.filter(D=>{var F,O,U,H,X,A,T;return((O=(F=D.learner)==null?void 0:F.first_name)==null?void 0:O.toLowerCase().includes(E.toLowerCase()))||((H=(U=D.learner)==null?void 0:U.email)==null?void 0:H.toLowerCase().includes(E.toLowerCase()))||((A=(X=D.task)==null?void 0:X.title)==null?void 0:A.toLowerCase().includes(E.toLowerCase()))||((T=D.comment)==null?void 0:T.toLowerCase().includes(E.toLowerCase()))})),L!=="all"&&(v=v.filter(D=>D.rating===parseInt(L))),a(v)},b=u=>{c(u),S(s,u,d)},y=u=>{p(u),S(s,l,u)},N=()=>{const u=[["Apprenant","Email","TÃ¢che","Note","Commentaire","Date"],...n.map(D=>{var F,O,U;return[((F=D.learner)==null?void 0:F.first_name)||"N/A",((O=D.learner)==null?void 0:O.email)||"N/A",((U=D.task)==null?void 0:U.title)||"N/A",D.rating||"N/A",D.comment||"",new Date(D.created_at).toLocaleDateString("fr-FR")]})].map(D=>D.map(F=>`"${F}"`).join(",")).join(`
`),E=new Blob([u],{type:"text/csv"}),L=window.URL.createObjectURL(E),v=document.createElement("a");v.href=L,v.download=`avis_apprenants_${new Date().toISOString().split("T")[0]}.csv`,v.click()},x=({rating:u,size:E="sm"})=>{const L=E==="lg"?"h-6 w-6":"h-4 w-4";return e.jsx("div",{className:"flex gap-1",children:[1,2,3,4,5].map(v=>e.jsx(Pa,{className:`${L} ${v<=u?"fill-yellow-400 text-yellow-400":"text-gray-300"}`},v))})};return i?e.jsx("div",{className:"text-center py-8",children:"Chargement des avis..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-blue-900",children:"Avis reÃ§us"}),e.jsx(za,{className:"h-5 w-5 text-blue-600"})]}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:h.totalReviews})]}),e.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-amber-100 p-6 rounded-lg border border-amber-200",children:[e.jsx("h3",{className:"text-sm font-medium text-amber-900 mb-2",children:"Note moyenne"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("p",{className:"text-3xl font-bold text-amber-600",children:h.averageRating}),e.jsx(x,{rating:Math.round(h.averageRating),size:"lg"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-lg border border-green-200",children:[e.jsx("h3",{className:"text-sm font-medium text-green-900 mb-3",children:"Distribution"}),e.jsx("div",{className:"space-y-1 text-xs",children:[5,4,3,2,1].map(u=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"w-4 text-green-700 font-bold",children:[u,"â˜…"]}),e.jsx("div",{className:"flex-1 h-2 bg-green-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600",style:{width:h.totalReviews>0?`${h.ratingDistribution[u]/h.totalReviews*100}%`:"0%"}})}),e.jsx("span",{className:"w-6 text-right text-green-700 font-bold",children:h.ratingDistribution[u]})]},u))})]})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-gray-200 space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(se,{placeholder:"Rechercher par apprenant, tÃ¢che ou commentaire...",value:l,onChange:u=>b(u.target.value),className:"w-full"})}),e.jsxs("select",{value:d,onChange:u=>y(u.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg bg-white",children:[e.jsx("option",{value:"all",children:"Toutes les notes"}),e.jsx("option",{value:"5",children:"â­â­â­â­â­ (5)"}),e.jsx("option",{value:"4",children:"â­â­â­â­ (4)"}),e.jsx("option",{value:"3",children:"â­â­â­ (3)"}),e.jsx("option",{value:"2",children:"â­â­ (2)"}),e.jsx("option",{value:"1",children:"â­ (1)"})]}),e.jsxs(_,{onClick:N,variant:"outline",className:"flex items-center gap-2",children:[e.jsx(Ta,{className:"h-4 w-4"}),"Exporter CSV"]})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[n.length," avis trouvÃ©",n.length!==1?"s":""]})]}),e.jsx("div",{className:"space-y-4",children:n.length===0?e.jsx("div",{className:"bg-gray-50 p-8 rounded-lg text-center text-gray-500",children:"Aucun avis Ã  afficher"}):n.map(u=>{var E,L,v;return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[((E=u.learner)==null?void 0:E.first_name)||"Apprenant"," (",((L=u.learner)==null?void 0:L.email)||"N/A",")"]}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["TÃ¢che: ",e.jsx("span",{className:"font-medium",children:((v=u.task)==null?void 0:v.title)||"N/A"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx(x,{rating:u.rating||0}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(u.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})})]})]}),u.comment&&e.jsxs("div",{className:"bg-gray-50 p-3 rounded border border-gray-200 text-sm text-gray-700 italic",children:['"',u.comment,'"']})]},u.id)})})]})}const _s={high:{label:"Prioritaire",icon:tc,color:"text-red-600 bg-red-50"},normal:{label:"Normal",icon:sc,color:"text-blue-600 bg-blue-50"},low:{label:"Optionnel",icon:rc,color:"text-gray-600 bg-gray-50"}},ks={pending:{label:"Ã€ faire",icon:La,color:"text-yellow-600 bg-yellow-50"},in_progress:{label:"En cours",icon:Os,color:"text-blue-600 bg-blue-50"},completed:{label:"TerminÃ©",icon:nc,color:"text-green-600 bg-green-50"},cancelled:{label:"AnnulÃ©",icon:kt,color:"text-gray-600 bg-gray-50"}};function wa({open:t,onOpenChange:s,request:r,categories:n,onSuccess:a}){const{toast:i}=ge(),[o,l]=m.useState(!1),c=!!r,d=p=>R(this,null,function*(){p.preventDefault(),l(!0);try{const h=new FormData(p.target),f={title:h.get("title"),description:h.get("description"),category_name:h.get("category_name"),priority:h.get("priority"),notes:h.get("notes")};c?(f.status=h.get("status"),yield Nc(r.id,f),i({title:"Demande mise Ã  jour"})):(yield Sc(f),i({title:"Demande crÃ©Ã©e",description:"Un code unique a Ã©tÃ© gÃ©nÃ©rÃ© automatiquement."})),a(),s(!1)}catch(h){console.error("Error saving exercise request:",h),i({title:"Erreur",description:h.message,variant:"destructive"})}finally{l(!1)}});return e.jsx(ht,{open:t,onOpenChange:s,children:e.jsxs(pt,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(xt,{children:[e.jsxs(ft,{children:[c?"Modifier":"CrÃ©er"," une demande d'exercice"]}),e.jsx(gt,{children:c?"Modifier les informations de cette demande d'exercice.":"CrÃ©er une nouvelle demande d'exercice. Un code unique sera gÃ©nÃ©rÃ© automatiquement."})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c&&e.jsxs("div",{children:[e.jsx(q,{children:"Code de rÃ©fÃ©rence"}),e.jsx(se,{value:r.code,disabled:!0,className:"font-mono font-bold"})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"title",children:"Titre de l'exercice *"}),e.jsx(se,{id:"title",name:"title",defaultValue:r==null?void 0:r.title,placeholder:"Ex: ParamÃ©trer le Wi-Fi",required:!0})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"category_name",children:"CatÃ©gorie"}),e.jsx(se,{id:"category_name",name:"category_name",defaultValue:r==null?void 0:r.category_name,placeholder:"Ex: Communication, ParamÃ¨tres..."})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"description",children:"Description"}),e.jsx(mt,{id:"description",name:"description",defaultValue:r==null?void 0:r.description,placeholder:"Description dÃ©taillÃ©e de l'exercice Ã  crÃ©er...",rows:4})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(q,{htmlFor:"priority",children:"PrioritÃ© *"}),e.jsxs("select",{id:"priority",name:"priority",defaultValue:(r==null?void 0:r.priority)||"normal",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",required:!0,children:[e.jsx("option",{value:"high",children:"Prioritaire"}),e.jsx("option",{value:"normal",children:"Normal"}),e.jsx("option",{value:"low",children:"Optionnel"})]})]}),c&&e.jsxs("div",{children:[e.jsx(q,{htmlFor:"status",children:"Statut"}),e.jsxs("select",{id:"status",name:"status",defaultValue:r==null?void 0:r.status,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"pending",children:"Ã€ faire"}),e.jsx("option",{value:"in_progress",children:"En cours"}),e.jsx("option",{value:"completed",children:"TerminÃ©"}),e.jsx("option",{value:"cancelled",children:"AnnulÃ©"})]})]})]}),e.jsxs("div",{children:[e.jsx(q,{htmlFor:"notes",children:"Notes / Commentaires"}),e.jsx(mt,{id:"notes",name:"notes",defaultValue:r==null?void 0:r.notes,placeholder:"Notes internes, consignes spÃ©cifiques...",rows:3})]}),e.jsxs(jt,{children:[e.jsx(_,{type:"button",variant:"outline",onClick:()=>s(!1),children:"Annuler"}),e.jsx(_,{type:"submit",disabled:o,children:o?"Enregistrement...":c?"Mettre Ã  jour":"CrÃ©er"})]})]})]})})}function vp(){const{categories:t}=Xe(),{toast:s}=ge(),[r,n]=m.useState([]),[a,i]=m.useState(null),[o,l]=m.useState(!0),[c,d]=m.useState(""),[p,h]=m.useState("all"),[f,g]=m.useState("all"),[j,S]=m.useState(!1),[b,y]=m.useState(null),[N,x]=m.useState(null),u=()=>R(this,null,function*(){l(!0);try{const[v,D]=yield Promise.all([yc(),bc()]);n(v),i(D)}catch(v){console.error("Error loading exercise requests:",v),s({title:"Erreur de chargement",description:v.message,variant:"destructive"})}finally{l(!1)}});m.useEffect(()=>{u()},[]);const E=m.useMemo(()=>r.filter(v=>{var U;const D=v.title.toLowerCase().includes(c.toLowerCase())||v.code.toLowerCase().includes(c.toLowerCase())||((U=v.description)==null?void 0:U.toLowerCase().includes(c.toLowerCase())),F=p==="all"||v.status===p,O=f==="all"||v.priority===f;return D&&F&&O}),[r,c,p,f]),L=()=>R(this,null,function*(){if(N)try{yield wc(N.id),s({title:"Demande supprimÃ©e"}),x(null),u()}catch(v){console.error("Error deleting request:",v),s({title:"Erreur de suppression",description:v.message,variant:"destructive"})}});return o?e.jsx("div",{className:"flex items-center justify-center p-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Chargement des demandes..."})]})}):e.jsxs("div",{className:"space-y-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:[e.jsx(Ge,{className:"h-8 w-8 text-primary"}),"Demandes d'exercices"]}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"GÃ©rer les exercices Ã  crÃ©er en coordination avec les contributeurs"})]}),e.jsxs(_,{onClick:()=>S(!0),children:[e.jsx(Rt,{className:"h-4 w-4 mr-2"}),"Nouvelle demande"]})]}),a&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsx(J,{children:e.jsxs(ae,{className:"pb-2",children:[e.jsx(me,{children:"Total"}),e.jsx(ie,{className:"text-3xl",children:a.total})]})}),e.jsx(J,{children:e.jsxs(ae,{className:"pb-2",children:[e.jsx(me,{children:"Ã€ faire"}),e.jsx(ie,{className:"text-3xl text-yellow-600",children:a.by_status.pending})]})}),e.jsx(J,{children:e.jsxs(ae,{className:"pb-2",children:[e.jsx(me,{children:"En cours"}),e.jsx(ie,{className:"text-3xl text-blue-600",children:a.by_status.in_progress})]})}),e.jsx(J,{children:e.jsxs(ae,{className:"pb-2",children:[e.jsx(me,{children:"Prioritaires"}),e.jsx(ie,{className:"text-3xl text-red-600",children:a.by_priority.high})]})})]}),e.jsxs("div",{className:"flex flex-wrap gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 min-w-[200px]",children:[e.jsx(Qr,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Rechercher par titre, code ou description...",value:c,onChange:v=>d(v.target.value),className:"pl-10"})]}),e.jsxs("select",{value:p,onChange:v=>h(v.target.value),className:"flex h-10 rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Tous les statuts"}),Object.entries(ks).map(([v,D])=>e.jsx("option",{value:v,children:D.label},v))]}),e.jsxs("select",{value:f,onChange:v=>g(v.target.value),className:"flex h-10 rounded-md border border-input bg-background px-3 py-2 text-sm",children:[e.jsx("option",{value:"all",children:"Toutes les prioritÃ©s"}),Object.entries(_s).map(([v,D])=>e.jsx("option",{value:v,children:D.label},v))]})]}),e.jsx(Jr,{className:"h-[calc(100vh-450px)]",children:e.jsx("div",{className:"space-y-4",children:E.length===0?e.jsx(J,{children:e.jsxs(Z,{className:"flex flex-col items-center justify-center py-12",children:[e.jsx(Ge,{className:"h-16 w-16 text-muted-foreground mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"Aucune demande trouvÃ©e"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:c||p!=="all"||f!=="all"?"Essayez de modifier vos filtres":"CrÃ©ez votre premiÃ¨re demande d'exercice"})]})}):E.map(v=>{var O;const D=ks[v.status].icon,F=_s[v.priority].icon;return e.jsxs(J,{className:"hover:shadow-md transition-shadow",children:[e.jsx(ae,{children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-1 flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("code",{className:"text-sm font-mono font-bold bg-muted px-2 py-1 rounded",children:v.code}),e.jsxs(ze,{className:_s[v.priority].color,children:[e.jsx(F,{className:"h-3 w-3 mr-1"}),_s[v.priority].label]}),e.jsxs(ze,{className:ks[v.status].color,children:[e.jsx(D,{className:"h-3 w-3 mr-1"}),ks[v.status].label]}),v.category_name&&e.jsx(ze,{variant:"outline",children:v.category_name})]}),e.jsx(ie,{className:"text-xl",children:v.title}),v.description&&e.jsx(me,{children:v.description})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{variant:"ghost",size:"icon",onClick:()=>y(v),children:e.jsx(bt,{className:"h-4 w-4"})}),e.jsx(_,{variant:"ghost",size:"icon",className:"text-destructive hover:text-destructive",onClick:()=>x(v),children:e.jsx(he,{className:"h-4 w-4"})})]})]})}),e.jsxs(Z,{children:[e.jsxs("div",{className:"flex items-center gap-6 text-sm text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-green-600",children:v.validated_versions_count||0})," version(s) validÃ©e(s)"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-yellow-600",children:v.pending_versions_count||0})," en attente"]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:((O=v.linked_task_ids)==null?void 0:O.length)||0})," exercice(s) liÃ©(s)"]}),v.creator&&e.jsxs("div",{className:"ml-auto",children:["Par ",e.jsx("span",{className:"font-medium",children:v.creator.username})]})]}),v.notes&&e.jsxs("div",{className:"mt-3 p-3 bg-muted rounded-md text-sm",children:[e.jsx("p",{className:"font-medium mb-1",children:"Notes :"}),e.jsx("p",{className:"text-muted-foreground",children:v.notes})]})]})]},v.id)})})}),e.jsx(wa,{open:j,onOpenChange:S,categories:t,onSuccess:u}),e.jsx(wa,{open:!!b,onOpenChange:v=>!v&&y(null),request:b,categories:t,onSuccess:u}),e.jsx(Ke,{open:!!N,onOpenChange:v=>!v&&x(null),children:e.jsxs(Ye,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Ze,{children:[e.jsx(et,{children:"Supprimer cette demande ?"}),e.jsxs(tt,{children:['Cette action est irrÃ©versible. La demande "',N==null?void 0:N.title,'" sera dÃ©finitivement supprimÃ©e. Les exercices dÃ©jÃ  crÃ©Ã©s ne seront pas affectÃ©s.']})]}),e.jsxs(st,{children:[e.jsx(rt,{children:"Annuler"}),e.jsx(nt,{onClick:L,className:"bg-destructive hover:bg-destructive/90",children:"Supprimer"})]})]})})]})}function yp(){const[t,s]=m.useState([]),[r,n]=m.useState(0),[a,i]=m.useState(!0),[o,l]=m.useState(null),c=()=>R(this,null,function*(){i(!0),l(null);try{const{data:p,error:h}=yield Y.from("profiles").select("id, username, role, created_at");if(h)throw h;const{data:f,error:g}=yield Y.from("contributor_points").select("contributor_id, total_points, last_updated");if(g)throw g;const j={};(f||[]).forEach(y=>{j[y.contributor_id]={total_points:y.total_points,last_updated:y.last_updated}});const S=(p||[]).filter(y=>y.role==="contributor").map(y=>{var N,x;return{id:y.id,username:y.username,role:y.role,total_points:((N=j[y.id])==null?void 0:N.total_points)||0,last_updated:((x=j[y.id])==null?void 0:x.last_updated)||y.created_at,created_at:y.created_at}}).sort((y,N)=>(N.total_points||0)-(y.total_points||0));s(S);const b=p==null?void 0:p.find(y=>y.role==="admin");b&&j[b.id]&&n(j[b.id].total_points)}catch(p){console.error("Error fetching contributors:",p),l(p.message)}finally{i(!1)}}),d=(p,h,f)=>R(this,null,function*(){try{const{data:g}=yield Y.from("contributor_points").select("total_points").eq("contributor_id",p).single(),j=((g==null?void 0:g.total_points)||0)+h,{error:S}=yield Y.from("contributor_points").update({total_points:j,last_updated:new Date().toISOString()}).eq("contributor_id",p);if(S)throw S;const{error:b}=yield Y.from("contributor_points_history").insert([{contributor_id:p,points_change:h,contribution_type:"manual_adjustment",description:f}]);if(b)throw b;return yield c(),{success:!0}}catch(g){return console.error("Error updating contributor points:",g),{success:!1,error:g.message}}});return m.useEffect(()=>{c()},[]),{contributors:t,adminPoints:r,loading:a,error:o,refresh:c,updateContributorPoints:d}}function bp(){const{contributors:t,adminPoints:s,loading:r,error:n,refresh:a,updateContributorPoints:i}=yp(),[o,l]=m.useState(null),[c,d]=m.useState(""),[p,h]=m.useState(""),[f,g]=m.useState(null);if(r)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});const j=N=>{l(N.id),d(""),h("")},S=N=>R(this,null,function*(){const x=parseFloat(c);if(isNaN(x)){g({type:"error",text:"Veuillez entrer un nombre valide"});return}if(!p.trim()){g({type:"error",text:"Veuillez entrer une raison"});return}const u=yield i(N,x,p);u.success?(g({type:"success",text:"Points mis Ã  jour avec succÃ¨s"}),l(null),d(""),h("")):g({type:"error",text:u.error}),setTimeout(()=>g(null),3e3)}),b=t.reduce((N,x)=>N+(x.total_points||0),0),y=b+s;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(J,{children:e.jsx(Z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Contributeurs"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:t.length})]}),e.jsx(za,{className:"w-8 h-8 text-blue-400"})]})})}),e.jsx(J,{children:e.jsx(Z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Points Contributeurs"}),e.jsx("p",{className:"text-3xl font-bold text-violet-600",children:b.toFixed(1)})]}),e.jsx($a,{className:"w-8 h-8 text-violet-400"})]})})}),e.jsx(J,{children:e.jsx(Z,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Points Admin (non-pÃ©nalisables)"}),e.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:s.toFixed(1)})]}),e.jsx(ls,{className:"w-8 h-8 text-emerald-400"})]})})})]}),e.jsx(J,{className:"bg-gradient-to-r from-slate-50 to-slate-100 border-slate-200",children:e.jsx(Z,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-slate-600",children:"Points Totaux du SystÃ¨me"}),e.jsx("p",{className:"text-4xl font-bold text-slate-900",children:y.toFixed(1)}),e.jsxs("div",{className:"text-xs text-slate-600 mt-3 space-y-1",children:[e.jsxs("p",{children:["ðŸ“Š Contribution Points: ",b.toFixed(1)," (",(b/y*100).toFixed(2),"%)"]}),e.jsxs("p",{children:["ðŸ‘¨â€ðŸ’¼ Admin Points: ",s.toFixed(1)," (",(s/y*100).toFixed(2),"%)"]})]})]})})}),f&&e.jsx("div",{className:`p-4 rounded-lg ${f.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:f.text}),e.jsxs(J,{children:[e.jsx(ae,{children:e.jsxs(ie,{className:"flex items-center justify-between",children:[e.jsx("span",{children:"Gestion des Points des Contributeurs"}),e.jsx(_,{onClick:a,size:"sm",variant:"outline",children:"RafraÃ®chir"})]})}),e.jsxs(Z,{children:[n&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 text-red-700 mb-4",children:n}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-700",children:"Contributeur"}),e.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-700",children:"Points Totaux"}),e.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-700",children:"% du Total"}),e.jsx("th",{className:"text-left px-4 py-3 font-semibold text-gray-700",children:"DerniÃ¨re Mise Ã  Jour"}),e.jsx("th",{className:"text-center px-4 py-3 font-semibold text-gray-700",children:"Actions"})]})}),e.jsx("tbody",{children:t.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-4 py-6 text-center text-gray-500",children:"Aucun contributeur trouvÃ©"})}):t.map(N=>e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsxs("td",{className:"px-4 py-3",children:[e.jsx("div",{className:"font-medium text-gray-900",children:N.username}),e.jsx("div",{className:"text-xs text-gray-500",children:N.id})]}),e.jsx("td",{className:"text-center px-4 py-3",children:o===N.id?e.jsx("input",{type:"number",step:"0.1",value:c,onChange:x=>d(x.target.value),placeholder:"Points Ã  ajouter/retirer",className:"w-32 px-2 py-1 border border-gray-300 rounded text-center"}):e.jsx("span",{className:"font-bold text-violet-600",children:(N.total_points||0).toFixed(1)})}),e.jsx("td",{className:"text-center px-4 py-3 text-gray-600",children:b>0?((N.total_points||0)/b*100).toFixed(2)+"%":"0%"}),e.jsx("td",{className:"text-left px-4 py-3 text-xs text-gray-500",children:N.last_updated?new Date(N.last_updated).toLocaleDateString("fr-FR"):"N/A"}),e.jsx("td",{className:"text-center px-4 py-3",children:o===N.id?e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsx("input",{type:"text",value:p,onChange:x=>h(x.target.value),placeholder:"Raison",className:"w-40 px-2 py-1 border border-gray-300 rounded text-sm"}),e.jsx(_,{size:"sm",onClick:()=>S(N.id),className:"bg-green-600 hover:bg-green-700",children:e.jsx(Me,{className:"w-4 h-4"})}),e.jsx(_,{size:"sm",variant:"outline",onClick:()=>l(null),children:e.jsx(Je,{className:"w-4 h-4"})})]}):e.jsx(_,{size:"sm",variant:"outline",onClick:()=>j(N),children:e.jsx(Er,{className:"w-4 h-4"})})})]},N.id))})]})})]})]}),e.jsx(J,{className:"bg-blue-50 border border-blue-200",children:e.jsx(Z,{className:"pt-6",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h4",{className:"font-semibold text-blue-900 flex items-center gap-2",children:[e.jsx(Wr,{className:"w-4 h-4"}),"Notes sur la Gestion des Points"]}),e.jsxs("ul",{className:"text-sm text-blue-800 space-y-2 ml-6 list-disc",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Points Contributeurs :"})," Peuvent Ãªtre augmentÃ©s (bonus) ou diminuÃ©s (pÃ©nalitÃ©s) manuellement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Points Admin :"})," Sont comptÃ©s dans le total du systÃ¨me mais ",e.jsx("strong",{children:"ne peuvent PAS avoir de pÃ©nalitÃ©s"})]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Bonus/PÃ©nalitÃ©s Automatiques :"})," Les points sont automatiquement ajoutÃ©s/retirÃ©s par le systÃ¨me lors de validations/rejets"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Ajustements Manuels :"})," Utilisez ce formulaire pour corriger les points qui n'auraient pas Ã©tÃ© appliquÃ©s correctement"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Historique :"})," Tous les changements sont enregistrÃ©s dans ",e.jsx("code",{children:"contributor_points_history"})]})]})]})})})]})}const Na=t=>!t||typeof t!="string"?!1:t.startsWith("fa6-")||t.startsWith("fa-")||t.startsWith("bs-")||t.startsWith("md-")||t.startsWith("fi-")||t.startsWith("hi2-")||t.startsWith("ai-")||t.startsWith("lucide-")||t.includes(":"),Es=t=>{let s=t;if(typeof t=="string")try{s=JSON.parse(t)}catch(o){console.error("Erreur de parsing expected_input:",o),s={}}s=s||{};const r=s.questionType||s.type||"mixed",a=(Array.isArray(s.choices)?s.choices:Array.isArray(s.answers)?s.answers:[]).map(o=>{var c;const l=o.iconId||((c=o.icon)==null?void 0:c.id)||(typeof o.icon=="string"?o.icon:null);return{id:o.id||Et(),text:o.text||"",imageId:o.imageId||null,imageName:o.imageName||"",iconId:l,icon:o.icon||null,isCorrect:!!o.isCorrect}}),i=Array.isArray(s.correctAnswers)&&s.correctAnswers.length>0?s.correctAnswers:a.filter(o=>o.isCorrect).map(o=>o.id);return $(M({},s),{questionType:r,choices:a,correctAnswers:i})};function wp({steps:t=[],onUpdate:s=null,versionId:r=null}){const[n,a]=m.useState({}),[i,o]=m.useState({}),[l,c]=m.useState({}),[d,p]=m.useState(!1),h=S=>{a(b=>$(M({},b),{[S]:!b[S]}))},f=S=>{if(!i[S]){const b=t.find(y=>y.id===S);b&&c(y=>$(M({},y),{[S]:Es(b.expected_input)}))}o(b=>$(M({},b),{[S]:!b[S]}))},g=(S,b)=>{c(y=>{const N=t.find(L=>L.id===S),x=y[S]||Es(N==null?void 0:N.expected_input),u=(x==null?void 0:x.correctAnswers)||[],E=u.includes(b)?u.filter(L=>L!==b):[...u,b];return $(M({},y),{[S]:$(M({},x),{correctAnswers:E})})})},j=S=>R(this,null,function*(){p(!0);try{const b=t.find(N=>N.id===S),y=l[S]||Es(b==null?void 0:b.expected_input);if(r){const{error:N}=yield Y.from("steps").update({expected_input:JSON.stringify(y)}).eq("id",S);if(N)throw N}s&&s(S,y),o(N=>$(M({},N),{[S]:!1}))}catch(b){console.error("Erreur enregistrement:",b),alert("Erreur lors de la sauvegarde: "+b.message)}finally{p(!1)}});return!t||t.length===0?e.jsx("div",{className:"p-4 bg-amber-50 border border-amber-200 rounded-lg",children:e.jsx("p",{className:"text-amber-800",children:"Aucune question trouvÃ©e"})}):e.jsx("div",{className:"space-y-3",children:t.map((S,b)=>{const y=Es(S.expected_input),N=n[S.id],x=i[S.id],u=x&&l[S.id]||y,E=u.choices||[],L=u.correctAnswers||[];return e.jsxs(J,{className:"overflow-hidden",children:[e.jsx("button",{onClick:()=>h(S.id),className:"w-full text-left",children:e.jsx(ae,{className:"pb-3 cursor-pointer hover:bg-slate-50",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"inline-flex items-center justify-center w-7 h-7 rounded-full bg-blue-100 text-blue-700 font-semibold text-sm",children:b+1}),e.jsx("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-700",children:"ðŸ“‹ RÃ©ponses texte / image / icÃ´ne"}),x&&e.jsx("span",{className:"inline-flex items-center gap-1 px-2.5 py-0.5 rounded-full text-xs font-medium bg-amber-100 text-amber-700",children:"âœï¸ Ã‰dition"})]}),e.jsx("p",{className:"font-semibold text-base text-gray-900",children:S.instruction||"Question sans titre"})]}),e.jsx("div",{className:"ml-2 text-gray-400",children:N?e.jsx(er,{className:"w-5 h-5"}):e.jsx(tr,{className:"w-5 h-5"})})]})})}),N&&e.jsxs(Z,{className:"bg-slate-50 border-t pt-4 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:["RÃ©ponses (",E.length,"):"]}),!x&&e.jsx(_,{onClick:()=>f(S.id),variant:"outline",size:"sm",className:"text-blue-600 hover:bg-blue-50",children:"âœï¸ Modifier"})]}),e.jsx("div",{className:"space-y-2",children:E.map((v,D)=>{var A;const F=v.id||D,O=L.includes(F),U=v.iconId||((A=v.icon)==null?void 0:A.id)||(typeof v.icon=="string"?v.icon:null)||(Na(v.imageId)?v.imageId:null),H=v.imageId&&!Na(v.imageId),X=!!v.text;return e.jsx("div",{className:qr("p-3 rounded-lg border-2 transition-all",O?"bg-green-50 border-green-300":"bg-white border-gray-200",x&&"cursor-pointer hover:border-blue-400"),onClick:()=>x&&g(S.id,F),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:x?e.jsx("input",{type:"checkbox",checked:O,onChange:()=>g(S.id,F),className:"w-5 h-5 cursor-pointer accent-green-600"}):O&&e.jsx("div",{className:"flex items-center justify-center w-5 h-5 rounded bg-green-500",children:e.jsx(Vs,{className:"w-3 h-3 text-white"})})}),H&&e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:`https://qcimwwhiymhhidkxtpzt.supabase.co/storage/v1/object/public/app-images/${v.imageName}`,alt:v.text||"RÃ©ponse",className:"w-16 h-16 object-cover rounded",onError:T=>{T.target.style.display="none"}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[X&&e.jsx("p",{className:"text-sm text-gray-700 break-words",children:v.text}),U&&e.jsxs("p",{className:"text-xs text-indigo-700 font-medium flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"px-2 py-0.5 rounded bg-indigo-50 border border-indigo-200",children:"IcÃ´ne"}),e.jsx("span",{className:"truncate",children:U})]}),!X&&!H&&!U&&e.jsx("p",{className:"text-xs text-gray-400 italic",children:"(RÃ©ponse vide)"})]}),O&&!x&&e.jsx("div",{className:"flex-shrink-0 flex items-center gap-1 px-2 py-1 rounded bg-green-100",children:e.jsx("span",{className:"text-xs font-medium text-green-700",children:"Correcte"})})]})},F)})}),e.jsx("div",{className:"mt-3 p-2 bg-blue-50 border border-blue-200 rounded text-xs text-blue-800",children:x?e.jsx("p",{className:"font-medium",children:"Cliquez sur les rÃ©ponses ou cochez les cases pour marquer comme correctes"}):e.jsx("p",{className:"font-medium",children:L.length>0?`${L.length} rÃ©ponse${L.length>1?"s":""} correcte${L.length>1?"s":""}`:"âš ï¸ Aucune rÃ©ponse correcte dÃ©finie"})})]}),x&&e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(_,{onClick:()=>j(S.id),disabled:d,className:"flex-1 bg-green-600 hover:bg-green-700",children:[d&&e.jsx(ac,{className:"w-4 h-4 mr-2 animate-spin"}),d?"Enregistrement...":"âœ“ Enregistrer"]}),e.jsx(_,{onClick:()=>f(S.id),variant:"outline",disabled:d,className:"flex-1",children:"âœ• Annuler"})]})]})]},S.id)})})}function Np(){var D,F,O,U,H,X,A;const{currentUser:t}=Br();Ea();const[s,r]=m.useState([]),[n,a]=m.useState(!0),[i,o]=m.useState(null),[l,c]=m.useState(null),[d,p]=m.useState(""),[h,f]=m.useState(!1),[g,j]=m.useState(!1),[S,b]=m.useState(""),[y,N]=m.useState("");m.useEffect(()=>{x()},[]),m.useEffect(()=>{var T,I;i&&(b(((T=i.task)==null?void 0:T.title)||""),N(((I=i.task)==null?void 0:I.description)||""))},[i]);const x=()=>R(this,null,function*(){a(!0);try{const{data:T,error:I}=yield Y.from("versions").select(`
          *,
          task:task_id (
            id,
            title,
            description,
            category,
            owner_id,
            created_at,
            task_type
          ),
          steps (
            id,
            instruction,
            step_order,
            expected_input
          )
        `).eq("creation_status","pending").order("created_at",{ascending:!1});if(I)throw I;const w=(T||[]).filter(k=>k.task!==null&&k.task.task_type==="questionnaire"),P=[...new Set(w.map(k=>{var C;return(C=k.task)==null?void 0:C.owner_id}).filter(Boolean))];let G={};if(P.length>0){const{data:k}=yield Y.from("profiles").select("id, first_name, last_name, email, role").in("id",P);k&&k.forEach(C=>{G[C.id]=C})}const z=w.map(k=>{var Q,le;const C=G[(Q=k.task)==null?void 0:Q.owner_id]||{};return $(M({},k),{ownerProfile:C,questionCount:((le=k.steps)==null?void 0:le.length)||0})});r(z)}catch(T){console.error("Erreur chargement QCM:",T)}finally{a(!1)}}),u=T=>R(this,null,function*(){var I;c(T);try{const{error:w}=yield Y.from("versions").update({creation_status:"validated",reviewer_id:t.id,reviewed_at:new Date().toISOString()}).eq("id",T);if(w)throw w;r(s.filter(G=>G.id!==T));const P=s.find(G=>G.id===T);(I=P==null?void 0:P.task)!=null&&I.owner_id&&(yield Y.from("contributor_points").insert([{user_id:P.task.owner_id,points:5,reason:"Questionnaire approuvÃ©",task_id:P.task.id}])),alert("QCM approuvÃ© et 5 points attribuÃ©s!")}catch(w){alert("Erreur: "+w.message)}finally{c(null)}}),E=T=>R(this,null,function*(){if(!d.trim()){alert("Veuillez ajouter des commentaires pour justifier le rejet");return}c(T);try{const I=s.find(P=>P.id===T),{error:w}=yield Y.from("versions").update({creation_status:"draft",admin_comments:d}).eq("id",T);if(w)throw w;r(s.filter(P=>P.id!==T)),p(""),f(!1),alert("QCM rejetÃ©. Commentaires envoyÃ©s au contributeur.")}catch(I){alert("Erreur: "+I.message)}finally{c(null)}}),L=T=>R(this,null,function*(){if(window.confirm("ÃŠtes-vous sÃ»r de vouloir supprimer ce QCM?"))try{yield Y.from("steps").delete().eq("version_id",T);const{error:I}=yield Y.from("versions").delete().eq("id",T);if(I)throw I;r(s.filter(w=>w.id!==T)),alert("QCM supprimÃ©")}catch(I){alert("Erreur: "+I.message)}}),v=()=>R(this,null,function*(){var T;if((T=i==null?void 0:i.task)!=null&&T.id)try{const{error:I}=yield Y.from("tasks").update({title:S,description:y}).eq("id",i.task.id);if(I)throw I;o(w=>$(M({},w),{task:$(M({},w.task),{title:S,description:y})})),j(!1),alert("MÃ©tadonnÃ©es sauvegardÃ©es")}catch(I){alert("Erreur: "+I.message)}});return n?e.jsx("div",{className:"text-center py-8",children:"Chargement des QCM en attente..."}):s.length===0?e.jsx(J,{children:e.jsxs(Z,{className:"py-12 text-center",children:[e.jsx(Ge,{className:"w-12 h-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Aucun QCM en attente de validation"})]})}):i&&i.task?e.jsxs("div",{children:[e.jsx(_,{variant:"outline",onClick:()=>o(null),className:"mb-4",children:"â† Retour Ã  la liste"}),e.jsxs(J,{children:[e.jsx(ae,{children:g?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Titre"}),e.jsx("input",{type:"text",value:S,onChange:T=>b(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),e.jsx("textarea",{value:y,onChange:T=>N(T.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",rows:3})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:v,className:"bg-green-600 hover:bg-green-700",children:"âœ“ Enregistrer"}),e.jsx(_,{variant:"outline",onClick:()=>j(!1),children:"âœ• Annuler"})]})]}):e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(ie,{children:((D=i.task)==null?void 0:D.title)||"Questionnaire"}),e.jsx(me,{children:(F=i.task)==null?void 0:F.description})]}),e.jsx(_,{variant:"outline",size:"sm",onClick:()=>j(!0),className:"ml-2",children:"âœï¸ Ã‰diter"})]})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[e.jsxs("p",{className:"text-sm font-medium text-blue-900",children:["Contributeur: ",(O=i.ownerProfile)==null?void 0:O.first_name," ",(U=i.ownerProfile)==null?void 0:U.last_name]}),e.jsx("p",{className:"text-xs text-blue-700",children:(H=i.ownerProfile)==null?void 0:H.email})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"CatÃ©gorie"}),e.jsx("p",{className:"font-semibold",children:((X=i.task)==null?void 0:X.category)||"-"})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Nombre de questions"}),e.jsx("p",{className:"font-semibold",children:i.questionCount})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Date"}),e.jsx("p",{className:"font-semibold text-sm",children:(A=i.task)!=null&&A.created_at?new Date(i.task.created_at).toLocaleDateString("fr-FR"):"-"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Questions du QCM"}),e.jsx(wp,{steps:i.steps||[],versionId:i.id,onUpdate:(T,I)=>{}})]}),e.jsxs("div",{className:"flex gap-2 pt-4 border-t",children:[e.jsxs(_,{onClick:()=>u(i.id),disabled:l===i.id,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(Vs,{className:"w-4 h-4 mr-2"}),"Approuver"]}),e.jsxs(_,{onClick:()=>f(!0),variant:"outline",disabled:l===i.id,className:"flex-1",children:[e.jsx(Je,{className:"w-4 h-4 mr-2"}),"Rejeter"]}),e.jsx(_,{onClick:()=>L(i.id),variant:"destructive",disabled:l===i.id,children:e.jsx(he,{className:"w-4 h-4"})})]})]})]}),h&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(J,{className:"w-96",children:[e.jsx(ae,{children:e.jsx(ie,{children:"Raison du rejet"})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsx("textarea",{value:d,onChange:T=>p(T.target.value),placeholder:"Expliquez pourquoi ce QCM est rejetÃ©...",className:"w-full p-2 border rounded-lg min-h-32 focus:ring-2 focus:ring-blue-500"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(_,{onClick:()=>E(i.id),variant:"destructive",disabled:l===i.id,className:"flex-1",children:"Rejeter"}),e.jsx(_,{onClick:()=>{f(!1),p("")},variant:"outline",className:"flex-1",children:"Annuler"})]})]})]})})]}):e.jsx("div",{children:e.jsx("div",{className:"space-y-2",children:s.map(T=>{var I,w,P,G,z,k;return T.task?e.jsx(J,{className:"hover:shadow-md transition-shadow",children:e.jsx(Z,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-lg",children:(I=T.task)==null?void 0:I.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:(w=T.task)==null?void 0:w.description}),e.jsxs("div",{className:"flex gap-4 text-xs text-gray-500",children:[e.jsxs("span",{children:["ðŸ“ ",(P=T.task)==null?void 0:P.category]}),e.jsxs("span",{children:["â“ ",T.questionCount," questions"]}),e.jsxs("span",{children:["ðŸ‘¤ ",(G=T.ownerProfile)==null?void 0:G.first_name," ",(z=T.ownerProfile)==null?void 0:z.last_name]}),e.jsxs("span",{children:["ðŸ“… ",(k=T.task)!=null&&k.created_at?new Date(T.task.created_at).toLocaleDateString("fr-FR"):"-"]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-shrink-0",children:[e.jsxs(_,{onClick:()=>o(T),variant:"outline",size:"sm",children:[e.jsx(Gr,{className:"w-4 h-4 mr-2"}),"Voir"]}),e.jsx(_,{onClick:()=>u(T.id),disabled:l===T.id,size:"sm",className:"bg-green-600 hover:bg-green-700",children:e.jsx(Vs,{className:"w-4 h-4"})}),e.jsx(_,{onClick:()=>{o(T),f(!0)},variant:"destructive",size:"sm",children:e.jsx(Je,{className:"w-4 h-4"})})]})]})})},T.id):null})})})}function Sp(){const{toast:t}=ge(),[s,r]=m.useState([]),[n,a]=m.useState("en"),[i,o]=m.useState([]),[l,c]=m.useState(null),[d,p]=m.useState([]),[h,f]=m.useState([]),[g,j]=m.useState([]),[S,b]=m.useState(!0),[y,N]=m.useState(!1),[x,u]=m.useState(null),[E,L]=m.useState({}),[v,D]=m.useState(null),[F,O]=m.useState({}),[U,H]=m.useState(null);m.useState(!1),m.useState({question_id:"",translated_instruction:""}),m.useState(!1),m.useState({choice_id:"",translated_choice_text:"",translated_feedback:""});const[X,A]=m.useState(!1),[T,I]=m.useState(null),[w,P]=m.useState(!1);m.useEffect(()=>{(()=>R(this,null,function*(){try{const K=yield zo();r(K),K.length>0&&a(K[0].language_code);const{data:ce}=yield Y.from("tasks").select("id, title, description").eq("task_type","questionnaire").order("created_at",{ascending:!1});o(ce||[]),ce&&ce.length>0&&c(ce[0].id)}catch(K){console.error("Error loading data:",K),t({title:"Erreur",description:"Impossible de charger les donnÃ©es",variant:"destructive"})}finally{b(!1)}}))()},[t]),m.useEffect(()=>{l&&(G(),z())},[l,n]);const G=()=>R(this,null,function*(){try{const{data:B}=yield Y.from("questionnaire_questions").select(`
          id,
          instruction,
          question_order,
          question_type,
          questionnaire_choices (
            id,
            text,
            choice_order,
            is_correct,
            feedback
          )
        `).eq("task_id",l).order("question_order");p(B||[])}catch(B){console.error("Error fetching questions:",B),t({title:"Erreur",description:"Impossible de charger les questions",variant:"destructive"})}}),z=()=>R(this,null,function*(){try{const B=yield Ro(n);f(B);const K=yield Lo(n);j(K)}catch(B){console.error("Error fetching translations:",B)}}),k=B=>h.find(K=>K.question_id===B),C=B=>g.find(K=>K.choice_id===B),Q=(B,K)=>{u(B),L({translated_instruction:(K==null?void 0:K.translated_instruction)||""})},le=(B,K)=>R(this,null,function*(){N(!0);try{if(K)yield Vo(K,E),f(h.map(ce=>ce.id===K?M(M({},ce),E):ce));else{const ce=yield Oo(B,n,E.translated_instruction);f([...h,ce])}u(null),t({title:"SuccÃ¨s",description:"Question mise Ã  jour",variant:"default"})}catch(ce){console.error("Error saving question translation:",ce),t({title:"Erreur",description:"Impossible de sauvegarder",variant:"destructive"})}finally{N(!1)}}),oe=(B,K)=>{D(B),O({translated_choice_text:(K==null?void 0:K.translated_choice_text)||"",translated_feedback:(K==null?void 0:K.translated_feedback)||""})},Ae=(B,K)=>R(this,null,function*(){N(!0);try{if(K)yield Bo(K,F),j(g.map(ce=>ce.id===K?M(M({},ce),F):ce));else{const ce=yield qo(B,n,F.translated_choice_text,F.translated_feedback);j([...g,ce])}D(null),t({title:"SuccÃ¨s",description:"RÃ©ponse mise Ã  jour",variant:"default"})}catch(ce){console.error("Error saving choice translation:",ce),t({title:"Erreur",description:"Impossible de sauvegarder",variant:"destructive"})}finally{N(!1)}}),Te=B=>R(this,null,function*(){if(confirm("ÃŠtes-vous sÃ»r ?"))try{yield Uo(B),f(h.filter(K=>K.id!==B)),t({title:"SuccÃ¨s",description:"Traduction supprimÃ©e",variant:"default"})}catch(K){console.error("Error deleting translation:",K),t({title:"Erreur",description:"Impossible de supprimer",variant:"destructive"})}}),Ve=B=>R(this,null,function*(){if(confirm("ÃŠtes-vous sÃ»r ?"))try{yield Wo(B),j(g.filter(K=>K.id!==B)),t({title:"SuccÃ¨s",description:"Traduction supprimÃ©e",variant:"default"})}catch(K){console.error("Error deleting translation:",K),t({title:"Erreur",description:"Impossible de supprimer",variant:"destructive"})}}),Tt=()=>R(this,null,function*(){if(!l||!n||n==="fr"){t({title:"Erreur",description:"SÃ©lectionnez un questionnaire et une langue",variant:"destructive"});return}P(!1),A(!0),I({current:0,total:0,message:"DÃ©marrage..."});try{yield Qo(l,n,B=>{I(B)}),yield z(),t({title:"SuccÃ¨s",description:"Traduction automatique terminÃ©e",variant:"default"})}catch(B){console.error("Error in auto-translation:",B),t({title:"Erreur",description:B.message||"Erreur lors de la traduction automatique",variant:"destructive"})}finally{A(!1),I(null)}});return S?e.jsx("div",{className:"flex justify-center items-center p-8",children:e.jsx(Ee,{className:"h-8 w-8 animate-spin text-primary"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Traductions des QCM"}),e.jsx("p",{className:"text-gray-600",children:"GÃ©rez les traductions des questions et rÃ©ponses des questionnaires"})]}),e.jsxs(J,{children:[e.jsx(ae,{children:e.jsx(ie,{children:"Configuration"})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Questionnaire"}),e.jsxs("select",{value:l||"",onChange:B=>c(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"SÃ©lectionner un questionnaire"}),i.map(B=>e.jsx("option",{value:B.id,children:B.title||"Sans titre"},B.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Langue"}),e.jsx("select",{value:n,onChange:B=>a(B.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:s.map(B=>e.jsxs("option",{value:B.language_code,children:[B.language_name," (",B.language_code.toUpperCase(),")"]},B.language_code))})]})]}),n&&n!=="fr"&&l&&e.jsx("div",{className:"flex gap-2 pt-2",children:e.jsxs("button",{onClick:()=>P(!0),disabled:X,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[e.jsx(ic,{className:"h-4 w-4"}),X?"Traduction en cours...":"âœ¨ Traduction Auto"]})}),T&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:T.message})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${T.current/T.total*100}%`}})}),e.jsxs("p",{className:"text-xs text-blue-700",children:[T.current,"/",T.total," questions"]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(J,{className:"w-96",children:[e.jsx(ae,{children:e.jsxs(ie,{className:"flex items-center gap-2",children:[e.jsx(Os,{className:"h-5 w-5 text-amber-600"}),"Confirmation de traduction automatique"]})}),e.jsxs(Z,{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-700",children:"ÃŠtes-vous sÃ»r ? Cette action va :"}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 space-y-1",children:[e.jsx("li",{children:"Traduire automatiquement toutes les questions et rÃ©ponses"}),e.jsx("li",{children:"Remplacer les traductions existantes"}),e.jsx("li",{children:"Appliquer les termes du glossaire"})]}),e.jsxs("p",{className:"text-sm text-amber-700 bg-amber-50 p-2 rounded",children:["Cette opÃ©ration peut prendre plusieurs minutes (",d.length," questions)."]})]}),e.jsxs(Bt,{className:"flex gap-2 justify-end",children:[e.jsx("button",{onClick:()=>P(!1),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Annuler"}),e.jsx("button",{onClick:Tt,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Traduire automatiquement"})]})]})}),d.length===0?e.jsx(J,{className:"bg-gray-50",children:e.jsx(Z,{className:"pt-6 text-center text-gray-600",children:"Aucune question trouvÃ©e pour ce questionnaire"})}):e.jsx("div",{className:"space-y-4",children:d.map(B=>{var K,ce;return e.jsxs(J,{className:"overflow-hidden",children:[e.jsx(ae,{className:"cursor-pointer bg-blue-50 hover:bg-blue-100 transition-colors",onClick:()=>H(U===B.id?null:B.id),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"flex-1",children:e.jsxs(ie,{className:"text-base",children:["Q",B.question_order,": ",B.instruction.substring(0,100),"..."]})}),e.jsxs("span",{className:"text-xs px-2 py-1 bg-blue-200 text-blue-800 rounded",children:[((K=B.questionnaire_choices)==null?void 0:K.length)||0," rÃ©ponses"]})]})}),U===B.id&&e.jsxs(Z,{className:"pt-6 space-y-6 bg-gray-50",children:[e.jsxs("div",{className:"border-l-4 border-blue-500 pl-4",children:[e.jsx("h3",{className:"font-bold text-blue-700 mb-3",children:"ðŸ“ Instruction de la question"}),x===B.id?e.jsxs("div",{className:"space-y-3",children:[e.jsx("textarea",{value:E.translated_instruction,onChange:fe=>L($(M({},E),{translated_instruction:fe.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Entrez la traduction..."}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{var fe;return le(B.id,(fe=k(B.id))==null?void 0:fe.id)},disabled:y,children:[y?e.jsx(Ee,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"}),"Sauvegarder"]}),e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>u(null),children:[e.jsx(Je,{className:"h-4 w-4"}),"Annuler"]})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"p-3 bg-white rounded border border-gray-200 mb-3",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Original:"})," ",B.instruction]})}),k(B.id)?e.jsxs("div",{children:[e.jsx("div",{className:"p-3 bg-green-50 rounded border border-green-200 mb-3",children:e.jsxs("p",{className:"text-sm text-green-700",children:[e.jsx("strong",{children:"Traduction:"})," ",k(B.id).translated_instruction]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>Q(B.id,k(B.id)),children:[e.jsx(Er,{className:"h-4 w-4"}),"Modifier"]}),e.jsxs(_,{size:"sm",variant:"destructive",onClick:()=>Te(k(B.id).id),children:[e.jsx(he,{className:"h-4 w-4"}),"Supprimer"]})]})]}):e.jsxs("div",{className:"text-center p-3 bg-yellow-50 rounded border border-yellow-200",children:[e.jsx("p",{className:"text-sm text-yellow-700 mb-2",children:"Aucune traduction"}),e.jsxs(_,{size:"sm",onClick:()=>Q(B.id,null),children:[e.jsx(Rt,{className:"h-4 w-4"}),"Ajouter une traduction"]})]})]})]}),e.jsxs("div",{className:"border-l-4 border-purple-500 pl-4",children:[e.jsx("h3",{className:"font-bold text-purple-700 mb-3",children:"âœ… RÃ©ponses"}),e.jsx("div",{className:"space-y-3",children:(ce=B.questionnaire_choices)==null?void 0:ce.map(fe=>e.jsx("div",{className:"p-3 bg-white rounded border border-gray-200",children:v===fe.id?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:F.translated_choice_text,onChange:dt=>O($(M({},F),{translated_choice_text:dt.target.value})),rows:2,placeholder:"Texte de la rÃ©ponse traduite...",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-purple-500"}),e.jsx("textarea",{value:F.translated_feedback,onChange:dt=>O($(M({},F),{translated_feedback:dt.target.value})),rows:2,placeholder:"Retour traduit (optionnel)...",className:"w-full px-2 py-1 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-purple-500"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{size:"sm",className:"bg-green-600 hover:bg-green-700",onClick:()=>{var dt;return Ae(fe.id,(dt=C(fe.id))==null?void 0:dt.id)},disabled:y,children:[y?e.jsx(Ee,{className:"h-4 w-4 animate-spin"}):e.jsx(Me,{className:"h-4 w-4"}),"Sauvegarder"]}),e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>D(null),children:[e.jsx(Je,{className:"h-4 w-4"}),"Annuler"]})]})]}):e.jsxs("div",{children:[e.jsx("div",{className:"flex items-start justify-between mb-2",children:e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("span",{className:qr("px-2 py-1 text-xs rounded font-bold",fe.is_correct?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:fe.is_correct?"âœ“ Correcte":"âœ— Incorrecte"})})}),e.jsxs("p",{className:"text-sm text-gray-700 mb-2",children:[e.jsx("strong",{children:"Original:"})," ",fe.choice_text]}),C(fe.id)?e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-purple-700 mb-2",children:[e.jsx("strong",{children:"Traduction:"})," ",C(fe.id).translated_choice_text]}),C(fe.id).translated_feedback&&e.jsxs("p",{className:"text-sm text-gray-600 italic mb-2",children:[e.jsx("strong",{children:"Retour:"})," ",C(fe.id).translated_feedback]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(_,{size:"sm",variant:"outline",onClick:()=>oe(fe.id,C(fe.id)),children:[e.jsx(Er,{className:"h-4 w-4"}),"Modifier"]}),e.jsxs(_,{size:"sm",variant:"destructive",onClick:()=>Ve(C(fe.id).id),children:[e.jsx(he,{className:"h-4 w-4"}),"Supprimer"]})]})]}):e.jsxs(_,{size:"sm",onClick:()=>oe(fe.id,null),children:[e.jsx(Rt,{className:"h-4 w-4"}),"Ajouter traduction"]})]})},fe.id))})]})]})]},B.id)})})]})}const Xp=()=>{const t=mo();Ca();const{currentUser:s}=Br();t.pathname.split("/admin/")[1];const{counters:r}=Ea();return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx(J,{className:"mb-6",children:e.jsxs(ae,{children:[e.jsxs(ie,{className:"flex items-center text-3xl",children:[e.jsx(Fa,{className:"mr-3 h-8 w-8 text-primary"}),"Panneau d'Administration"]}),e.jsx(me,{children:"GÃ©rez le contenu, les utilisateurs et la configuration de l'application."})]})}),e.jsx(kc,{counters:r}),e.jsx(J,{children:e.jsx(Z,{className:"p-2 sm:p-4 md:p-6",children:e.jsxs(ho,{children:[e.jsx(ve,{path:"dashboard",element:e.jsx(mm,{})}),e.jsx(ve,{path:"categories",element:e.jsx(gp,{})}),e.jsx(ve,{path:"images",element:e.jsx(Rm,{})}),e.jsx(ve,{path:"validation/images",element:e.jsx(Cc,{})}),e.jsx(ve,{path:"validation/exercices",element:e.jsx(_c,{})}),e.jsx(ve,{path:"validation/questionnaires",element:e.jsx(Np,{})}),e.jsx(ve,{path:"requests",element:e.jsx(vp,{})}),e.jsx(ve,{path:"reviews",element:e.jsx(jp,{currentUser:s})}),e.jsx(ve,{path:"users",element:e.jsx(Hm,{})}),e.jsx(ve,{path:"faq",element:e.jsx(Om,{})}),e.jsx(ve,{path:"lexique",element:e.jsx(Ho,{})}),e.jsx(ve,{path:"traductions",element:e.jsx(cc,{})}),e.jsx(ve,{path:"traductions-qcm",element:e.jsx(Sp,{})}),e.jsx(ve,{path:"errors",element:e.jsx(pp,{})}),e.jsx(ve,{path:"trash",element:e.jsx(fp,{})}),e.jsx(ve,{path:"contact",element:e.jsx(xp,{})}),e.jsx(ve,{path:"points",element:e.jsx(bp,{})}),e.jsx(ve,{index:!0,element:e.jsx(po,{to:"dashboard",replace:!0})})]})})})]})};export{Xp as default};
